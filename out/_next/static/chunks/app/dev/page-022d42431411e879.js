(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2],{673:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var l=s(5155),a=s(3274),r=s(5695),i=s(2115);let n=e=>{let t=Math.floor((Date.now()-e)/1e3);return t<60?"just now":t<3600?"".concat(Math.floor(t/60),"m ago"):t<86400?"".concat(Math.floor(t/3600),"h ago"):"".concat(Math.floor(t/86400),"d ago")};function o(){var e,t,s,o,u,x,m,h,p,v,b,g,f,j,y,N,w,k,_,D,S,C;let{user:R,loading:A,isDeveloper:P}=(0,a.A)(),E=(0,r.useRouter)(),[I,F]=(0,i.useState)([]),[B,U]=(0,i.useState)(null),[q,L]=(0,i.useState)(null),[O,M]=(0,i.useState)([]),[z,G]=(0,i.useState)([]),[T,H]=(0,i.useState)([]),[V,J]=(0,i.useState)(!0),[W,K]=(0,i.useState)("overview"),Q="https://euro-keys.jeremy-samuels17.workers.dev",X=(0,i.useCallback)(async()=>{J(!0);let e=localStorage.getItem("session_token"),t={Authorization:"Bearer ".concat(e)};try{let[e,s,l,a,r,i]=await Promise.allSettled([fetch("".concat(Q,"/api/admin/stats"),{headers:t}),fetch("".concat(Q,"/api/admin/cloudflare"),{headers:t}),fetch("".concat(Q,"/api/admin/activity?limit=50"),{headers:t}),fetch("".concat(Q,"/api/admin/intelligence/inventory"),{headers:t}),fetch("".concat(Q,"/api/admin/intelligence/clicks"),{headers:t}),fetch("".concat(Q,"/api/admin/users"),{headers:t})]);if("fulfilled"===e.status&&e.value.ok&&U(await e.value.json()),"fulfilled"===s.status&&s.value.ok){let e=await s.value.json();e.error||L(e)}if("fulfilled"===l.status&&l.value.ok){let e=await l.value.json();F(e.activity||[])}if("fulfilled"===a.status&&a.value.ok){let e=await a.value.json();M(e.items||[])}if("fulfilled"===r.status&&r.value.ok){let e=await r.value.json();G(e.clicks||[])}if("fulfilled"===i.status&&i.value.ok){let e=await i.value.json();H(e.users||[])}}catch(e){console.error("Failed to fetch dev data:",e)}finally{J(!1)}},[]);if((0,i.useEffect)(()=>{A||R&&P||E.replace("/")},[R,A,P,E]),(0,i.useEffect)(()=>{R&&P&&X()},[R,P,X]),A)return(0,l.jsx)("div",{className:"flex min-h-[60vh] items-center justify-center",children:(0,l.jsx)("div",{className:"h-12 w-12 animate-spin rounded-full border-4 border-eurokeys-purple border-t-transparent"})});if(!R||!P)return null;let Y=(null==q||null==(t=q.marketing)||null==(e=t.topPaths)?void 0:e.filter(e=>e.path.startsWith("/vehicle/")).slice(0,8).map(e=>{let t=e.path.replace("/vehicle/","").split("/");return{make:t[0],model:t[1],year:t[2],count:e.count,path:e.path}}))||[];return(0,l.jsxs)("div",{className:"mx-auto max-w-7xl px-4 py-8",children:[(0,l.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-white",children:"\uD83D\uDEE0️ Developer Panel"}),(0,l.jsx)("p",{className:"mt-1 text-slate-400",children:"Admin tools and system monitoring"})]}),(0,l.jsxs)("button",{onClick:X,disabled:V,className:"flex items-center gap-2 rounded-lg bg-eurokeys-purple/20 px-4 py-2 text-sm font-medium text-eurokeys-purple transition-colors hover:bg-eurokeys-purple/30 disabled:opacity-50",children:[V?(0,l.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}):(0,l.jsx)("span",{children:"\uD83D\uDD04"}),"Refresh"]})]}),(0,l.jsx)("div",{className:"mb-6 flex gap-2 border-b border-eurokeys-border pb-2",children:["overview","users","activity"].map(e=>(0,l.jsxs)("button",{onClick:()=>K(e),className:"rounded-t-lg px-4 py-2 text-sm font-medium transition-colors ".concat(W===e?"bg-eurokeys-purple/20 text-eurokeys-purple":"text-slate-400 hover:text-slate-200"),children:["overview"===e&&"\uD83D\uDCCA Overview","users"===e&&"\uD83D\uDC65 Users","activity"===e&&"\uD83D\uDCCB Activity"]},e))}),(0,l.jsx)("div",{className:"mb-6 rounded-xl border border-eurokeys-border bg-gradient-to-r from-eurokeys-card to-eurokeys-purple/5 p-5",children:(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[R.picture&&(0,l.jsx)("img",{src:R.picture,alt:"",className:"h-12 w-12 rounded-full ring-2 ring-eurokeys-purple/30"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"font-semibold text-white",children:R.name}),(0,l.jsx)("p",{className:"text-sm text-slate-400",children:R.email})]}),(0,l.jsx)("span",{className:"rounded-full bg-green-500/20 px-3 py-1 text-xs font-medium text-green-400",children:"Developer"})]})}),"overview"===W&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsx)(c,{label:"Active Users (30d)",value:(null==B||null==(s=B.visitor_stats)?void 0:s.active_users)||0,icon:"\uD83D\uDC65",trend:(null==B?void 0:B.user_growth)?"+".concat(B.user_growth," this week"):void 0}),(0,l.jsx)(c,{label:"Total Events",value:(null==B||null==(o=B.visitor_stats)?void 0:o.total_events)||0,icon:"\uD83D\uDCCA"}),(0,l.jsx)(c,{label:"Visitors (24h)",value:(null==q||null==(u=q.last24h)?void 0:u.visitors)||0,icon:"\uD83D\uDC41️",subtext:(null==q?void 0:q.last24h)?"".concat(q.last24h.requests.toLocaleString()," requests"):void 0}),(0,l.jsx)(c,{label:"Cache Rate",value:"".concat((null==q||null==(x=q.tech)?void 0:x.cacheRate)||0,"%"),icon:"⚡",color:parseFloat((null==q||null==(m=q.tech)?void 0:m.cacheRate)||"0")>80?"green":"yellow"})]}),(0,l.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"rounded-xl border border-eurokeys-border bg-eurokeys-card p-5",children:[(0,l.jsx)("h2",{className:"mb-4 flex items-center gap-2 text-lg font-semibold text-white",children:"\uD83D\uDE97 Most Viewed Vehicles"}),Y.length>0?(0,l.jsx)("div",{className:"space-y-2",children:Y.map((e,t)=>{var s,a,r;return(0,l.jsxs)("div",{className:"flex items-center justify-between rounded-lg bg-slate-800/50 px-3 py-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("span",{className:"text-lg font-bold text-slate-500",children:["#",t+1]}),(0,l.jsx)("div",{children:(0,l.jsxs)("p",{className:"font-medium text-white capitalize",children:[e.year," ",null==(s=e.make)?void 0:s.replace(/-/g," ")," ",null==(a=e.model)?void 0:a.replace(/-/g," ")]})})]}),(0,l.jsxs)("span",{className:"rounded-full bg-eurokeys-purple/20 px-2 py-1 text-xs font-medium text-eurokeys-purple",children:[null==(r=e.count)?void 0:r.toLocaleString()," views"]})]},t)})}):(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"No vehicle data available"})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-eurokeys-border bg-eurokeys-card p-5",children:[(0,l.jsx)("h2",{className:"mb-4 flex items-center gap-2 text-lg font-semibold text-white",children:"\uD83D\uDD0D Top Searches"}),(null==B||null==(h=B.top_searches)?void 0:h.length)?(0,l.jsx)("div",{className:"space-y-2",children:B.top_searches.slice(0,8).map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center justify-between rounded-lg bg-slate-800/50 px-3 py-2",children:[(0,l.jsx)("span",{className:"font-mono text-sm text-slate-300",children:e.query||"(empty)"}),(0,l.jsxs)("span",{className:"text-xs text-slate-500",children:[e.count,"x"]})]},t))}):(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"No search data"})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-eurokeys-border bg-eurokeys-card p-5",children:[(0,l.jsx)("h2",{className:"mb-4 flex items-center gap-2 text-lg font-semibold text-white",children:"\uD83D\uDCE6 Popular Inventory Items"}),O.length>0?(0,l.jsx)("div",{className:"space-y-2",children:O.slice(0,6).map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center justify-between rounded-lg bg-slate-800/50 px-3 py-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-white",children:e.item_key}),(0,l.jsxs)("p",{className:"text-xs text-slate-500",children:[e.type," • ",e.user_count," users"]})]}),(0,l.jsx)("span",{className:"text-sm font-bold text-eurokeys-purple",children:e.total_qty})]},t))}):(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"No inventory data"})]})]}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"rounded-xl border border-eurokeys-border bg-eurokeys-card p-5",children:[(0,l.jsx)("h2",{className:"mb-4 flex items-center gap-2 text-lg font-semibold text-white",children:"\uD83C\uDF0D Traffic by Country (7d)"}),(null==q||null==(v=q.marketing)||null==(p=v.topCountries)?void 0:p.length)?(0,l.jsx)("div",{className:"grid grid-cols-2 gap-2",children:q.marketing.topCountries.slice(0,8).map((e,t)=>{var s,a;return(0,l.jsxs)("div",{className:"flex items-center gap-2 rounded-lg bg-slate-800/50 px-3 py-2",children:[(0,l.jsx)("span",{className:"text-lg",children:(a=e.country)&&2===a.length?String.fromCodePoint(...[...a.toUpperCase()].map(e=>e.charCodeAt(0)+127397)):"\uD83C\uDF10"}),(0,l.jsx)("div",{className:"flex-1 min-w-0",children:(0,l.jsx)("p",{className:"text-sm font-medium text-white",children:e.country})}),(0,l.jsx)("span",{className:"text-xs text-slate-400",children:null==(s=e.requests)?void 0:s.toLocaleString()})]},t)})}):(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"Cloudflare not configured"})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-eurokeys-border bg-eurokeys-card p-5",children:[(0,l.jsx)("h2",{className:"mb-4 flex items-center gap-2 text-lg font-semibold text-white",children:"\uD83D\uDCF1 Device Distribution"}),(null==q||null==(g=q.marketing)||null==(b=g.devices)?void 0:b.length)?(0,l.jsx)("div",{className:"space-y-3",children:q.marketing.devices.map((e,t)=>{let s=q.marketing.devices.reduce((e,t)=>e+t.requests,0),a=s>0?e.requests/s*100:0;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,l.jsx)("span",{className:"text-slate-300 capitalize",children:e.device||"unknown"}),(0,l.jsxs)("span",{className:"text-slate-500",children:[a.toFixed(1),"%"]})]}),(0,l.jsx)("div",{className:"h-2 rounded-full bg-slate-700 overflow-hidden",children:(0,l.jsx)("div",{className:"h-full rounded-full bg-gradient-to-r from-eurokeys-purple to-blue-500",style:{width:"".concat(a,"%")}})})]},t)})}):(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"No device data"})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-eurokeys-border bg-eurokeys-card p-5",children:[(0,l.jsx)("h2",{className:"mb-4 flex items-center gap-2 text-lg font-semibold text-white",children:"\uD83D\uDC9A System Health"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsx)(d,{label:"Error Rate",value:"".concat((null==q||null==(f=q.tech)?void 0:f.errorRate)||"0","%"),status:1>parseFloat((null==q||null==(j=q.tech)?void 0:j.errorRate)||"0")?"good":5>parseFloat((null==q||null==(y=q.tech)?void 0:y.errorRate)||"0")?"warning":"error"}),(0,l.jsx)(d,{label:"Cache Hit",value:"".concat((null==q||null==(N=q.tech)?void 0:N.cacheRate)||"0","%"),status:parseFloat((null==q||null==(w=q.tech)?void 0:w.cacheRate)||"0")>80?"good":"warning"}),(0,l.jsx)(d,{label:"Threats Blocked",value:(null==q||null==(_=q.last7d)||null==(k=_.threats)?void 0:k.toString())||"0",status:"good"}),(0,l.jsx)(d,{label:"Data Served (7d)",value:(C=(null==q||null==(D=q.last7d)?void 0:D.bytesServed)||0)<1024?"".concat(C," B"):C<1048576?"".concat((C/1024).toFixed(1)," KB"):C<0x40000000?"".concat((C/1048576).toFixed(1)," MB"):"".concat((C/0x40000000).toFixed(2)," GB"),status:"neutral"})]}),(null==q||null==(S=q.tech)?void 0:S.statusGroups)&&(0,l.jsxs)("div",{className:"mt-4 pt-4 border-t border-eurokeys-border",children:[(0,l.jsx)("p",{className:"text-xs text-slate-500 mb-2",children:"Response Codes"}),(0,l.jsx)("div",{className:"flex gap-2",children:Object.entries(q.tech.statusGroups).map(e=>{let[t,s]=e;return(0,l.jsxs)("span",{className:"rounded px-2 py-1 text-xs font-mono ".concat("2xx"===t?"bg-green-500/20 text-green-400":"3xx"===t?"bg-blue-500/20 text-blue-400":"4xx"===t?"bg-yellow-500/20 text-yellow-400":"bg-red-500/20 text-red-400"),children:[t,": ",null==s?void 0:s.toLocaleString()]},t)})})]})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-eurokeys-border bg-eurokeys-card p-5",children:[(0,l.jsx)("h2",{className:"mb-4 flex items-center gap-2 text-lg font-semibold text-white",children:"\uD83D\uDCB0 Affiliate Clicks"}),z.length>0?(0,l.jsx)("div",{className:"space-y-2",children:z.slice(0,5).map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center justify-between rounded-lg bg-slate-800/50 px-3 py-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-white",children:e.term||e.fcc_id||"Unknown"}),(0,l.jsxs)("p",{className:"text-xs text-slate-500",children:[e.distinct_users," unique users"]})]}),(0,l.jsxs)("span",{className:"rounded-full bg-green-500/20 px-2 py-1 text-xs font-medium text-green-400",children:[e.count," clicks"]})]},t))}):(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"No click data"})]})]})]})]}),"users"===W&&(0,l.jsxs)("div",{className:"rounded-xl border border-eurokeys-border bg-eurokeys-card p-5",children:[(0,l.jsxs)("h2",{className:"mb-4 text-lg font-semibold text-white",children:["All Users (",T.length,")"]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b border-eurokeys-border text-left text-slate-400",children:[(0,l.jsx)("th",{className:"pb-3 font-medium",children:"User"}),(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Email"}),(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Status"}),(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Activity"}),(0,l.jsx)("th",{className:"pb-3 font-medium",children:"Last Active"})]})}),(0,l.jsx)("tbody",{children:T.map(e=>(0,l.jsxs)("tr",{className:"border-b border-eurokeys-border/50",children:[(0,l.jsx)("td",{className:"py-3",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[e.picture&&(0,l.jsx)("img",{src:e.picture,alt:"",className:"h-8 w-8 rounded-full"}),(0,l.jsx)("span",{className:"font-medium text-white",children:e.name})]})}),(0,l.jsx)("td",{className:"py-3 text-slate-400",children:e.email}),(0,l.jsx)("td",{className:"py-3",children:(0,l.jsxs)("div",{className:"flex gap-1",children:[e.is_developer&&(0,l.jsx)("span",{className:"rounded bg-purple-500/20 px-2 py-0.5 text-xs text-purple-400",children:"Dev"}),e.is_pro&&(0,l.jsx)("span",{className:"rounded bg-yellow-500/20 px-2 py-0.5 text-xs text-yellow-400",children:"Pro"})]})}),(0,l.jsxs)("td",{className:"py-3 text-slate-300",children:[e.activity_count||0," events"]}),(0,l.jsx)("td",{className:"py-3 text-slate-500",children:e.last_activity?n(e.last_activity):"Never"})]},e.id))})]})})]}),"activity"===W&&(0,l.jsxs)("div",{className:"rounded-xl border border-eurokeys-border bg-eurokeys-card p-5",children:[(0,l.jsx)("h2",{className:"mb-4 text-lg font-semibold text-white",children:"Recent Activity"}),(0,l.jsxs)("div",{className:"space-y-2",children:[I.map(e=>(0,l.jsxs)("div",{className:"flex items-start gap-3 rounded-lg bg-slate-800/50 p-3",children:[(0,l.jsx)("span",{className:"text-xl",children:{sign_in:"\uD83D\uDD11",sign_out:"\uD83D\uDC4B",search:"\uD83D\uDD0D",view_vehicle:"\uD83D\uDE97",click_affiliate:"\uD83D\uDCB0",affiliate_click:"\uD83D\uDCB0",inventory_add:"\uD83D\uDCE6",vin_lookup:"\uD83D\uDD22",add_comment:"\uD83D\uDCAC",page_view:"\uD83D\uDC41️"}[e.action]||"\uD83D\uDCDD"}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,l.jsx)("span",{className:"font-medium text-white",children:e.action}),e.user_name&&(0,l.jsxs)("span",{className:"text-sm text-slate-400",children:["by ",e.user_name]})]}),e.details&&(0,l.jsx)("p",{className:"mt-1 truncate text-xs text-slate-500 font-mono max-w-lg",children:e.details})]}),(0,l.jsx)("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:n(e.created_at)})]},e.id)),0===I.length&&(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"No activity logs"})]})]}),(0,l.jsxs)("div",{className:"mt-8 flex flex-wrap gap-3",children:[(0,l.jsx)("a",{href:"https://dash.cloudflare.com",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 rounded-lg border border-eurokeys-border bg-eurokeys-card px-4 py-2 text-sm text-slate-300 transition-colors hover:border-eurokeys-purple/50",children:"☁️ Cloudflare Dashboard"}),(0,l.jsx)("a",{href:"https://github.com",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 rounded-lg border border-eurokeys-border bg-eurokeys-card px-4 py-2 text-sm text-slate-300 transition-colors hover:border-eurokeys-purple/50",children:"\uD83D\uDC19 GitHub"})]})]})}function c(e){let{label:t,value:s,icon:a,trend:r,subtext:i,color:n}=e;return(0,l.jsxs)("div",{className:"rounded-xl border border-eurokeys-border bg-eurokeys-card p-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-2xl",children:a}),r&&(0,l.jsx)("span",{className:"rounded-full bg-green-500/20 px-2 py-0.5 text-xs text-green-400",children:r})]}),(0,l.jsx)("p",{className:"mt-2 text-2xl font-bold ".concat("green"===n?"text-green-400":"yellow"===n?"text-yellow-400":"red"===n?"text-red-400":"text-white"),children:"number"==typeof s?s.toLocaleString():s}),(0,l.jsx)("p",{className:"text-sm text-slate-400",children:t}),i&&(0,l.jsx)("p",{className:"text-xs text-slate-500",children:i})]})}function d(e){let{label:t,value:s,status:a}=e;return(0,l.jsxs)("div",{className:"rounded-lg border p-3 ".concat({good:"bg-green-500/20 text-green-400 border-green-500/30",warning:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",error:"bg-red-500/20 text-red-400 border-red-500/30",neutral:"bg-slate-500/20 text-slate-300 border-slate-500/30"}[a]),children:[(0,l.jsx)("p",{className:"text-lg font-bold",children:s}),(0,l.jsx)("p",{className:"text-xs opacity-80",children:t})]})}},1204:(e,t,s)=>{"use strict";s.d(t,{h:()=>a,t:()=>l});let l="https://euro-keys.jeremy-samuels17.workers.dev",a="eurokeys-20"},3274:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,O:()=>o});var l=s(5155),a=s(2115),r=s(1204);let i=(0,a.createContext)(void 0),n="".concat(r.t,"/api/auth/google"),o=e=>{let{children:t}=e,[s,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),u=(0,a.useCallback)(()=>{let e=null,t=!1,s=window.location.hash||"";if(s.startsWith("#auth_token=")?(e=s.substring(12),t=!0):s.includes("auth_token=")&&(t=!!(e=new URLSearchParams(s.slice(1)).get("auth_token"))),!e){let t=new URLSearchParams(window.location.search);if(e=t.get("auth_token")){t.delete("auth_token");let e=window.location.pathname+(t.toString()?"?".concat(t):"");window.history.replaceState(null,"",e)}}if(!e)return!1;if(localStorage.setItem("session_token",e),t){let e=window.location.pathname+window.location.search;window.history.replaceState(null,"",e)}return!0},[]),x=(0,a.useCallback)(async()=>{let e=localStorage.getItem("session_token");if(!e)return void d(!1);try{let t=await fetch("".concat(r.t,"/api/user"),{headers:{Authorization:"Bearer ".concat(e)}}),s=await t.json();if(s.user&&s.user.email){let e={id:s.user.id||s.user.sub,email:s.user.email,name:s.user.name||s.user.email.split("@")[0],picture:s.user.picture,is_developer:s.user.is_developer,is_pro:s.user.is_pro,trial_until:s.user.trial_until,created_at:s.user.created_at};o(e),localStorage.setItem("eurokeys_user",JSON.stringify(e))}else localStorage.removeItem("session_token"),localStorage.removeItem("eurokeys_user")}catch(t){console.error("Session verification failed:",t);let e=localStorage.getItem("eurokeys_user");if(e)try{o(JSON.parse(e))}catch(e){localStorage.removeItem("eurokeys_user")}}finally{d(!1)}},[]);(0,a.useEffect)(()=>{(async()=>{u()?(await x(),window.location.hash.includes("auth_token")&&window.history.replaceState(null,"",window.location.pathname+window.location.search)):await x()})()},[u,x]);let m=(0,a.useCallback)(()=>{let e=encodeURIComponent(window.location.origin);window.location.href="".concat(n,"?redirect=").concat(e)},[]),h=(0,a.useCallback)(async()=>{try{await fetch("".concat(r.t,"/api/auth/logout"),{credentials:"include"})}catch(e){console.error("Backend logout failed:",e)}o(null),localStorage.removeItem("session_token"),localStorage.removeItem("eurokeys_user")},[]),p=!!(s&&(s.is_pro||s.trial_until&&s.trial_until>Date.now()/1e3)),v=!!(s&&s.is_developer);return(0,l.jsx)(i.Provider,{value:{user:s,loading:c,login:m,logout:h,isAuthenticated:!!s,isDeveloper:v,isPro:p},children:t})},c=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5695:(e,t,s)=>{"use strict";var l=s(8999);s.o(l,"usePathname")&&s.d(t,{usePathname:function(){return l.usePathname}}),s.o(l,"useRouter")&&s.d(t,{useRouter:function(){return l.useRouter}}),s.o(l,"useSearchParams")&&s.d(t,{useSearchParams:function(){return l.useSearchParams}})},5949:(e,t,s)=>{Promise.resolve().then(s.bind(s,673))}},e=>{e.O(0,[441,964,358],()=>e(e.s=5949)),_N_E=e.O()}]);