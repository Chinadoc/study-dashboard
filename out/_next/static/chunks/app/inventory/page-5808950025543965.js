(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[693],{1204:(e,t,r)=>{"use strict";r.d(t,{h:()=>l,t:()=>s});let s="https://euro-keys.jeremy-samuels17.workers.dev",l="eurokeys-20"},2170:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(5155),l=r(2115),a=r(3571),n=r(1204);function i(){let[e,t]=(0,l.useState)([]),[r,i]=(0,l.useState)(!0),[c,d]=(0,l.useState)(!1),[x,m]=(0,l.useState)(null),y=(0,l.useCallback)(async()=>{i(!0),m(null);try{let e=await fetch("".concat(n.t,"/api/user/inventory"),{credentials:"include"});if(e.ok){let r=await e.json(),s=r.items||r.inventory||[];t(s),localStorage.setItem("eurokeys_inventory",JSON.stringify(s))}else throw Error("API returned error")}catch(e){console.warn("Could not fetch from Cloudflare, using local storage:",e),m("Using offline data. Changes will sync when online.");{let e=localStorage.getItem("eurokeys_inventory");e&&t(JSON.parse(e))}}finally{i(!1)}},[]);(0,l.useEffect)(()=>{y()},[y]);let g=(0,l.useCallback)(async e=>{d(!0);try{await fetch("".concat(n.t,"/api/user/inventory"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:e})})}catch(e){console.warn("Could not sync to Cloudflare:",e)}finally{d(!1)}},[]),u=(r,s,l)=>{let a=e.map(e=>e.itemKey===r&&e.type===s?{...e,qty:Math.max(0,e.qty+l)}:e).filter(e=>e.qty>0);t(a),localStorage.setItem("eurokeys_inventory",JSON.stringify(a)),g(a)},b=e.filter(e=>"key"===e.type),h=e.filter(e=>"blank"===e.type);return(0,s.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Inventory Management"}),(0,s.jsxs)("p",{className:"text-gray-400 mt-1",children:["Track your key fobs and blade stock.",c&&(0,s.jsx)("span",{className:"ml-2 text-yellow-500 animate-pulse",children:"Syncing..."})]}),x&&(0,s.jsx)("p",{className:"text-yellow-500 text-sm mt-1",children:x})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)(a.A,{toolName:"AutoProPad"}),(0,s.jsx)(a.A,{toolName:"Autel"})]})]}),r?(0,s.jsx)("div",{className:"text-center py-20 text-gray-500",children:"Loading inventory..."}):0===e.length?(0,s.jsxs)("div",{className:"text-center py-20 border border-dashed border-gray-800 rounded-2xl bg-gray-900/50",children:[(0,s.jsx)("div",{className:"text-5xl mb-4",children:"\uD83D\uDCE6"}),(0,s.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Your inventory is empty"}),(0,s.jsx)("p",{className:"text-gray-400 max-w-xs mx-auto mb-6",children:"Browse vehicles and add items to your inventory to track stock."}),(0,s.jsx)("a",{href:"/browse",className:"px-6 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg transition-colors",children:"Browse Vehicles"})]}):(0,s.jsxs)("div",{className:"space-y-12",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-gray-900 p-4 rounded-xl border border-gray-800",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Total Items"}),(0,s.jsx)("div",{className:"text-2xl font-bold",children:e.length})]}),(0,s.jsxs)("div",{className:"bg-gray-900 p-4 rounded-xl border border-gray-800",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"In Stock"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-green-500",children:e.reduce((e,t)=>e+t.qty,0)})]}),(0,s.jsxs)("div",{className:"bg-gray-900 p-4 rounded-xl border border-gray-800",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Key Fobs"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:b.length})]}),(0,s.jsxs)("div",{className:"bg-gray-900 p-4 rounded-xl border border-gray-800",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wider mb-1",children:"Key Blanks"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:h.length})]})]}),b.length>0&&(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-6 pb-2 border-b border-gray-800",children:"Remote Keys & Fobs"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(e=>(0,s.jsx)(o,{item:e,onUpdate:u},"".concat(e.itemKey,"-").concat(e.type)))})]}),h.length>0&&(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-6 pb-2 border-b border-gray-800",children:"Key Blanks & Blades"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(e=>(0,s.jsx)(o,{item:e,onUpdate:u},"".concat(e.itemKey,"-").concat(e.type)))})]})]})]})}function o(e){let{item:t,onUpdate:r}=e,l=t.qty<3;return(0,s.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-5 flex flex-col justify-between hover:border-gray-700 transition-colors",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsx)("div",{className:"font-bold text-lg truncate pr-2",title:t.itemKey,children:t.itemKey}),(0,s.jsxs)("div",{className:"px-2 py-1 rounded text-xs font-bold ".concat(l?"bg-red-900/40 text-red-400":"bg-green-900/40 text-green-400"),children:[t.qty," IN STOCK"]})]}),t.vehicle&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500 uppercase block mb-1",children:"Compatibility"}),(0,s.jsx)("p",{className:"text-sm text-gray-300 line-clamp-2",children:t.vehicle})]}),t.fcc_id&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500 uppercase block mb-1",children:"FCC ID"}),(0,s.jsx)("p",{className:"text-sm text-yellow-500 font-mono",children:t.fcc_id})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 mt-4 pt-4 border-t border-gray-800/50",children:[(0,s.jsx)("button",{onClick:()=>r(t.itemKey,t.type,-1),className:"flex-1 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-lg font-bold transition-colors",children:"−"}),(0,s.jsx)("button",{onClick:()=>r(t.itemKey,t.type,1),className:"flex-1 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-lg font-bold transition-colors",children:"+"}),t.link&&(0,s.jsx)("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"flex-none px-4 py-2 bg-yellow-600/20 text-yellow-500 border border-yellow-600/30 rounded-lg font-bold hover:bg-yellow-600/30 transition-colors",children:"BUY"})]})]})}},3571:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(5155);r(2115);var l=r(4325);let a=e=>{let{toolName:t}=e,{getSubscriptionStatus:r,loading:a}=(0,l.Q)();if(a)return(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-800 text-gray-400 animate-pulse",children:"Checking..."});let{status:n,text:i}=r(t);return"none"===n?null:(0,s.jsxs)("div",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-lg border text-sm font-semibold ".concat({active:"bg-green-900/30 text-green-400 border-green-800",warning:"bg-yellow-900/30 text-yellow-500 border-yellow-800",expired:"bg-red-900/30 text-red-500 border-red-800"}[n]),children:[(0,s.jsx)("span",{children:{active:"✅",warning:"⚠️",expired:"❌"}[n]}),(0,s.jsxs)("span",{children:[t,": ",i]})]})}},3744:(e,t,r)=>{Promise.resolve().then(r.bind(r,2170))},4325:(e,t,r)=>{"use strict";r.d(t,{Q:()=>i,d:()=>n});var s=r(5155),l=r(2115);let a=(0,l.createContext)(void 0),n=e=>{let{children:t}=e,[r,n]=(0,l.useState)([]),[i,o]=(0,l.useState)(!0),[c,d]=(0,l.useState)(null),x=async()=>{o(!0),d(null);try{let e=await fetch("".concat("https://euro-keys.jeremy-samuels17.workers.dev/api/user","/tool-subscriptions"));if(!e.ok)throw Error("Failed to fetch subscriptions");let t=await e.json();n(t),localStorage.setItem("eurokeys_user_subscriptions",JSON.stringify(t))}catch(e){console.error("Error fetching subscriptions:",e),d("Could not load subscriptions. Using cached data if available.");{let e=localStorage.getItem("eurokeys_user_subscriptions");e&&n(JSON.parse(e))}}finally{o(!1)}};return(0,l.useEffect)(()=>{x()},[]),(0,s.jsx)(a.Provider,{value:{subscriptions:r,loading:i,error:c,refreshSubscriptions:x,getSubscriptionStatus:e=>{let t=r.find(t=>t.name.toLowerCase().includes(e.toLowerCase()));if(!t)return{status:"none",daysLeft:0,text:"Not Found"};let s=new Date;s.setHours(0,0,0,0);let l=Math.ceil((new Date(t.expirationDate).getTime()-s.getTime())/864e5),a="active",n="Active";return l<0?(a="expired",n="Expired"):0===l?(a="warning",n="Due Today"):l<=30?(a="warning",n="".concat(l," days left")):n="".concat(l," days remaining"),{status:a,daysLeft:l,text:n}}},children:t})},i=()=>{let e=(0,l.useContext)(a);if(void 0===e)throw Error("useSubscriptions must be used within a SubscriptionProvider");return e}}},e=>{e.O(0,[441,964,358],()=>e(e.s=3744)),_N_E=e.O()}]);