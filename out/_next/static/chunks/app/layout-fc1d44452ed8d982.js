(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{1204:(e,t,r)=>{"use strict";r.d(t,{h:()=>a,t:()=>s});let s="https://euro-keys.jeremy-samuels17.workers.dev",a="eurokeys-20"},3274:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,O:()=>l});var s=r(5155),a=r(2115),o=r(1204);let i=(0,a.createContext)(void 0),n="".concat(o.t,"/api/auth/google"),l=e=>{let{children:t}=e,[r,l]=(0,a.useState)(null),[c,u]=(0,a.useState)(!0),d=(0,a.useCallback)(()=>{let e=null,t=!1,r=window.location.hash||"";if(r.startsWith("#auth_token=")?(e=r.substring(12),t=!0):r.includes("auth_token=")&&(t=!!(e=new URLSearchParams(r.slice(1)).get("auth_token"))),!e){let t=new URLSearchParams(window.location.search);if(e=t.get("auth_token")){t.delete("auth_token");let e=window.location.pathname+(t.toString()?"?".concat(t):"");window.history.replaceState(null,"",e)}}if(!e)return!1;if(localStorage.setItem("session_token",e),t){let e=window.location.pathname+window.location.search;window.history.replaceState(null,"",e)}return!0},[]),h=(0,a.useCallback)(async()=>{let e=localStorage.getItem("session_token");if(!e)return void u(!1);try{let t=await fetch("".concat(o.t,"/api/user"),{headers:{Authorization:"Bearer ".concat(e)}}),r=await t.json();if(r.user&&r.user.email){let e={id:r.user.id||r.user.sub,email:r.user.email,name:r.user.name||r.user.email.split("@")[0],picture:r.user.picture,is_developer:r.user.is_developer,is_pro:r.user.is_pro,trial_until:r.user.trial_until,created_at:r.user.created_at};l(e),localStorage.setItem("eurokeys_user",JSON.stringify(e))}else localStorage.removeItem("session_token"),localStorage.removeItem("eurokeys_user")}catch(t){console.error("Session verification failed:",t);let e=localStorage.getItem("eurokeys_user");if(e)try{l(JSON.parse(e))}catch(e){localStorage.removeItem("eurokeys_user")}}finally{u(!1)}},[]);(0,a.useEffect)(()=>{(async()=>{d()?(await h(),window.location.hash.includes("auth_token")&&window.history.replaceState(null,"",window.location.pathname+window.location.search)):await h()})()},[d,h]);let p=(0,a.useCallback)(()=>{let e=encodeURIComponent(window.location.origin);window.location.href="".concat(n,"?redirect=").concat(e)},[]),m=(0,a.useCallback)(async()=>{try{await fetch("".concat(o.t,"/api/auth/logout"),{credentials:"include"})}catch(e){console.error("Backend logout failed:",e)}l(null),localStorage.removeItem("session_token"),localStorage.removeItem("eurokeys_user")},[]),x=!!(r&&(r.is_pro||r.trial_until&&r.trial_until>Date.now()/1e3)),w=!!(r&&r.is_developer);return(0,s.jsx)(i.Provider,{value:{user:r,loading:c,login:p,logout:m,isAuthenticated:!!r,isDeveloper:w,isPro:x},children:t})},c=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},3556:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,9324,23)),Promise.resolve().then(r.bind(r,8423)),Promise.resolve().then(r.bind(r,4824))},4325:(e,t,r)=>{"use strict";r.d(t,{Q:()=>l,d:()=>n});var s=r(5155),a=r(2115),o=r(1204);let i=(0,a.createContext)(void 0),n=e=>{let{children:t}=e,[r,n]=(0,a.useState)([]),[l,c]=(0,a.useState)(!0),[u,d]=(0,a.useState)(null),h=async()=>{c(!0),d(null);try{let e=await fetch("".concat(o.t,"/api/user/tool-subscriptions"));if(!e.ok)throw Error("Failed to fetch subscriptions");let t=await e.json(),r=Array.isArray(t)?t:t.subscriptions||[];n(r),localStorage.setItem("eurokeys_user_subscriptions",JSON.stringify(r))}catch(e){console.error("Error fetching subscriptions:",e),d("Could not load subscriptions. Using cached data if available.");{let e=localStorage.getItem("eurokeys_user_subscriptions");e&&n(JSON.parse(e))}}finally{c(!1)}};return(0,a.useEffect)(()=>{h()},[]),(0,s.jsx)(i.Provider,{value:{subscriptions:r,loading:l,error:u,refreshSubscriptions:h,getSubscriptionStatus:e=>{let t=r.find(t=>t.name.toLowerCase().includes(e.toLowerCase()));if(!t)return{status:"none",daysLeft:0,text:"Not Found"};let s=new Date;s.setHours(0,0,0,0);let a=Math.ceil((new Date(t.expirationDate).getTime()-s.getTime())/864e5),o="active",i="Active";return a<0?(o="expired",i="Expired"):0===a?(o="warning",i="Due Today"):a<=30?(o="warning",i="".concat(a," days left")):i="".concat(a," days remaining"),{status:o,daysLeft:a,text:i}}},children:t})},l=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useSubscriptions must be used within a SubscriptionProvider");return e}},4824:(e,t,r)=>{"use strict";r.d(t,{GoogleSignInButton:()=>i});var s=r(5155),a=r(2115),o=r(3274);let i=()=>{let{user:e,loading:t,login:r,logout:i,isDeveloper:n}=(0,o.A)(),[l,c]=(0,a.useState)(!1),u=(0,a.useRef)(null);if((0,a.useEffect)(()=>{let e=e=>{u.current&&!u.current.contains(e.target)&&c(!1)};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]),t)return(0,s.jsx)("div",{className:"h-9 w-24 animate-pulse rounded-full bg-slate-700"});if(!e)return(0,s.jsxs)("button",{onClick:r,className:"flex items-center gap-2 rounded-full bg-white px-4 py-2 text-sm font-medium text-slate-800 shadow-md transition-all hover:shadow-lg hover:scale-105",children:[(0,s.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",children:[(0,s.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,s.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,s.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,s.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Sign in"]});let d=e.name.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase();return(0,s.jsxs)("div",{ref:u,className:"relative",children:[(0,s.jsxs)("button",{onClick:()=>c(!l),className:"flex items-center gap-2 rounded-full bg-slate-800 py-1 pl-1 pr-3 transition-colors hover:bg-slate-700",children:[e.picture?(0,s.jsx)("img",{src:e.picture,alt:e.name,className:"h-8 w-8 rounded-full object-cover"}):(0,s.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-eurokeys-purple text-xs font-bold text-white",children:d}),(0,s.jsx)("span",{className:"text-sm text-slate-300",children:e.name.split(" ")[0]}),(0,s.jsx)("svg",{className:"h-4 w-4 text-slate-400 transition-transform ".concat(l?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),l&&(0,s.jsxs)("div",{className:"absolute right-0 top-12 z-50 w-56 rounded-xl border border-eurokeys-border bg-eurokeys-dark shadow-xl",children:[(0,s.jsxs)("div",{className:"border-b border-eurokeys-border p-4",children:[(0,s.jsx)("p",{className:"font-medium text-white",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-slate-400",children:e.email})]}),(0,s.jsxs)("div",{className:"p-2",children:[n&&(0,s.jsxs)("a",{href:"/dev",className:"flex items-center gap-2 rounded-lg px-3 py-2 text-sm text-slate-300 transition-colors hover:bg-eurokeys-purple/20 hover:text-white",children:[(0,s.jsx)("span",{children:"\uD83D\uDEE0ï¸"}),"Dev Panel"]}),(0,s.jsxs)("a",{href:"/inventory",className:"flex items-center gap-2 rounded-lg px-3 py-2 text-sm text-slate-300 transition-colors hover:bg-eurokeys-purple/20 hover:text-white",children:[(0,s.jsx)("span",{children:"\uD83D\uDCE6"}),"Inventory"]}),(0,s.jsxs)("button",{onClick:i,className:"flex w-full items-center gap-2 rounded-lg px-3 py-2 text-sm text-red-400 transition-colors hover:bg-red-500/20 hover:text-red-300",children:[(0,s.jsx)("span",{children:"\uD83D\uDEAA"}),"Sign Out"]})]})]})]})}},8423:(e,t,r)=>{"use strict";r.d(t,{Providers:()=>i});var s=r(5155);r(2115);var a=r(3274),o=r(4325);function i(e){let{children:t}=e;return(0,s.jsx)(a.O,{children:(0,s.jsx)(o.d,{children:t})})}},9324:()=>{}},e=>{e.O(0,[533,441,964,358],()=>e(e.s=3556)),_N_E=e.O()}]);