<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2023 Chevrolet Colorado | EuroKeys Demo</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            min-height: 100vh;
            color: #e2e8f0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 32px 24px;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 800;
            text-align: center;
            margin-bottom: 8px;
        }

        .subtitle {
            text-align: center;
            color: #94a3b8;
            margin-bottom: 32px;
        }

        .badge {
            display: inline-block;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 4px 12px;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .badge.purple {
            background: linear-gradient(135deg, #a855f7, #7c3aed);
        }

        .section {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 28px;
            margin-bottom: 24px;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.25rem;
            font-weight: 700;
            color: #4ade80;
            margin-bottom: 20px;
        }

        /* ==========================================
           TWO-COLUMN MAIN LAYOUT
           ========================================== */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 340px;
            gap: 24px;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .left-column {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .right-column {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        /* ==========================================
           VEHICLE SPECS GRID
           ========================================== */
        .specs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
        }

        .spec-item {
            background: rgba(30, 41, 59, 0.6);
            padding: 16px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .spec-label {
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
            margin-bottom: 4px;
        }

        .spec-value {
            font-size: 1rem;
            font-weight: 600;
            color: white;
        }

        /* ==========================================
           KEY CARDS - FIXED GRID (2-6 keys)
           ========================================== */
        .key-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            min-height: 320px;
        }

        @media (max-width: 900px) {
            .key-cards {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .key-card {
            background: linear-gradient(145deg, rgba(30, 41, 59, 0.8), rgba(15, 23, 42, 0.9));
            border-radius: 16px;
            border: 2px solid;
            padding: 16px;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 280px;
        }

        .key-card.green {
            border-color: #22c55e;
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.2);
        }

        .key-card.purple {
            border-color: #a855f7;
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.2);
        }

        .key-card.amber {
            border-color: #f59e0b;
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.2);
        }

        .key-card h4 {
            font-size: 1rem;
            margin-bottom: 2px;
        }

        .key-card h4.green {
            color: #4ade80;
        }

        .key-card h4.purple {
            color: #c084fc;
        }

        .key-card h4.amber {
            color: #fbbf24;
        }

        .key-card .trim {
            color: #94a3b8;
            font-size: 0.75rem;
            margin-bottom: 8px;
        }

        .key-img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin: 8px auto;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 8px;
        }

        .key-buttons {
            font-size: 0.8rem;
            color: #94a3b8;
            margin: 8px 0;
        }

        .key-buttons .start {
            color: #fbbf24;
        }

        .key-fcc {
            font-size: 0.7rem;
            color: #64748b;
            margin-top: 8px;
        }

        .key-fcc strong {
            color: #94a3b8;
        }

        .oem-parts {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 8px;
        }

        .oem-part {
            background: rgba(99, 102, 241, 0.15);
            color: #a5b4fc;
            padding: 3px 8px;
            border-radius: 6px;
            font-size: 0.65rem;
            font-family: 'SF Mono', monospace;
            cursor: help;
            position: relative;
        }

        .oem-part:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(15, 23, 42, 0.95);
            color: #e2e8f0;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.65rem;
            white-space: nowrap;
            z-index: 100;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .price {
            color: #4ade80;
            font-size: 0.9rem;
            font-weight: 700;
            margin-top: auto;
        }

        .included-badge {
            background: rgba(168, 85, 247, 0.2);
            color: #c084fc;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-top: auto;
        }

        /* ==========================================
           INTEGRATED PEARL CHIPS
           ========================================== */
        .pearl-inline {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 6px;
            padding: 4px 8px;
            font-size: 0.7rem;
            color: #fbbf24;
            margin: 4px 2px;
        }

        .pearl-inline.critical {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
            color: #f87171;
        }

        .pearl-inline.info {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
            color: #60a5fa;
        }

        /* ==========================================
           PROGRAMMING PROCEDURES SECTION
           ========================================== */
        .procedure-tabs {
            display: flex;
            gap: 0;
            margin-bottom: 20px;
        }

        .procedure-tab {
            flex: 1;
            padding: 14px 20px;
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #94a3b8;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .procedure-tab:first-child {
            border-radius: 12px 0 0 12px;
        }

        .procedure-tab:last-child {
            border-radius: 0 12px 12px 0;
        }

        .procedure-tab.active {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
            border-color: #22c55e;
        }

        .procedure-tab.active.akl {
            background: linear-gradient(135deg, #64748b, #475569);
            border-color: #64748b;
        }

        .requirements-bar {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .requirements-title {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #4ade80;
            font-weight: 700;
            font-size: 0.85rem;
            margin-bottom: 12px;
        }

        .requirement-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .requirement-chip {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 0.75rem;
            color: #e2e8f0;
        }

        .procedure-steps {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .procedure-step {
            display: flex;
            gap: 16px;
            align-items: flex-start;
        }

        .step-number {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
            font-size: 0.85rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: 700;
            color: #e2e8f0;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .step-title .insight {
            color: #fbbf24;
            font-size: 0.85rem;
        }

        .step-desc {
            font-size: 0.85rem;
            color: #94a3b8;
        }

        /* ==========================================
           LOCKSMITH SIDEBAR - "BUY THIS FIRST"
           ========================================== */
        .sidebar-card {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
        }

        .sidebar-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
            font-weight: 700;
            color: #fbbf24;
            margin-bottom: 16px;
        }

        .tool-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(30, 41, 59, 0.6);
            border-radius: 12px;
            margin-bottom: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .tool-item:hover {
            border-color: rgba(251, 191, 36, 0.3);
        }

        .tool-icon {
            width: 40px;
            height: 40px;
            background: rgba(251, 191, 36, 0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .tool-info {
            flex: 1;
        }

        .tool-name {
            font-weight: 600;
            color: #e2e8f0;
            font-size: 0.85rem;
        }

        .tool-desc {
            font-size: 0.75rem;
            color: #64748b;
        }

        .tool-required {
            background: rgba(239, 68, 68, 0.15);
            color: #f87171;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.65rem;
            font-weight: 700;
        }

        .gotcha-box {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-top: 16px;
        }

        .gotcha-title {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #f87171;
            font-weight: 700;
            font-size: 0.85rem;
            margin-bottom: 8px;
        }

        .gotcha-text {
            font-size: 0.8rem;
            color: #fca5a5;
            line-height: 1.5;
        }

        .tip-box {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-top: 16px;
        }

        .tip-title {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #4ade80;
            font-weight: 700;
            font-size: 0.85rem;
            margin-bottom: 8px;
        }

        .tip-text {
            font-size: 0.8rem;
            color: #86efac;
            line-height: 1.5;
        }

        /* ==========================================
           VISUAL REFERENCES & PEARLS
           ========================================== */
        .visual-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
        }

        .visual-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .visual-card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }

        .visual-card .content {
            padding: 12px;
        }

        .visual-card .type {
            color: #fbbf24;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .visual-card .desc {
            color: #94a3b8;
            font-size: 0.8rem;
            margin-top: 4px;
        }

        .pearls-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .pearl-chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 0.8rem;
        }

        .pearl-chip.risk-high {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        .pearl-chip.risk-medium {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
        }

        .pearl-chip.risk-info {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
        }

        .error {
            color: #f87171;
            padding: 20px;
            text-align: center;
        }

        .loading-text {
            color: #94a3b8;
            padding: 20px;
            text-align: center;
        }

        /* ==========================================
           INSIGHT MODAL
           ========================================== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(145deg, #1e293b, #0f172a);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            padding: 28px;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .modal-close {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #94a3b8;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .modal-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.25rem;
            font-weight: 700;
            color: #fbbf24;
            margin-bottom: 16px;
        }

        .modal-body {
            color: #e2e8f0;
            line-height: 1.7;
            font-size: 0.95rem;
        }

        .modal-source {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.75rem;
            color: #64748b;
        }

        .pearl-chip.clickable {
            cursor: pointer;
            transition: all 0.2s;
        }

        .pearl-chip.clickable:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .insight.clickable {
            cursor: pointer;
            transition: transform 0.2s;
        }

        .insight.clickable:hover {
            transform: scale(1.3);
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>2023 Chevrolet Colorado</h1>
        <p class="subtitle">
            <span class="badge purple">GLOBAL B (VIP) ARCHITECTURE</span>
            &nbsp;¬∑&nbsp;
            <span class="pearl-inline critical">‚ö†Ô∏è CAN FD Required</span>
            <span class="pearl-inline">üí° New in 2023: Push-button start standard</span>
        </p>

        <!-- Vehicle Specs -->
        <section class="section">
            <h3 class="section-title">üîß Vehicle Specifications</h3>
            <div class="specs-grid">
                <div class="spec-item">
                    <div class="spec-label">Architecture</div>
                    <div class="spec-value" style="color:#a855f7">GLOBAL B</div>
                </div>
                <div class="spec-item">
                    <div class="spec-label">CAN FD</div>
                    <div class="spec-value" style="color:#ef4444">REQUIRED</div>
                </div>
                <div class="spec-item">
                    <div class="spec-label">Chip Type</div>
                    <div class="spec-value">üîí HITAG 3 (ID49)</div>
                </div>
                <div class="spec-item">
                    <div class="spec-label">FCC ID</div>
                    <div class="spec-value" style="font-family:monospace">üì° YG0G21TB2</div>
                </div>
                <div class="spec-item">
                    <div class="spec-label">Battery</div>
                    <div class="spec-value">CR2450</div>
                </div>
                <div class="spec-item">
                    <div class="spec-label">Keyway / Lishi</div>
                    <div class="spec-value" style="color:#22c55e">HU100</div>
                </div>
            </div>
        </section>

        <!-- TWO-COLUMN LAYOUT -->
        <div class="main-content">
            <div class="left-column">
                <!-- Key Types -->
                <section class="section">
                    <h3 class="section-title">üîë Key Types for This Vehicle</h3>
                    <div class="key-cards">
                        <!-- 3-Button Smart Key -->
                        <div class="key-card green">
                            <h4 class="green">3-Button Smart Key</h4>
                            <div class="trim">Base / WT Trim</div>
                            <img src="assets/vehicles/chevrolet/colorado-2023/key-3btn.png" alt="3-Button Smart Key"
                                class="key-img" onerror="this.src='https://via.placeholder.com/80?text=3-Btn'">
                            <div class="key-buttons">Lock ¬∑ Unlock ¬∑ Panic</div>
                            <div class="key-fcc">
                                <strong>FCC:</strong> YG0G21TB2 &nbsp; <strong>Freq:</strong> 433 MHz<br>
                                <strong>Battery:</strong> CR2450
                            </div>
                            <div class="oem-parts">
                                <span class="oem-part" data-tooltip="Original GM part# 2021-2022">13548436</span>
                                <span class="oem-part" data-tooltip="Superseded 2022-2023">13514330</span>
                                <span class="oem-part" data-tooltip="Current 2023-2025">13560198</span>
                            </div>
                            <div class="price">$67 - $98</div>
                        </div>

                        <!-- 4-Button Smart Key -->
                        <div class="key-card purple">
                            <h4 class="purple">4-Button Smart Key</h4>
                            <div class="trim">LT / Z71 / Trail Boss</div>
                            <img src="assets/vehicles/chevrolet/colorado-2023/key-4btn.png" alt="4-Button Smart Key"
                                class="key-img" onerror="this.src='https://via.placeholder.com/80?text=4-Btn'">
                            <div class="key-buttons">Lock ¬∑ Unlock ¬∑ Panic ¬∑ <span class="start">Start</span></div>
                            <div class="key-fcc">
                                <strong>FCC:</strong> YG0G21TB2 &nbsp; <strong>Freq:</strong> 433 MHz<br>
                                <strong>Battery:</strong> CR2450
                            </div>
                            <div class="oem-parts">
                                <span class="oem-part" data-tooltip="Original GM part# 2021-2022">13560201</span>
                                <span class="oem-part" data-tooltip="Superseded 2022-2023">13548442</span>
                                <span class="oem-part" data-tooltip="Current 2023-2025">13541260</span>
                            </div>
                            <div class="price">$80 - $110</div>
                        </div>

                        <!-- Emergency Key Blade -->
                        <div class="key-card amber">
                            <h4 class="amber">Emergency Key Blade</h4>
                            <div class="trim">Physical Access Only</div>
                            <img src="assets/vehicles/chevrolet/colorado-2023/key-blade.png" alt="Emergency Key Blade"
                                class="key-img" onerror="this.src='https://via.placeholder.com/80?text=Blade'">
                            <div class="key-buttons">Door Unlock ¬∑ Backup Start</div>
                            <div class="key-fcc">
                                <strong>Blade:</strong> B122 &nbsp;&nbsp; <strong>Profile:</strong> HU100<br>
                                <strong>Cut:</strong> 10-Cut &nbsp;&nbsp; <strong>Style:</strong> Laser
                            </div>
                            <div class="included-badge">Included w/ Fob</div>
                        </div>
                    </div>
                </section>

                <!-- Programming Procedures -->
                <section class="section">
                    <h3 class="section-title">üîß Programming Procedures</h3>

                    <div class="procedure-tabs">
                        <button class="procedure-tab active" onclick="showProcedure('addkey')">
                            ‚ú® Add Key (Has Working Key)
                        </button>
                        <button class="procedure-tab akl" onclick="showProcedure('akl')">
                            üîí All Keys Lost (AKL)
                        </button>
                    </div>

                    <div id="addkey-procedure">
                        <div class="requirements-bar">
                            <div class="requirements-title">‚úÖ REQUIREMENTS</div>
                            <div class="requirement-chips">
                                <span class="requirement-chip">Working Key Present</span>
                                <span class="requirement-chip">CAN FD Adapter</span>
                                <span class="requirement-chip">Battery Maintainer</span>
                                <span class="requirement-chip">Internet Connection</span>
                            </div>
                        </div>

                        <div class="procedure-steps">
                            <div class="procedure-step">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <div class="step-title">Connect Equipment <span class="insight clickable"
                                            onclick="openInsightModal('CAN FD Required', '2023+ GM Global B vehicles REQUIRE CAN FD protocol. Your standard CAN adapter will NOT work. Make sure you have updated firmware on your tool before arriving on-site. Autel IM608 Pro II has built-in CAN FD; otherwise you need the separate adapter.', 'GM Global B Architecture Guide')">üí°</span>
                                    </div>
                                    <div class="step-desc">Connect OBD-II with <strong>CAN FD adapter</strong>. Attach
                                        battery maintainer. Verify voltage ‚â•12.4V.</div>
                                </div>
                            </div>
                            <div class="procedure-step">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <div class="step-title">Turn Hazards ON <span class="insight clickable"
                                            onclick="openInsightModal('Keep Modules Awake', 'On GM Global B vehicles, the BCM goes into sleep mode quickly. Turning on hazard lights sends periodic CAN messages that keep all modules awake during the programming session. This prevents communication dropouts mid-procedure.', 'GM T1XX Platform Dossier')">üí°</span>
                                    </div>
                                    <div class="step-desc">Activate hazard lights to keep modules awake during
                                        programming.</div>
                                </div>
                            </div>
                            <div class="procedure-step">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <div class="step-title">Launch Tool Software</div>
                                    <div class="step-desc">Select Chevrolet ‚Üí Colorado ‚Üí 2023 ‚Üí Immobilizer ‚Üí Add Smart
                                        Key.</div>
                                </div>
                            </div>
                            <div class="procedure-step">
                                <div class="step-number">4</div>
                                <div class="step-content">
                                    <div class="step-title">Follow On-Screen Prompts</div>
                                    <div class="step-desc">Present working key when prompted, then present new key
                                        within 30 seconds.</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="akl-procedure" style="display: none;">
                        <div class="requirements-bar"
                            style="border-color: rgba(239, 68, 68, 0.3); background: rgba(239, 68, 68, 0.1);">
                            <div class="requirements-title" style="color: #f87171;">‚ö†Ô∏è AKL REQUIREMENTS</div>
                            <div class="requirement-chips">
                                <span class="requirement-chip">ADAS Calibration Data</span>
                                <span class="requirement-chip">CAN FD Adapter</span>
                                <span class="requirement-chip">Security Gateway Bypass</span>
                                <span class="requirement-chip">Online PIN Calculation</span>
                            </div>
                        </div>

                        <div class="procedure-steps">
                            <div class="procedure-step">
                                <div class="step-number" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                                    1</div>
                                <div class="step-content">
                                    <div class="step-title">Bypass Security Gateway</div>
                                    <div class="step-desc">Use AutoAuth or equivalent SGW bypass. Required for all 2023+
                                        GM VIP vehicles.</div>
                                </div>
                            </div>
                            <div class="procedure-step">
                                <div class="step-number" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                                    2</div>
                                <div class="step-content">
                                    <div class="step-title">Read IMMO Data</div>
                                    <div class="step-desc">Extract security data from BCM. Requires CAN FD capability.
                                    </div>
                                </div>
                            </div>
                            <div class="procedure-step">
                                <div class="step-number" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                                    3</div>
                                <div class="step-content">
                                    <div class="step-title">Online PIN Calculation</div>
                                    <div class="step-desc">Submit data for online calculation. ~2-5 minute wait time.
                                    </div>
                                </div>
                            </div>
                            <div class="procedure-step">
                                <div class="step-number" style="background: linear-gradient(135deg, #ef4444, #dc2626);">
                                    4</div>
                                <div class="step-content">
                                    <div class="step-title">Program New Keys</div>
                                    <div class="step-desc">Enter PIN and program up to 8 keys. Test all functions before
                                        leaving.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Visual References -->
                <section class="section">
                    <h3 class="section-title">üì∏ Visual References</h3>
                    <div class="visual-grid" id="visual-grid">
                        <div class="loading-text">Loading images...</div>
                    </div>
                </section>

                <!-- Technical Pearls -->
                <section class="section">
                    <h3 class="section-title">üíé Technical Pearls</h3>
                    <div class="pearls-container" id="pearls-container">
                        <div class="loading-text">Loading pearls...</div>
                    </div>
                </section>
            </div>

            <!-- RIGHT SIDEBAR - Locksmith Needs -->
            <div class="right-column">
                <div class="sidebar-card">
                    <div class="sidebar-title">üõí Buy This First</div>

                    <div class="tool-item">
                        <div class="tool-icon">üîå</div>
                        <div class="tool-info">
                            <div class="tool-name">CAN FD Adapter</div>
                            <div class="tool-desc">Required for 2023+ GM VIP</div>
                        </div>
                        <span class="tool-required">REQUIRED</span>
                    </div>

                    <div class="tool-item">
                        <div class="tool-icon">üîã</div>
                        <div class="tool-info">
                            <div class="tool-name">Battery Maintainer</div>
                            <div class="tool-desc">12V+ throughout procedure</div>
                        </div>
                        <span class="tool-required">REQUIRED</span>
                    </div>

                    <div class="tool-item">
                        <div class="tool-icon">üîì</div>
                        <div class="tool-info">
                            <div class="tool-name">AutoAuth SGW Bypass</div>
                            <div class="tool-desc">For AKL procedures</div>
                        </div>
                    </div>

                    <div class="tool-item">
                        <div class="tool-icon">üîë</div>
                        <div class="tool-info">
                            <div class="tool-name">Lishi HU100 2-in-1</div>
                            <div class="tool-desc">Pick & decode</div>
                        </div>
                    </div>

                    <div class="gotcha-box">
                        <div class="gotcha-title">‚ö†Ô∏è Critical Gotcha</div>
                        <div class="gotcha-text">
                            <strong>2023+ Colorado requires CAN FD.</strong> Standard CAN tools will NOT communicate.
                            Verify tool firmware is updated before arriving on-site.
                        </div>
                    </div>

                    <div class="tip-box">
                        <div class="tip-title">üí° Pro Tip</div>
                        <div class="tip-text">
                            The emergency blade is laser-cut HU100. Can be decoded from the working fob blade slot or
                            picked with Lishi HU100.
                        </div>
                    </div>
                </div>

                <div class="sidebar-card">
                    <div class="sidebar-title">üìä Job Pricing Guide</div>

                    <div
                        style="display: flex; justify-content: space-between; padding: 12px; background: rgba(34, 197, 94, 0.1); border-radius: 8px; margin-bottom: 12px;">
                        <span style="color: #94a3b8;">Add Key</span>
                        <span style="color: #4ade80; font-weight: 700;">$150 - $200</span>
                    </div>

                    <div
                        style="display: flex; justify-content: space-between; padding: 12px; background: rgba(239, 68, 68, 0.1); border-radius: 8px; margin-bottom: 12px;">
                        <span style="color: #94a3b8;">All Keys Lost</span>
                        <span style="color: #f87171; font-weight: 700;">$350 - $450</span>
                    </div>

                    <div
                        style="display: flex; justify-content: space-between; padding: 12px; background: rgba(168, 85, 247, 0.1); border-radius: 8px;">
                        <span style="color: #94a3b8;">Remote Only</span>
                        <span style="color: #c084fc; font-weight: 700;">$75 - $100</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Insight Modal -->
    <div id="insight-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close" onclick="closeInsightModal()">&times;</button>
            <div class="modal-title">
                <span>üí°</span>
                <span id="modal-title-text">Insight</span>
            </div>
            <div class="modal-body" id="modal-body-text">
                Loading...
            </div>
            <div class="modal-source" id="modal-source-text"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'https://euro-keys.jeremy-samuels17.workers.dev';

        // Procedure tab switching
        function showProcedure(type) {
            const addkeyBtn = document.querySelector('.procedure-tab:first-child');
            const aklBtn = document.querySelector('.procedure-tab:last-child');
            const addkeyProc = document.getElementById('addkey-procedure');
            const aklProc = document.getElementById('akl-procedure');

            if (type === 'addkey') {
                addkeyBtn.classList.add('active');
                aklBtn.classList.remove('active');
                addkeyProc.style.display = 'block';
                aklProc.style.display = 'none';
            } else {
                addkeyBtn.classList.remove('active');
                aklBtn.classList.add('active');
                addkeyProc.style.display = 'none';
                aklProc.style.display = 'block';
            }
        }

        // Fetch visual references
        async function loadImages() {
            const grid = document.getElementById('visual-grid');
            try {
                const res = await fetch(`${API_BASE}/api/images?make=chevrolet`);
                const data = await res.json();

                if (data.images && data.images.length > 0) {
                    grid.innerHTML = data.images.slice(0, 4).map(img => `
                        <div class="visual-card">
                            <img src="${img.url || 'https://via.placeholder.com/200x120?text=Loading...'}" 
                                 alt="${img.description || img.filename}"
                                 onerror="this.src='https://via.placeholder.com/200x120?text=Image'">
                            <div class="content">
                                <div class="type">${img.image_type || 'reference'}</div>
                                <p class="desc">${img.description || img.filename}</p>
                            </div>
                        </div>
                    `).join('');
                } else {
                    grid.innerHTML = '<div class="error">No images found.</div>';
                }
            } catch (err) {
                grid.innerHTML = `<div class="error">Error: ${err.message}</div>`;
            }
        }

        // Fetch pearls from refined_pearls
        async function loadPearls() {
            const container = document.getElementById('pearls-container');
            try {
                const res = await fetch(`${API_BASE}/api/pearls?make=chevrolet&model=colorado&limit=20`);
                const data = await res.json();

                let pearlsToShow = data.pearls || [];

                // Fallback to make-level pearls if no model-specific ones
                if (pearlsToShow.length === 0) {
                    const gmRes = await fetch(`${API_BASE}/api/pearls?make=chevrolet&limit=20`);
                    const gmData = await gmRes.json();
                    pearlsToShow = gmData.pearls || [];
                }

                if (pearlsToShow.length > 0) {
                    // Group by category
                    const grouped = {};
                    pearlsToShow.forEach(p => {
                        const cat = p.category || 'General';
                        if (!grouped[cat]) grouped[cat] = [];
                        grouped[cat].push(p);
                    });

                    let html = '';
                    for (const [category, pearls] of Object.entries(grouped)) {
                        const icon = getCategoryIcon(category);
                        html += `<div style="margin-bottom: 12px;">`;
                        html += `<div style="font-size: 0.75rem; color: #64748b; text-transform: uppercase; margin-bottom: 6px;">${icon} ${category} (${pearls.length})</div>`;
                        html += `<div style="display: flex; flex-wrap: wrap; gap: 8px;">`;
                        pearls.slice(0, 4).forEach(p => {
                            const riskClass = p.risk === 'critical' ? 'risk-high' :
                                p.risk === 'important' ? 'risk-medium' : 'risk-info';
                            const title = p.content?.split('.')[0] || 'Insight';
                            const escapedContent = (p.content || '').replace(/'/g, "\\'").replace(/"/g, '&quot;');
                            const escapedSource = (p.source_doc || '').replace(/'/g, "\\'");
                            html += `<div class="pearl-chip clickable ${riskClass}" onclick="openInsightModal('${title.substring(0, 50)}', '${escapedContent}', '${escapedSource}')">${title.substring(0, 40)}${title.length > 40 ? '...' : ''}</div>`;
                        });
                        html += `</div></div>`;
                    }
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div class="error">No pearls found.</div>';
                }
            } catch (err) {
                console.error('Pearl load error:', err);
                container.innerHTML = `<div class="error">Error: ${err.message}</div>`;
            }
        }

        function getCategoryIcon(category) {
            const icons = {
                'Alert': 'üö®',
                'AKL Procedure': 'üîë',
                'Add Key Procedure': '‚ûï',
                'Tool Alert': 'üîß',
                'Security': 'üîê',
                'Voltage': '‚ö°',
                'General': 'üí°'
            };
            return icons[category] || 'üíé';
        }

        // Modal functions
        function openInsightModal(title, content, source) {
            const modal = document.getElementById('insight-modal');
            document.getElementById('modal-title-text').textContent = title;
            document.getElementById('modal-body-text').textContent = content;
            document.getElementById('modal-source-text').textContent = source ? `Source: ${source}` : '';
            modal.classList.add('active');
        }

        function closeInsightModal() {
            document.getElementById('insight-modal').classList.remove('active');
        }

        // Close modal on overlay click
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('insight-modal');
            if (e.target === modal) {
                closeInsightModal();
            }
        });

        // Close modal on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeInsightModal();
            }
        });

        // Load data when page loads
        loadImages();
        loadPearls();
    </script>
</body>

</html>