<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Assignment Dashboard 3.0</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #f8f9fa; --font-color: #212529; --primary-color: #007bff;
            --border-color: #dee2e6; --card-bg: #ffffff; --shadow-color: rgba(0, 0, 0, 0.05);
            --high-importance-border: #dc3545;
        }
        body {
            font-family: 'Roboto', sans-serif; background-color: var(--bg-color);
            color: var(--font-color); margin: 0; padding: 2em;
        }
        .dashboard-container { max-width: 1400px; margin: auto; }
        .header { text-align: center; margin-bottom: 2em; }
        .tabs { display: flex; justify-content: center; margin-bottom: 1em; flex-wrap: wrap; gap: 0.5em; }
        .tabs button {
            background-color: var(--card-bg); border: 1px solid var(--border-color);
            padding: 0.75em 1.5em; cursor: pointer; border-radius: 50px;
            font-weight: 500; transition: all 0.2s ease-in-out;
        }
        .tabs button:hover { background-color: #e9ecef; }
        .tabs button.active {
            background-color: var(--primary-color); color: white; border-color: var(--primary-color);
        }
        .view-container {
            background-color: var(--card-bg); border-radius: 8px;
            box-shadow: 0 4px 12px var(--shadow-color); padding: 1.5em;
        }
        
        /* All Views */
        .view { display: none; }
        .view.active { display: block; }

        /* Calendar Styles */
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1em; }
        .calendar-header button {
            background: none; border: 1px solid var(--border-color); border-radius: 50%;
            width: 40px; height: 40px; cursor: pointer; font-size: 1.2em;
        }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
        .calendar-weekday, .calendar-day { text-align: center; padding: 0.5em; }
        .calendar-weekday { font-weight: 700; color: #6c757d; }
        .calendar-day {
            border: 1px solid #f1f1f1; min-height: 120px;
            border-radius: 4px; transition: background-color 0.2s;
        }
        .calendar-day.has-assignments { cursor: pointer; }
        .calendar-day.has-assignments:hover { background-color: #e9ecef; }
        .calendar-day.not-current-month { background-color: #f8f9fa; color: #adb5bd; cursor: default; }
        .calendar-day.not-current-month:hover { background-color: #f8f9fa; }
        .day-number { font-weight: 500; }
        .day-number.today {
            background-color: var(--primary-color); color: white;
            border-radius: 50%; width: 28px; height: 28px; line-height: 28px;
            display: inline-block;
        }
        .assignment-entry {
            font-size: 0.8em; padding: 3px 5px; margin-top: 5px;
            border-radius: 3px; color: white; text-align: left;
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        .assignment-entry.high-importance { border: 2px solid var(--high-importance-border); font-weight: 700; }
        
        /* List & Timeline View Styles */
        .list-item { display: flex; align-items: center; padding: 1em; border-bottom: 1px solid var(--border-color); }
        .list-item:last-child { border-bottom: none; }
        .list-date { flex: 0 0 100px; font-weight: 500; }
        .list-subject { flex: 0 0 150px; font-weight: 500; }
        .list-details { flex-grow: 1; }
        .list-type { padding: 0.25em 0.5em; border-radius: 4px; color: white; font-size: 0.8em; margin-left: 1em; }
        
        .timeline { position: relative; max-width: 900px; margin: 2em auto; }
        .timeline::after {
            content: ''; position: absolute; width: 4px; background-color: var(--border-color);
            top: 0; bottom: 0; left: 50%; margin-left: -2px;
        }
        .timeline-item { padding: 10px 40px; position: relative; width: 50%; box-sizing: border-box; }
        .timeline-item::after {
            content: ''; position: absolute; width: 20px; height: 20px;
            right: -14px; background-color: white; border: 4px solid;
            top: 15px; border-radius: 50%; z-index: 1;
            border-color: var(--item-color, var(--border-color));
        }
        .timeline-item.left { left: 0; }
        .timeline-item.right { left: 50%; }
        .timeline-item.right::after { left: -12px; }
        .timeline-content { padding: 20px; background-color: white; border-radius: 6px; box-shadow: 0 2px 5px var(--shadow-color); }
        .timeline-content.high-importance { border: 2px solid var(--high-importance-border); }

        /* Breakdown View Styles */
        .breakdown-container { display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 2em; }
        .pie-chart {
            width: 200px; height: 200px; border-radius: 50%;
            background-image: conic-gradient(var(--gradient-str));
        }
        .legend { list-style: none; padding-left: 0; }
        .legend li { display: flex; align-items: center; margin-bottom: 0.5em; }
        .legend-color { width: 20px; height: 20px; border-radius: 4px; margin-right: 10px; }

        /* Modal Styles */
        .modal {
            display: none; position: fixed; z-index: 1000; left: 0; top: 0;
            width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5);
            align-items: center; justify-content: center;
        }
        .modal-content {
            background-color: #fefefe; padding: 20px;
            border: 1px solid #888; width: 90%; max-width: 600px; border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; margin-bottom: 1em;}
        .close-btn { color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer; }
        .modal-list-item { border-left: 5px solid; padding: 10px; margin-bottom: 10px; border-radius: 4px; background-color: #f8f9fa; }
    </style>
    <link rel="icon" href="data:,">
</head>
<body>

<div class="dashboard-container">
    <div class="header">
        <h2>Gunnaiza's Assignment Dashboard</h2>
        <p><a href="index.html">‚Üê Back to Study Dashboard</a></p>
    </div>

    <div class="tabs" id="subject-tabs">
        <button class="active" onclick="setSubject('All', this)">All Subjects</button>
        <!-- Subject buttons will be populated by JavaScript -->
    </div>

    <div class="tabs" id="view-tabs">
        <button class="active" onclick="setView('calendar', this)">üìÖ Calendar</button>
        <button onclick="setView('timeline', this)">‚è≥ Timeline</button>
        <button onclick="setView('list', this)">üìã List</button>
        <button onclick="setView('breakdown', this)">üìä Breakdown</button>
    </div>

    <div class="view-container">
        <div id="calendarView" class="view active">
            <div class="calendar-header">
                <button id="prevMonthBtn">&lt;</button>
                <h3 id="currentMonthYear"></h3>
                <button id="nextMonthBtn">&gt;</button>
            </div>
            <div class="calendar-grid" id="weekday-header"></div>
            <div class="calendar-grid" id="calendar-body"></div>
        </div>
        <div id="listView" class="view">
            <h3 id="listTitle"></h3>
            <div id="list-container"></div>
        </div>
        <div id="timelineView" class="view">
            <h3 id="timelineTitle"></h3>
            <div class="timeline" id="timeline-container"></div>
        </div>
        <div id="breakdownView" class="view">
            <h3 id="breakdownTitle"></h3>
            <div id="breakdown-container" class="breakdown-container"></div>
        </div>
    </div>
</div>

<!-- Modal Structure -->
<div id="assignmentModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modalTitle"></h3>
            <span class="close-btn">&times;</span>
        </div>
        <div id="modalBody"></div>
    </div>
</div>

<script>
    const subjectDetails = {
        'Spanish 2A': { color: '#007bff', weights: { Test: 40, Quiz: 20, Portfolio: 20, Discussion: 10, Participation: 5, 'Quick Check': 5 } },
        'World History A': { color: '#6f42c1', weights: { Test: 45, Portfolio: 15, 'Quick Check': 15, Discussion: 10, Participation: 5, 'Sample Work': 10 } },
        'Algebra 1A': { color: '#fd7e14', weights: { Test: 50, 'Sample Work': 25, 'Quick Check': 15, Discussion: 10 } },
        'Biology A': { color: '#20c997', weights: { Test: 35, Portfolio: 30, 'Sample Work': 20, Discussion: 10, 'Quick Check': 5 } },
        'English 2A': { color: '#6610f2', weights: { Test: 35, Portfolio: 30, 'Quick Check': 10, Discussion: 10, 'Sample Work': 10, Participation: 5 } },
        'Health 1': { color: '#d63384', weights: { Portfolio: 50, Test: 20, Quiz: 15, Discussion: 10, Participation: 5 } },
        'PRINHLSC A': { color: '#17a2b8', weights: { Quiz: 40, Test: 30, 'Sample Work': 20, Portfolio: 5, Participation: 5 } }
    };

    const assignments = [
        // August
        { subject: 'English 2A', date: '2025-08-25', name: 'Live Lesson', type: 'Live Lesson', weight: 0 },
        { subject: 'Spanish 2A', date: '2025-08-26', name: 'Yo soy . . . Quick Check', type: 'Quick Check', weight: 2 },
        { subject: 'Spanish 2A', date: '2025-08-27', name: '¬øQu√© te gusta hacer? Test', type: 'Test', weight: 8 },
        { subject: 'World History A', date: '2025-08-27', name: 'Sources Test', type: 'Test', weight: 8 },
        { subject: 'Biology A', date: '2025-08-27', name: 'Live Lesson', type: 'Live Lesson', weight: 0 },
        { subject: 'Spanish 2A', date: '2025-08-28', name: 'Live Lesson', type: 'Live Lesson', weight: 0 },
        { subject: 'English 2A', date: '2025-08-28', name: 'Live Lesson', type: 'Live Lesson', weight: 0 },
        { subject: 'World History A', date: '2025-08-28', name: 'How to Study History? Test', type: 'Test', weight: 8 },
        { subject: 'Spanish 2A', date: '2025-08-29', name: 'Mi tiempo libre Unit Test', type: 'Test', weight: 8 },
        // September
        { subject: 'Algebra 1A', date: '2025-09-02', name: 'Structures of Expressions Apply', type: 'Sample Work', weight: 5 },
        { subject: 'English 2A', date: '2025-09-02', name: 'Participating in Discussion', type: 'Discussion', weight: 5 },
        { subject: 'Algebra 1A', date: '2025-09-03', name: 'Structures of Expressions Unit Test', type: 'Test', weight: 18 },
        { subject: 'Biology A', date: '2025-09-03', name: 'Live Lesson', type: 'Live Lesson', weight: 0 },
        { subject: 'Biology A', date: '2025-09-04', name: 'Science Processes Unit Test', type: 'Test', weight: 13 },
        { subject: 'Health 1', date: '2025-09-04', name: 'Podcast Portfolio', type: 'Portfolio', weight: 18 },
        { subject: 'Health 1', date: '2025-09-04', name: 'Unit 1 Quiz', type: 'Quiz', weight: 13 },
        { subject: 'PRINHLSC A', date: '2025-09-05', name: 'Unit 1 Lab', type: 'Sample Work', weight: 25 },
        { subject: 'Spanish 2A', date: '2025-09-09', name: '¬øC√≥mo estudias? Unit Test', type: 'Test', weight: 11 },
        { subject: 'World History A', date: '2025-09-09', name: 'Decline of Civilizations Discussion', type: 'Discussion', weight: 5 },
        { subject: 'Algebra 1A', date: '2025-09-10', name: '1-Variable Equations & Inequalities Discussion', type: 'Discussion', weight: 3.3 },
        { subject: 'Algebra 1A', date: '2025-09-10', name: '1-Variable Equations & Inequalities Apply', type: 'Sample Work', weight: 5 },
        { subject: 'PRINHLSC A', date: '2025-09-10', name: 'Unit 1 Quiz', type: 'Quiz', weight: 20 },
        { subject: 'Algebra 1A', date: '2025-09-11', name: '1-Variable Equations & Inequalities Test', type: 'Test', weight: 16 },
        { subject: 'English 2A', date: '2025-09-15', name: 'Studying Informational Text Apply', type: 'Sample Work', weight: 5 },
        { subject: 'World History A', date: '2025-09-16', name: 'Early Civilizations Unit Test', type: 'Test', weight: 25 },
        { subject: 'English 2A', date: '2025-09-16', name: 'Informational Text Unit Test', type: 'Test', weight: 19 },
        { subject: 'Biology A', date: '2025-09-17', name: 'Investigating Enzymes Portfolio', type: 'Portfolio', weight: 50 },
        { subject: 'Spanish 2A', date: '2025-09-19', name: 'Despu√©s de clases Unit Test', type: 'Test', weight: 7 },
        { subject: 'Algebra 1A', date: '2025-09-22', name: '2-Variable Equations & Inequalities Apply', type: 'Sample Work', weight: 5 },
        { subject: 'Biology A', date: '2025-09-22', name: 'Biochemistry Unit Test', type: 'Test', weight: 13 },
        { subject: 'Health 1', date: '2025-09-24', name: 'Podcast Portfolio', type: 'Portfolio', weight: 18 },
        { subject: 'Algebra 1A', date: '2025-09-24', name: 'Relations & Functions Discussion', type: 'Discussion', weight: 3.3 },
        { subject: 'Spanish 2A', date: '2025-09-26', name: 'Prepararse para un evento Portfolio', type: 'Portfolio', weight: 60 },
        { subject: 'Algebra 1A', date: '2025-09-26', name: 'Functions & Their Graphs Apply', type: 'Sample Work', weight: 5 },
        { subject: 'Algebra 1A', date: '2025-09-29', name: 'Functions & Their Graphs Unit Test', type: 'Test', weight: 11 },
        { subject: 'World History A', date: '2025-09-30', name: 'Trade Routes Impact on Islam Discussion', type: 'Discussion', weight: 5 },
        // October
        { subject: 'Algebra 1A', date: '2025-10-02', name: 'Correlation, not Causation Discussion', type: 'Discussion', weight: 3.4 },
        { subject: 'World History A', date: '2025-10-02', name: 'Mediterranean Unit Test', type: 'Test', weight: 25 },
        { subject: 'English 2A', date: '2025-10-03', name: 'Writing Explanatory Text Portfolio', type: 'Portfolio', weight: 33 },
        { subject: 'Algebra 1A', date: '2025-10-03', name: 'Bivariate Data Sets Apply', type: 'Sample Work', weight: 5 },
        { subject: 'Algebra 1A', date: '2025-10-06', name: 'Bivariate Datasets Unit Test', type: 'Test', weight: 22 },
        { subject: 'World History A', date: '2025-10-07', name: 'Fall of the Mongols Portfolio', type: 'Portfolio', weight: 50 },
        { subject: 'Health 1', date: '2025-10-08', name: 'Midterm Exam', type: 'Test', weight: 10 },
        { subject: 'Spanish 2A', date: '2025-10-10', name: 'De compras Unit Test', type: 'Test', weight: 9 },
        { subject: 'Biology A', date: '2025-10-10', name: 'Cells and Body Systems Unit Test', type: 'Test', weight: 13 },
        { subject: 'Algebra 1A', date: '2025-10-13', name: 'Rational & Irrational Numbers Test', type: 'Test', weight: 16 },
        { subject: 'Biology A', date: '2025-10-13', name: 'Homeostasis Portfolio', type: 'Portfolio', weight: 50 },
        { subject: 'PRINHLSC A', date: '2025-10-13', name: 'Unit 4 Activity', type: 'Portfolio', weight: 100 },
        { subject: 'English 2A', date: '2025-10-15', name: 'Studying Literary Text Discussion', type: 'Discussion', weight: 5 },
        { subject: 'World History A', date: '2025-10-16', name: 'Medieval Life Portfolio', type: 'Portfolio', weight: 50 },
        { subject: 'Health 1', date: '2025-10-17', name: 'Podcast Portfolio', type: 'Portfolio', weight: 18 },
        { subject: 'English 2A', date: '2025-10-17', name: 'Studying Literary Text Apply', type: 'Sample Work', weight: 5 },
        { subject: 'Spanish 2A', date: '2025-10-20', name: 'Ayer hice... Unit Test', type: 'Test', weight: 9 },
        { subject: 'English 2A', date: '2025-10-20', name: 'Literary Text Unit Test', type: 'Test', weight: 18 },
        { subject: 'English 2A', date: '2025-10-29', name: 'Language and Style Apply', type: 'Sample Work', weight: 5 },
        { subject: 'Health 1', date: '2025-10-29', name: 'Podcast Portfolio', type: 'Portfolio', weight: 18 },
        { subject: 'PRINHLSC A', date: '2025-10-29', name: 'Midterm', type: 'Test', weight: 100 },
        { subject: 'Spanish 2A', date: '2025-10-30', name: '¬øC√≥mo llegamos? Unit Test', type: 'Test', weight: 10 },
        { subject: 'English 2A', date: '2025-10-31', name: 'Language and Style Unit Test', type: 'Test', weight: 14 },
        // November
        { subject: 'World History A', date: '2025-11-04', name: 'Americas to 1500 Unit Test', type: 'Test', weight: 18 },
        { subject: 'World History A', date: '2025-11-05', name: 'Semester A Exam', type: 'Test', weight: 25 },
        { subject: 'Biology A', date: '2025-11-06', name: 'DNA Unit Test', type: 'Test', weight: 20 },
        { subject: 'Spanish 2A', date: '2025-11-07', name: 'Pronombres de objeto indirecto Portfolio', type: 'Portfolio', weight: 40 },
        { subject: 'Health 1', date: '2025-11-07', name: 'Podcast Portfolio', type: 'Portfolio', weight: 18 },
        { subject: 'English 2A', date: '2025-11-14', name: 'Writing Narrative Portfolio', type: 'Portfolio', weight: 42 },
        { subject: 'Spanish 2A', date: '2025-11-19', name: 'Semester Test', type: 'Test', weight: 17 },
        { subject: 'Biology A', date: '2025-11-21', name: 'Mitosis Unit Test', type: 'Test', weight: 16 },
        { subject: 'Health 1', date: '2025-11-21', name: 'Final Exam', type: 'Test', weight: 10 },
        { subject: 'English 2A', date: '2025-11-21', name: 'Writing Poetry Portfolio', type: 'Portfolio', weight: 25 },
        // December
        { subject: 'Biology A', date: '2025-12-02', name: 'Semester Exam', type: 'Test', weight: 24 },
        { subject: 'English 2A', date: '2025-12-05', name: 'Poetry and Drama Unit Test', type: 'Test', weight: 14 },
        { subject: 'English 2A', date: '2025-12-08', name: 'ELA 10 Semester A Exam', type: 'Test', weight: 28 },
    ];
    
    let currentSubject = 'All';
    let currentView = 'calendar';
    let currentMonth = new Date('2025-08-01').getMonth();
    let currentYear = 2025;
    
    const calendarBody = document.getElementById('calendar-body');
    const monthYearEl = document.getElementById('currentMonthYear');
    const weekdayHeader = document.getElementById('weekday-header');
    const modal = document.getElementById('assignmentModal');
    const closeBtn = document.querySelector('.close-btn');

    function renderCalendar(filteredAssignments) {
        calendarBody.innerHTML = '';
        const firstDay = new Date(currentYear, currentMonth, 1);
        const lastDay = new Date(currentYear, currentMonth + 1, 0);
        monthYearEl.textContent = firstDay.toLocaleString('default', { month: 'long', year: 'numeric' });
        const today = new Date();
        today.setHours(0,0,0,0);

        for (let i = 0; i < firstDay.getDay(); i++) {
            calendarBody.innerHTML += `<div class="calendar-day not-current-month"></div>`;
        }

        for (let day = 1; day <= lastDay.getDate(); day++) {
            const date = new Date(currentYear, currentMonth, day);
            const dayEl = document.createElement('div');
            dayEl.className = 'calendar-day';
            
            const dayNumber = document.createElement('div');
            dayNumber.className = 'day-number';
            dayNumber.textContent = day;
            if (date.getTime() === today.getTime()) dayNumber.classList.add('today');
            dayEl.appendChild(dayNumber);
            
            const dayAssignments = filteredAssignments.filter(a => new Date(a.date + "T00:00:00").getTime() === date.getTime());

            if (dayAssignments.length > 0) {
                dayEl.classList.add('has-assignments');
                dayEl.onclick = () => showModal(date, dayAssignments);
            }

            dayAssignments.forEach(a => {
                const assignmentEl = document.createElement('div');
                assignmentEl.className = 'assignment-entry';
                assignmentEl.textContent = a.subject;
                assignmentEl.style.backgroundColor = subjectDetails[a.subject].color || '#6c757d';
                assignmentEl.title = `${a.name} (${a.weight}%)`;
                if (a.weight >= 20) assignmentEl.classList.add('high-importance');
                dayEl.appendChild(assignmentEl);
            });
            calendarBody.appendChild(dayEl);
        }
    }

    function renderList(filteredAssignments) {
        const listContainer = document.getElementById('list-container');
        listContainer.innerHTML = '';
        document.getElementById('listTitle').textContent = `${currentSubject} Assignments`;
        filteredAssignments.sort((a,b) => new Date(a.date) - new Date(b.date));
        filteredAssignments.forEach(a => {
            const itemEl = document.createElement('div');
            itemEl.className = 'list-item';
            if (a.weight >= 20) itemEl.style.borderLeft = `5px solid var(--high-importance-border)`;
            itemEl.innerHTML = `
                <div class="list-date">${new Date(a.date + "T00:00:00").toLocaleDateString()}</div>
                <div class="list-subject" style="color: ${subjectDetails[a.subject].color}">${a.subject}</div>
                <div class="list-details">${a.name}</div>
                <div class="list-type" style="background-color: ${subjectDetails[a.subject].color}">${a.type} (${a.weight}%)</div>
            `;
            listContainer.appendChild(itemEl);
        });
    }

    function renderTimeline(filteredAssignments) {
        const timelineContainer = document.getElementById('timeline-container');
        timelineContainer.innerHTML = '';
        document.getElementById('timelineTitle').textContent = `${currentSubject} Timeline`;
        filteredAssignments.sort((a,b) => new Date(a.date) - new Date(b.date));
        filteredAssignments.forEach((a, index) => {
            const itemEl = document.createElement('div');
            itemEl.className = `timeline-item ${index % 2 === 0 ? 'left' : 'right'}`;
            itemEl.style.setProperty('--item-color', subjectDetails[a.subject].color);
            itemEl.innerHTML = `
                <div class="timeline-content ${a.weight >= 20 ? 'high-importance' : ''}">
                    <h4>${new Date(a.date + "T00:00:00").toLocaleDateString()}</h4>
                    <p><strong>${a.subject}</strong>: ${a.name} (${a.type} - ${a.weight}%)</p>
                </div>`;
            timelineContainer.appendChild(itemEl);
        });
    }
    
    function renderBreakdown() {
        const container = document.getElementById('breakdown-container');
        container.innerHTML = '';
        document.getElementById('breakdownTitle').textContent = `Grade Weight Breakdown for ${currentSubject}`;
        
        if (currentSubject === 'All') {
            container.innerHTML = '<p>Select a specific subject to see its grade weight breakdown.</p>';
            return;
        }

        const weights = subjectDetails[currentSubject].weights;
        const totalWeight = Object.values(weights).reduce((sum, val) => sum + val, 0);
        
        let gradientStr = '';
        let currentPercentage = 0;
        
        const legend = document.createElement('ul');
        legend.className = 'legend';

        const colors = ['#007bff', '#6f42c1', '#fd7e14', '#20c997', '#6610f2', '#d63384', '#17a2b8'];
        let colorIndex = 0;

        for (const [type, weight] of Object.entries(weights)) {
            const percentage = (weight / totalWeight) * 100;
            const color = colors[colorIndex % colors.length];
            
            gradientStr += `${color} ${currentPercentage}% ${currentPercentage + percentage}%, `;
            currentPercentage += percentage;
            
            const legendItem = document.createElement('li');
            legendItem.innerHTML = `<div class="legend-color" style="background-color: ${color}"></div> ${type}: ${weight}%`;
            legend.appendChild(legendItem);
            colorIndex++;
        }
        
        gradientStr = gradientStr.slice(0, -2);

        const chartEl = document.createElement('div');
        chartEl.className = 'pie-chart';
        chartEl.style.setProperty('--gradient-str', gradientStr);

        container.appendChild(chartEl);
        container.appendChild(legend);
    }
    
    function showModal(date, dayAssignments) {
        const modalTitle = document.getElementById('modalTitle');
        const modalBody = document.getElementById('modalBody');
        modalTitle.textContent = `Assignments for ${date.toLocaleDateString()}`;
        modalBody.innerHTML = '';

        dayAssignments.forEach(a => {
            const itemEl = document.createElement('div');
            itemEl.className = 'modal-list-item';
            itemEl.style.borderLeftColor = subjectDetails[a.subject].color;
            if (a.weight >= 20) {
                itemEl.style.borderLeftWidth = '10px';
                itemEl.style.borderColor = 'var(--high-importance-border)';
            }
            itemEl.innerHTML = `<strong>${a.subject}:</strong> ${a.name} <em>(${a.type} - ${a.weight}%)</em>`;
            modalBody.appendChild(itemEl);
        });

        modal.style.display = 'flex';
    }

    function updateDisplay() {
        let filtered = (currentSubject === 'All') ? assignments : assignments.filter(a => a.subject === currentSubject);
        
        if (currentView === 'calendar') renderCalendar(filtered);
        else if (currentView === 'list') renderList(filtered);
        else if (currentView === 'timeline') renderTimeline(filtered);
        else if (currentView === 'breakdown') renderBreakdown();
    }

    function setSubject(subject, button) {
        currentSubject = subject;
        document.querySelectorAll('#subject-tabs button').forEach(b => b.classList.remove('active'));
        button.classList.add('active');
        updateDisplay();
    }

    function setView(view, button) {
        currentView = view;
        document.querySelectorAll('#view-tabs button').forEach(b => b.classList.remove('active'));
        button.classList.add('active');
        
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(view + 'View').classList.add('active');
        
        updateDisplay();
    }

    closeBtn.onclick = () => modal.style.display = "none";
    window.onclick = (event) => {
        if (event.target == modal) modal.style.display = "none";
    }

    document.getElementById('prevMonthBtn').addEventListener('click', () => {
        currentMonth--;
        if (currentMonth < 0) { currentMonth = 11; currentYear--; }
        updateDisplay();
    });

    document.getElementById('nextMonthBtn').addEventListener('click', () => {
        currentMonth++;
        if (currentMonth > 11) { currentMonth = 0; currentYear++; }
        updateDisplay();
    });
    
    document.addEventListener('DOMContentLoaded', () => {
        const subjectTabsContainer = document.getElementById('subject-tabs');
        Object.keys(subjectDetails).forEach(subject => {
            const btn = document.createElement('button');
            btn.textContent = subject;
            btn.onclick = (e) => setSubject(subject, e.target);
            subjectTabsContainer.appendChild(btn);
        });

        ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].forEach(day => {
            document.getElementById('weekday-header').innerHTML += `<div class="calendar-weekday">${day}</div>`;
        });
        
        updateDisplay();
    });
</script>

</body>
</html>
