BMW PROFESSIONAL LOCKSMITH PROGRAMMING GUIDE
Global Market Coverage: 1995–2025
Comprehensive Technical Reference for Immobilizer Systems, Key Programming, Diagnostics, and Module Repair
⚠ CONFIDENTIAL DOCUMENT - FOR PROFESSIONAL LOCKSMITH & DIAGNOSTIC USE ONLY
Updated: December 2025
TABLE OF CONTENTS
Section 1: The Philosophy of BMW Security Architecture
1.1 The Evolution of Theft Prevention: From EWS to Cloud Authorization
1.2 Understanding the "Triangle of Security": Key, Immobilizer, and DME
1.3 The Role of the Individual Serial Number (ISN) and Rolling Codes
1.4 Critical Safety Protocols: Voltage Stabilization and Flash Protection
Section 2: The EWS Era (1995–2006) – System Deep Dive
2.1 EWS 1 & 2: The Birth of Rolling Codes
2.2 EWS 3 (3.2, 3.3, 3.D): K-Line Communication and MCU Logic
2.3 EWS 4: The Introduction of Secured MCUs (2L86D)
2.4 Mechanical Key Decoding: HU58 Profile Analysis and Lishi Operations
Section 3: The CAS Era (2002–2014) – System Deep Dive
3.1 CAS1 (E65): The Transition to CAN-BUS and Slot Keys
3.2 CAS2 (E60/E90): Refinement of the White Box System
3.3 CAS3 & CAS3+ (E-Series): Encryption, ISTA-P, and Flash Downgrading Risks
3.4 CAS4 & CAS4+ (F-Series): The Move to 5M48H MCUs and Bench Security
3.5 Mechanical Key Decoding: HU92 Profile Analysis and Twin-Lifter Procedures
Section 4: The FEM/BDC Era (2012–2019) – System Deep Dive
4.1 Architectural Shift: Integrating Security into Body Control
4.2 The "Preprocessing" Workflow: Why Service Mode is Mandatory
4.3 EEPROM Management: 95128/95256 Chip Handling and Data Integrity
4.4 Mechanical Key Decoding: HU100R Profile Analysis and Reverse Logic
Section 5: The G-Series Era (2018–Present) – BDC2, BDC3, and Cloud Security
5.1 BDC2 Architecture: Enhanced Encryption and Bench Requirements
5.2 BDC3 & Cloud Analysis: The Shift to Server-Side Calculation
5.3 The "All Keys Lost" Problem: Bosch MD1/MG1 DME Locking
5.4 Digital Keys and Ultra-Wideband (UWB) Technology
Section 6: Transponder Technology and Remote Frequency Management
6.1 Chip Evolution: From PCF7935 to 128-bit AES Hitag Pro
6.2 Frequency Distribution: 315MHz vs. 434MHz vs. 868MHz
6.3 FCC ID Cross-Reference and OEM Part Number Guide
6.4 Rechargeable vs. Replaceable Batteries: VL2020 vs. CR2032/CR2450
Section 7: Comprehensive Tool Methodologies and Walkthroughs
7.1 Autel MaxiIM IM608 Pro II / IM508S: OBD Mastery and Limitations
7.2 Xhorse Ecosystem: VVDI2, Key Tool Plus, and Bench Adapters
7.3 Yanhua Mini ACDP: The Solder-Free Interface Board Revolution
7.4 Specialized EEPROM Tools: AK90+, VVDI Prog, and HexTag
Section 8: Detailed Operational Procedures (Step-by-Step)
8.1 Procedure: EWS3 All Keys Lost using AK90+ (Bench)
8.2 Procedure: CAS3+ ISTA-P Add Key via OBD (Flash Downgrade)
8.3 Procedure: CAS4+ All Keys Lost (Bench Read with XP400/ACDP)
8.4 Procedure: FEM/BDC Key Learning with Preprocessing
8.5 Procedure: G-Series BDC3 Add Key via OBD (Cloud Calculation)
Section 9: Advanced Diagnostics: ISN Reading and Module Synchronization
9.1 The Hierarchy of ISN: Short (4-byte) vs. Long (16/32-byte)
9.2 Bench Reading DMEs: MSD80, MSV90, N20, B48, B58
9.3 Synchronization: Realigning CAS-ELV and CAS-DME Rolling Codes
Section 10: Module Repair, Recovery, and Cloning
10.1 FRM3 Repair: Restoring Corrupted Partition Data (D-Flash/EEE)
10.2 CAS3+ Unbricking: Recovering from Failed Flash Downgrades
10.3 ELV Emulation: Bypassing the Electronic Steering Lock
Section 11: Pricing Strategy, Risk Management, and Decision Matrices
SECTION 1: THE PHILOSOPHY OF BMW SECURITY ARCHITECTURE
1.1 The Evolution of Theft Prevention
To professionally service BMW vehicles, a locksmith must first understand the engineering philosophy that drives the brand's security architecture. Unlike manufacturers that rely on static PIN codes (like Hyundai/Kia) or timed access delays (like Ford), BMW's security strategy is built upon a complex, synchronized "handshake" between multiple control modules. This architecture has evolved through four distinct epochs: the EWS (Electronic Drive Away Protection), the CAS (Car Access System), the FEM/BDC (Front Electronic Module / Body Domain Controller), and the modern G-Series/Cloud era.
In the mid-1990s, the introduction of EWS marked a departure from simple mechanical locks to electronic verification. By separating the transponder reading from the engine management authorization, BMW created a system where physically turning the ignition lock was insufficient to start the vehicle. This philosophy—that "authorization" is separate from "actuation"—has remained the core tenet of BMW security, culminating in modern systems where the key does not mechanically interact with the car at all, but rather authorizes the Body Domain Controller to wake up the vehicle's bus systems.1
1.2 Understanding the "Triangle of Security"
Every BMW immobilizer system functions on a triangular relationship between three critical components. A failure or mismatch in any leg of this triangle results in a "crank, no-start" or "no-crank" condition.
The Key (Transponder): Contains a fixed ID and a variable cryptographic code (rolling code or ISN-derived password). The key must prove its authenticity to the Immobilizer Module.
The Immobilizer Module (EWS/CAS/FEM/BDC): This is the gatekeeper. It energizes the key coil, reads the transponder data, checks it against its internal "allow list" (Key Slots 1-10), and if valid, releases the terminal voltage (Terminal 15/50) to the starter. Crucially, it then sends a specialized authorization code (ISN) to the engine computer.
The Engine Control Unit (DME/DDE): The Digital Motor Electronics (Gas) or Digital Diesel Electronics receives the ISN from the immobilizer. It compares this ISN against its own internal memory. If—and only if—the ISN matches, the DME enables the fuel injectors and spark plugs.2
This interaction explains why a "used" ECU from a junkyard will not start a BMW. The used ECU contains the ISN from the donor car, which does not match the ISN stored in the recipient car's CAS module. Professional locksmithing on BMWs is largely the art of reading, managing, and synchronizing these ISN codes.
1.3 The Role of the Individual Serial Number (ISN) and Rolling Codes
The ISN is the cryptographic "password" that links the Immobilizer to the DME.
Early Systems (EWS): Used a 4-digit rolling code. The EWS and DME would agree on a starting code, and every time the car started, this code would "roll" forward mathematically. If the battery died during cranking, the codes could roll out of sync, requiring a diagnostic "Realignment".3
Middle Systems (CAS3): Introduced a static 4-byte (Short) or 16-byte (Long) ISN. This was more stable but required precise extraction to program keys in "All Keys Lost" scenarios.
Modern Systems (CAS4/FEM/G-Series): Use a 32-byte (128-bit) ISN. This is cryptographically secure and cannot be brute-forced. It must be extracted by reading the physical memory of the DME or the Immobilizer.4
1.4 Critical Safety Protocols: Voltage Stabilization
Before touching a BMW with any programming tool, the most critical step is Voltage Stabilization. BMW modules, particularly the CAS3+ and FEM, are notoriously sensitive to voltage fluctuation.
The Risk: During key programming, the diagnostic tool often erases the module's firmware (Flash) to rewrite it with unlocked data ("Flash Downgrading"). This process can take 10-20 minutes. If the vehicle's voltage drops below 12.5V during this write cycle, the bootloader can corrupt, leaving the module "bricked"—unresponsive and dead.6
The Solution: Never use a standard battery charger or jumper cables. You must use a dedicated Power Supply Unit (PSU) capable of maintaining a clean, ripple-free 13.6V to 14.2V at up to 50-70 Amps. This ensures the modules remain fully powered and stable throughout the programming session.7
SECTION 2: THE EWS ERA (1995–2006) – SYSTEM DEEP DIVE
The EWS system is the foundation of BMW locksmithing. While older, these vehicles (E46 3-Series, E39 5-Series, E53 X5) are still common on the road and offer high-profit margins because many generic locksmiths cannot handle the bench work required.
2.1 EWS 1 & 2: The Birth of Rolling Codes
EWS 1 (1994-1995): This was a primitive system that functioned essentially as a starter kill relay. It monitored the door locks and the general module. The keys often used simple multi-track milling but lacked sophisticated transponder logic.
EWS 2 (1995-1997): This system introduced the dedicated EWS module (white box with a yellow connector) and the key transponder (PCF7930/7931). The key sends a fixed code and a rolling code to the EWS. The EWS validates the key and then sends a signal to the DME to enable fuel/spark. This generation is robust but prone to rolling code desynchronization if the battery is low.9
2.2 EWS 3 (3.2, 3.3, 3.D): K-Line Communication
Found in the ubiquitous E46 3-Series and E53 X5, EWS 3 is the most common variant encountered today.
Module Identification: A white or black box, usually located under the driver's side dashboard (above the pedals) or behind the glovebox (in the X3). It uses a Motorola MC68HC11EA9 or similar MCU.10
Operation: The EWS 3 module stores the odometer reading and the Vehicle Identification Number (VIN) in addition to key data. It communicates via the K-Line diagnostic protocol.
Programming Limitation: While some tools claim OBD support for EWS3, it is notoriously unreliable. The "K-Line" speed is slow and unstable for writing key data. The professional standard is Bench Programming using an AK90+ or VVDI Prog.
2.3 EWS 4: The Introduction of Secured MCUs
Towards the end of the E46/X3 production run (2004-2006), BMW introduced EWS 4.
The Challenge: Externally, the module looks identical to EWS 3. Internally, it uses a secured Motorola MCU with the mask 2L86D.
The Solution: This MCU has "Secured" memory sectors that cannot be read by a simple clip. To read an EWS 4 module, the locksmith must solder four wires to specific test points on the back of the circuit board (BKG, VCC, GND, RESET) to bypass the security lock. Using a standard EWS3 clip on an EWS4 module will result in a "Pin Touch" error or a bad read.11
2.4 Mechanical Key Decoding: HU58 Profile
Before the widespread adoption of the laser-cut key, BMW used the HU58 profile.
Structure: A 4-track external key. It has two tracks on the top edge and two on the bottom edge.
Lishi Tool: HU58 (2-in-1). This is widely considered one of the most difficult automotive locks to pick due to the spring tension and the sheer number of wafers (12 positions).
Decoding: The locksmith must decode both the A-axis and B-axis. Accurate decoding is critical because the 4-track system has very tight tolerances. Cutting this key requires a standard side-mill duplicator or a CNC machine capable of "shoulder gauging" the blank.13
SECTION 3: THE CAS ERA (2002–2014) – SYSTEM DEEP DIVE
The Car Access System (CAS) represents the "Golden Age" of BMW locksmithing. It integrated the remote control receiver, immobilizer, and ignition switch logic into a single unit. Understanding the specific generation of CAS is the difference between a 10-minute OBD job and a bricked module.
3.1 CAS1 (E65): The Transition to CAN-BUS
Vehicle: E65 7-Series (2002-2008).
Key Type: The first "Slot Key" or "Smart Key" (Rectangular fob).
Architecture: CAS1 moved the security data from the K-Line to the faster CAN-BUS network. However, the remote control functions in early E65s were sometimes handled by a separate antenna module, meaning programming the transponder did not always automatically program the remote.
Programming: CAS1 can be done via OBD, but it is often safer to read the module on the bench due to the age and volatility of the E65's electrical system.14
3.2 CAS2 (E60/E90 Early)
Vehicles: Early E60 5-Series and E90 3-Series (up to ~2006).
Key Type: "Semi-Smart" Slot Key (often white casing on the module).
Advancement: CAS2 fully integrated the remote functions. Once the transponder is programmed and the key is inserted into the slot, the remote usually syncs automatically or requires a manual button-press sequence (Hold Unlock, press Lock 3 times).15
Tooling: Fully supported via OBD by Autel IM608, VVDI2, and others. Bench reading is rarely required unless All Keys Lost (AKL) fails via OBD.16
3.3 CAS3 & CAS3+ (The Industry Standard)
This is the most common system.
CAS3 (2006-2008): Unencrypted. Keys can be added via OBD quickly.
CAS3+ (2008-2012): Encrypted. The MCU firmware (Mask 0L15Y/0M23S) is locked.
The "Flash Downgrade": To add a key to a CAS3+ via OBD, the tool must first bypass the encryption. It does this by erasing the current "secure" firmware and writing an older, vulnerable version ("Flash Downgrade").
Risk: This process takes 8-15 minutes. If voltage drops or the cable disconnects, the CAS flash becomes corrupted. The car will be dead—no dash lights, no ignition.
Mitigation: Always use a PSU (13.6V). If the module bricks, tools like Xhorse Key Tool Plus or Autel IM608 have a "Repair CAS" function that attempts to rewrite the flash. If that fails, bench recovery (writing a good EEPROM/Flash dump) is the only fix.6
3.4 CAS4 & CAS4+ (F-Series)
With the F-Series (F10, F01), BMW introduced CAS4.
Module Location: Usually located under the dash, above the driver's footwell.
CAS4 (White Case): Uses the Motorola 9S12XDP512 MCU. Often unencrypted.
CAS4+ (Black Case): Uses the 9S12XEP100 MCU (Mask 5M48H or 1N35H). Encrypted.
Programming Strategy: While some tools claim OBD support, it is extremely risky. The professional standard is Bench Reading.
Method: Remove the CAS4 module. Use a solder-free adapter (like ACDP Module 1 or Godiaq Test Platform) to read the D-Flash (Data) and P-Flash (Program).
Process: The tool decrypts the data, extracts the ISN, and generates a new key file. This file is then written to a new blank key. The modified D-Flash does not usually need to be written back to the car for "Add Key," but is required for "All Keys Lost" to disable old keys.18
3.5 Mechanical Key Decoding: HU92
Profile: 2-Track Internal. Used on almost all E-Series vehicles.
Lishi Tool: HU92 (Twin Lifter) is strongly recommended over the Single Lifter. The Twin Lifter allows for more independent control of the wafers.
Decoding Rule:
Twin Lifter: Decode in the SAME direction you picked.
Single Lifter: Decode in the OPPOSITE direction you picked.
This confusion is the #1 cause of miscut HU92 keys. Always verify which tool version you are using.20
SECTION 4: THE FEM/BDC ERA (2012–2019) – SYSTEM DEEP DIVE
The F30 3-Series marked the end of the CAS module. Security was integrated into the Front Electronic Module (FEM), while X-Series vehicles used the Body Domain Controller (BDC). These modules are structurally identical regarding key programming.
4.1 Architectural Shift
Unlike CAS, where the key data lived in a separate EEPROM, FEM/BDC key data is tightly integrated with the module's gateway and lighting functions. The security data is encrypted and distributed between the MCU and a 95128/95256 EEPROM chip.
4.2 The "Preprocessing" Workflow
Programming a key to a FEM/BDC vehicle is not a simple "Add Key" click. The module must be "Preprocessed" (put into Service Mode) to accept new data. This is a multi-step surgery:
Backup Coding: Read the module's coding data via OBD. This controls window auto-up, headlights, etc. If you lose this, the car starts but the windows won't work.
EEPROM Manipulation:
Remove the FEM from the car.
Locate the 95128/95256 8-pin EEPROM chip on the PCB.
Read the EEPROM data (Bench).
The tool generates a modified "Service File." Write this file back to the EEPROM.
Flash Update: Reinstall the FEM to the car (or test platform). The tool will now "Flash" the MCU. The Service EEPROM file allows the tool to bypass the security lock during this flash.
Restore: Once the MCU is unlocked, write the Original EEPROM file back to the chip.
Key Learning: Now, and only now, can the tool learn a new key via the induction coil on the steering column.22
4.3 EEPROM Management
Solder vs. Clip: Most failures occur here. The 95128 chip is coated in conformal coating (varnish). If you do not clean this off perfectly, a clip adapter will get a bad read.
Recommendation: Many professionals prefer Yanhua ACDP Module 2, which uses a specialized pressure socket that clamps onto the chip without soldering, avoiding the risk of overheating the adjacent components or lifting traces.24
4.4 Mechanical Key Decoding: HU100R
Profile: F-Series and G-Series use the HU100R.
Difference from GM: It is the "Reverse" of the GM HU100. The cuts are on the opposite side of the track spine.
Picking: These locks utilize variable wafers and can feel "mushy." Heavy tension often binds the lock; extremely light tension is required to feel the wafer states.
Decoding: Direct read depths 1-4. The key code series is often available on the door lock cylinder itself if removed, but picking is faster.25
SECTION 5: THE G-SERIES ERA (2018–PRESENT)
The G-Series introduced the BDC2 and BDC3 modules, representing the hardest challenge currently facing locksmiths.
5.1 BDC2 Architecture
Found in early G-chassis (G30 5-Series, G11 7-Series).
Structure: Similar to FEM/BDC but with updated encryption.
Bench Support: Tools like ACDP Module 38 and Xhorse Key Tool Plus can perform "Add Key" on the bench without opening the module, using interface boards.
Limitation: For All Keys Lost, you typically need the ISN from the Engine (DME).
5.2 BDC3 & Cloud Analysis (2019+)
Found in G20 (3-Series), G05 (X5), and newer models.
The Hurdle: BDC3 firmware is locked down. Traditional preprocessing often fails or is blocked.
The Solution: Autel and other manufacturers have introduced "Cloud Calculation" solutions. By connecting the tool to the internet, the software uploads the encrypted data to a server which calculates the "Key Password."
Cost: This is often a paid service. Autel charges an annual subscription or per-VIN fee (approx. $120) for G-Series Add Key calculation capabilities.27
5.3 The "All Keys Lost" Problem: Bosch MD1/MG1
For AKL on a G-Series, you need the ISN from the DME.
The Problem: Newer Bosch MD1 and MG1 ECUs (produced after June 2020) have a "Bench Lock" that prevents reading the ISN via standard bench tools.
The Workaround: Currently, there is no easy OBD solution for AKL on 2021+ G-Series. The DME often must be sent to a specialist tuner (like FEMTO in Finland) for unlocking, or the dealer must order a key.29
SECTION 6: TRANSPONDER TECHNOLOGY AND REMOTE FREQUENCY
6.1 Chip Evolution
PCF7935 (ID44): EWS era. Robust, rewriteable.
PCF7945 (ID46): CAS1-3 era. The "Hi-Tag 2" chip. Extremely common.
PCF7953 (ID49): CAS4/FEM/BDC era. "Hi-Tag Pro" (Hitag 3). Uses 128-bit AES encryption.
NCF2951: G-Series. Advanced version of ID49.
6.2 Frequency Distribution
315 MHz: Standard for USA, Canada, Japan (mostly).
434 MHz (433.92): Standard for Europe, UK, Australia, Asia, Middle East.
868 MHz: Used in specific Continental European markets (e.g., Germany) for CAS3 systems to reduce interference.
Check: Never guess. Use a frequency tester (Key Tool Max) on the original key. If no key exists, check the VIN decoder or the markings on the antenna amplifier (usually in the C-pillar).30
6.3 FCC ID Cross-Reference and OEM Part Numbers
Chassis
System
Key Style
Frequency
FCC ID
Chip
E90/E60
CAS3
Smart (CA)
315 MHz
KR55WK49127
ID46
E90/E60
CAS3
Slot (Non-CA)
315 MHz
KR55WK49123
ID46
F10/F01
CAS4
Smart 4-Btn
315 MHz
YGOHUF5662
ID49
F10/F01
CAS4
Smart 4-Btn
434 MHz
YGOHUF5767
ID49
F15/F30
FEM
Smart 4-Btn
315 MHz
YGOHUF5662
ID49
F15/F30
FEM
Smart 4-Btn
434 MHz
NBGIDGNG1
ID49
G20/G05
BDC3
Blade Smart
434 MHz
N5F-ID21A
NCF2951
Note: CAS4 and FEM keys often look identical. An unlocked CAS4 key cannot be programmed to a FEM car. Always check the board ID or buy "Universal" keys (like Autel IKEY or Xhorse XM38) that can be generated for either.32
SECTION 7: COMPREHENSIVE TOOL METHODOLOGIES
7.1 Autel MaxiIM IM608 Pro II / IM508S
Strengths: Best guided interface ("Expert Mode" vs "Smart Mode"). Excellent diagrams for connection points.
Weaknesses: High risk of bricking CAS3+ if voltage is unstable. G-Series functions are expensive add-ons.
Essential Accessories:
XP400 Pro: Mandatory for reading keys and infrared Mercedes keys.
G-BOX3: Required for fast password calculation on CAS4 and bench DME reading (reduces time from 30 mins to <5 mins).34
APB112: Smart key simulator, useful for AKL data collection.
7.2 Xhorse Ecosystem
VVDI2: The legendary tool for BMW. Extremely stable on CAS1-3 via OBD. Good file maker functions.
Key Tool Plus: The tablet version. Integrates VVDI2, VVDI Prog, and MB tool. Excellent for bench reading due to integrated pin detection.
Tokens: Xhorse uses a token system for some online calculations (mostly Mercedes, but occasionally complex BMW functions).
7.3 Yanhua Mini ACDP
The "Solder-Free" King: ACDP's selling point is its "Module" system using interface boards.
Module 1 (CAS): Clamps over the MCU. No soldering wires.
Module 2 (FEM): Clamps over the 95128/95256 chip.
Module 3 (ISN): Plugs directly into the DME connector pins.
Verdict: This is the safest tool for FEM/BDC and CAS4. It removes human error (bad soldering) from the equation.24
7.4 AK90+ (EWS Specialist)
Role: Do not underestimate this $40 tool. It is often more reliable for reading EWS3 MCUs than tools costing $3,000. It is a pure bench tool. Remove EWS -> Clean Pins -> Read -> Write Key -> Reinstall. It just works.11
SECTION 8: DETAILED OPERATIONAL PROCEDURES
8.1 Procedure: EWS3 All Keys Lost using AK90+
Extract Module: Remove the EWS3 box from under the dash.
Clean Pins: Open the case. Identify the Motorola MCU (0D46J/2D47J). Use a fiberglass pen or acetone to meticulously clean the varnish off the pins. Failure to do this causes read errors.
Connect: Attach the AK90 ribbon cable connector to the MCU. Align the red dot on the connector with the dimple (Pin 1) on the MCU.
Read: Launch software. Select MCU type. Click "Read EWS". The tool will beep if the connection is good. Save the .bin file.
Write: Place a new PCF7935 chip in the AK90 slot. Select an unused key slot (e.g., Key 5) in the software. Click "Write Key".
Verify: The chip is now programmed with the rolling code for Slot 5. Reinstall EWS. The car will start. No diagnostic sync is needed for EWS3 unless the DME-EWS rolling code was previously corrupted.
8.2 Procedure: CAS3+ ISTA-P Add Key via OBD (Autel)
Connect PSU: Set to 13.8V.
Identify: IMMO -> BMW -> Smart Selection. Tool identifies CAS3+ (ISTAP).
Process: Select "Key Learning". The tool warns "Flash Downgrade Required". Proceed.
Flash: The tool will erase and rewrite the CAS firmware. This takes ~10 minutes. Do not open doors or touch switches.
Learn: Once flashed, the tool asks you to insert the working key (to read auth) and then the new blank key.
Restore: The tool typically does not restore the original flash automatically; it leaves the CAS in the "downgraded" state which is functional.
8.3 Procedure: CAS4+ All Keys Lost (Bench Read - ACDP)
Removal: Remove CAS4 module.
Connection: Install the ACDP CAS4 interface board over the PCB. Tighten the studs to ensure pogo pins make contact.
Read: Select "CAS4+ (5M48H)". Read P-Flash and D-Flash. The tool automatically decrypts the data.
ISN: The tool displays the ISN and VIN. It creates a key file.
Program: Place a new key in the ACDP coil. Select "Generate Dealer Key". Select the key file generated in step 4.
Install: Reinstall CAS4. Hold the new key to the steering column coil. Press Start. The key will sync.
8.4 Procedure: FEM/BDC Key Learning (Preprocessing)
Backup: Connect OBD. Read "Coding Data".
Bench Work: Remove FEM. Open shell.
Adapter: Attach ACDP Module 2 clip to the 95128 EEPROM.
Read & Modify: Read EEPROM. Tool saves "Original_EEPROM.bin". Tool generates "Service_EEPROM.bin". Write Service file to chip.
Flash: Reconnect FEM to platform/car. Perform "Program ECU".
Restore: Attach clip again. Write "Original_EEPROM.bin" back to chip.
Add Key: Now connect via OBD (or bench). The FEM is unlocked. You can now use "Learn Key".
Coding: Restore the "Coding Data" saved in Step 1 to fix windows/lights.23
SECTION 9: ADVANCED DIAGNOSTICS: ISN READING & MODULE SYNCHRONIZATION
9.1 The Hierarchy of ISN
The ISN is the cryptographic glue holding the car together.
E-Series (Short ISN): 4 bytes (e.g., 12 34). Found in older DMEs (MS43, MS45).
E-Series (Long ISN): 16 bytes. Found in MSD80/81 (N54).
F-Series (ISN): 32 bytes (128-bit). Found in N20/N55/B48/B58.
9.2 Bench Reading DMEs
If you have All Keys Lost on a CAS3+ or FEM car, you cannot read the ISN from the immobilizer because you cannot turn on the ignition to wake it up. You must read the ISN from the DME.
MSD80/81 (N54): Use Autohex II or VVDI Prog with a Tricore cable. Connect to pins on the DME connector. Read ISN.
MSV90 (Continental): Requires unlocking. ACDP Module 27 is excellent for this.
N20 / B48 / B58: These require opening the shell (boot mode) OR using specialized interface boards (ACDP Module 3) that plug into the DME pins without opening the shell.5
9.3 Synchronization
If a car cranks but doesn't start, the rolling code between CAS and DME may be mismatched (Tampering error).
Tools: Autel, Launch, ISTA.
Function: Service -> Drive -> DME -> "DME-CAS Adjustment" or "EWS Alignment". This resets the rolling code list.3
SECTION 10: MODULE REPAIR, RECOVERY, AND CLONING
10.1 FRM3 Repair
The FRM3 (E-Series) corrupts its own P-Flash partition when voltage fluctuates (e.g., battery change).
Symptoms: Windows dead, indicators dead, headlights stuck on.
Repair: Connect VVDI Prog / ACDP to the MC9S12 chip. Read D-Flash (it will look empty/corrupt). Use the tool's "Partition Repair" or "Write Partition" function. This reallocates the memory sectors. The EEPROM data usually reappears magically because it was just the partition table that was lost. No coding required after fix.37
10.2 CAS3+ Unbricking
If an OBD flash fails, the CAS bootloader is corrupted.
Repair: You must read the CAS EEPROM/Flash on the bench. Use a hex editor or a tool like HexTag to repair the bootloader section of the bin file. Write the fixed file back. This resurrects the module.6
10.3 ELV Emulation
On E90/E60, the physical steering lock (ELV) often jams, preventing the CAS from authorizing a start (Error A0AA).
Fix: Buy a $20 "ELV Emulator" plug. Disconnect the ELV connector on the steering column. Plug in the emulator. The CAS now thinks the lock is open and healthy. Reset the ELV counter in the CAS using a scanner. Car starts.38
SECTION 11: PRICING STRATEGY & DECISION MATRICES
Locksmith Tool Decision Matrix
Scenario
Best Tool
Backup Tool
Note
EWS 3/4 AKL
AK90+
VVDI Prog
AK90 is cheaper ($40) & faster.
CAS 3+ Add Key
Autel IM608
VVDI2
Autel has superior guided mode.
CAS 4/4+ AKL
Yanhua ACDP
Key Tool Plus
ACDP = No soldering risk.
FEM/BDC AKL
Yanhua ACDP
Autel IM608
ACDP requires less disassembly.
G-Series Add
Autel (Sub req.)
Dealer Key
High cost for tool sub (~$120).
FRM Repair
VVDI Prog
ACDP Module 8
Easy profit job ($150+).
Pricing Guidelines (US Market Estimates)
Spare Key (E-Series/F-Series): $250 - $350.
All Keys Lost (CAS3): $450 - $600.
All Keys Lost (FEM/BDC): $600 - $900 (Labor intensive).
FRM Repair: $200 - $300 (30 mins work).
G-Series AKL: $800+ (Often requires DME unlocking or dealer key).
DISCLAIMER: This guide is for educational and professional use. Procedures such as ISN reading and EEPROM modification carry inherent risks of damaging vehicle control modules. Always maintain a stable power supply (13.6V+) during programming. The author and publisher assume no liability for bricked modules or voided warranties.
— END OF DOCUMENT —
Works cited
Understanding EWS in BMW - DUDMD Tuning, accessed December 11, 2025, https://www.dudmd.com/blogs/news/understanding-ews-in-bmw
DME Synchronization : Specialized ECU Repair - Self-Help Knowledge Base, accessed December 11, 2025, https://ecudoctors.freshdesk.com/support/solutions/articles/47001097260-dme-synchronization
DDE-CAS sync Problem - Bimmerforums - The Ultimate BMW Forum, accessed December 11, 2025, https://www.bimmerforums.com/forum/showthread.php?2131297-DDE-CAS-sync-Problem
Reading ISN From DME/DDE in Factory Mode - Microtronik, accessed December 11, 2025, https://www.microtronik.com/technical-info/autohex/Reading-ISN-From-DME-DDE-On-Bench-Factory-Mode
Reading BMW ISN From CAS,DME, and DDE - Microtronik, accessed December 11, 2025, https://www.microtronik.com/technical-info/autohex/bmw-isn-reader-and-writer-software
How to Repair Bricked BMW CAS3+ istap Module by Autel KM100? | by obdii365 - Medium, accessed December 11, 2025, https://medium.com/@obd365com/how-to-repair-bricked-bmw-cas3-istap-module-by-autel-km100-2a9a94646994
Autel IM608 Pro Program 2010 BMW 550GT CAS4 All Keys Lost - AutelShop.de Official Blog, accessed December 11, 2025, http://blog.autelshop.de/autel-im608-pro-program-2010-bmw-550gt-cas4-all-keys-lost/
Autel IM608 II/IM508S BMW BDC02 Add Key Failed Precautions - AutelShop.de Official Blog, accessed December 11, 2025, https://blog.autelshop.de/autel-im608-ii-im508s-bmw-bdc02-add-key-failed-precautions/
EWS operation? - Bimmerforums - The Ultimate BMW Forum, accessed December 11, 2025, https://www.bimmerforums.com/forum/showthread.php?1422489-EWS-operation
BMW Key Programmer Manual for EWS | PDF | Car | Computer Engineering - Scribd, accessed December 11, 2025, https://fr.scribd.com/document/51651816/CARPROG-BMW-Key-programmer-manual
BMW Ak90 Key Programmer User Manual PDF - Scribd, accessed December 11, 2025, https://www.scribd.com/document/427784642/bmw-ak90-key-programmer-user-manual-pdf
Xhorse EWS4 Adapter For VVDI Prog Programmer For BMW - ABKEYS, accessed December 11, 2025, https://abkeys.com/products/xhorse-ews4-adapter-for-bmw-ews4-range-rover-ews4-adapter-land-rover-4203
3 buttons 315 MHz / 433 MHz / 868 MHz Remote Key with ID46 Chip for BMW CAS2 5 Series E46 E60 E83 E53 E36 E38 HU58 Uncut - DHgate, accessed December 11, 2025, https://www.dhgate.com/goods/996669211.html
BMW Immo System | PDF | Car Body Styles - Scribd, accessed December 11, 2025, https://www.scribd.com/document/949376063/BMW-Immo-System
How to Program a BMW Key | BMW of Ontario, accessed December 11, 2025, https://www.bmwofontario.com/service/diy-car-care/how-to-program-a-bmw-key/
For BMW CAS2 CAS3 CAS4 CAS4+ Test Platform Tool Support Off-Site Key Programming For BMW F20 F30 F35 X5 X6 I3 - AliExpress, accessed December 11, 2025, https://www.aliexpress.com/item/1005005468970407.html
CAS 3++ Downgrade - Bimmerforums - The Ultimate BMW Forum, accessed December 11, 2025, https://www.bimmerforums.com/forum/showthread.php?2451645-CAS-3-Downgrade
CAS4 and CAS4+ Key Programming - autohex - Microtronik, accessed December 11, 2025, https://www.microtronik.com/technical-info/autohex/cas4-key-programming
BMW F10 CAS4/CAS4+ How to Add key with Autel MaxiIM IM608 - obdprice, accessed December 11, 2025, https://www.obdprice.com/blogs/car-repar-maintenance/bmw-f10-cas4-cas4-how-to-add-key-with-autel-maxiim-im608
BMW HU92 Ignition Vol.3 Picking and Decoding Guide - TradeLocks Blog, accessed December 11, 2025, https://blog.tradelocks.co.uk/bmw-hu92-ignition-genuine-lishi-vol-3/
BMW HU92 Ignition Picking and Decoding Guide - TradeLocks Blog, accessed December 11, 2025, https://blog.tradelocks.co.uk/bmw-hu92-ignition-genuine-lishi-vol-1/
How to Program BMW 1-Series FEM All Keys Lost on Bench With the Autel IM608 - ABKEYS, accessed December 11, 2025, https://abkeys.com/blogs/news/how-to-program-bmw-1-series-fem-all-keys-lost-on-bench-with-the-autel-im608
How to program BMW FEM/BDC key By Lonsdor K518ISE, accessed December 11, 2025, https://www.lonsdork518.com/service/how-to-program-bmw-fem-bdc-key-by-lonsdor-k518ise-7.html
YANHUA Mini ACDP for BMW FEM/BDC: The Real-World Guide to Key Programming on a Budget - AliExpress, accessed December 11, 2025, https://www.aliexpress.com/p/wiki/article.html?keywords=mini-acdp
Pick And Decode A GM Lock - HU100 Lishi Pick - YouTube, accessed December 11, 2025, https://www.youtube.com/watch?v=RcpZa2WUDMc
Picking and Decoding the BMW HU100R door lock using Lishi tools - TradeLocks Blog, accessed December 11, 2025, https://blog.tradelocks.co.uk/bmw-hu100r-door-lock-genuine-lishi-vol-2/
Autel just enabled add key on G body BMWs but there's a huge catch. : r/Locksmith - Reddit, accessed December 11, 2025, https://www.reddit.com/r/Locksmith/comments/1iuzz1g/autel_just_enabled_add_key_on_g_body_bmws_but/
Autel MaxiIM BMW G-Chassis Software Card Compatible with IM508 and IM608 Series Tablets - AutelEShop, accessed December 11, 2025, https://www.auteleshop.com/wholesale/autel-add-key-immo-functionality-for-bmw-g-chassis-vehicles.html
Mhd software dme unlocked reading. - G20 BMW 3-Series Forum - Bimmerpost, accessed December 11, 2025, https://g20.bimmerpost.com/forums/showthread.php?t=2080531
YOUBBA Smart Remote Key Instruction Manual, accessed December 11, 2025, https://manuals.plus/ae/1005005975279089
BMW Key Fob Upgrade - Mashimarho, accessed December 11, 2025, https://mashimarho.com/products/bmw-g-series-key-fob-upgrade
Ilco PRX-BMW-4B3 BMW 4 Button Prox Key (FCC: NBGIDGNG1) - Keymate Inc., accessed December 11, 2025, https://keymateinc.com/shop-online/key-blanks/automotive-keys/remotes/ilco-prx-bmw-4b3-bmw-4-button-prox-key-fcc-nbgidgng1-detail.html
2015-2021 BMW G-Series / 4-Button Smart Key / 9367401-01 / N5F-ID21A / Silver (OEM REFURB) - UHS Hardware, accessed December 11, 2025, https://www.uhs-hardware.com/products/bmw-g-series-4-button-smart-remote-control-key-bdc2-immo-fcc-id-n5f-id21a-silver-434mhz-remote-only-oem
Autel G-BOX3 Key Programming Adapter for Mercedes and BMW Vehicles, accessed December 11, 2025, https://www.garageappeal.com/autel-g-box3-key-programming-adapter-for-mercedes-and-bmw-vehicles/
ACDP Remplace BMW FEMBDC Module教程 | PDF | Software | Computing - Scribd, accessed December 11, 2025, https://www.scribd.com/document/754855388/ACDP-Remplace-BMW-FEMBDC-Module%E6%95%99%E7%A8%8B
Yanhua Mini ACDP BMW B48/B58 Interface Board for B48/B58 ISN Reading and Clone via Bench Mode - CarDiagTool, accessed December 11, 2025, https://www.cardiagtool.co.uk/yanhua-mini-acdp-bmw-b48b58-interface-board.html
How to Use Autel IM508 with XP400 Pro to fix FRM module on BMW? - AutelShop.us, accessed December 11, 2025, https://www.autelshop.us/blogs/autel-tech-solution/how-to-use-autel-im508-with-xp400-pro-to-fix-frm-module-on-bmw
MERCEDES BENZ ESL ELV PROGRAMMING & EIS W207 ALL KEYS LOST (AUTEL IM608 PRO GBOX2) - YouTube, accessed December 11, 2025, https://www.youtube.com/watch?v=uHue5CjEr_c
