{
    "id": "kia-hyundai-complete-guide",
    "title": "Hyundai/Kia Professional Locksmith Programming Guide",
    "make": "Hyundai",
    "year_start": 2002,
    "year_end": 2025,
    "difficulty": "Advanced",
    "estimated_time": "Varies by security era",
    "last_updated": "2025-12-23",
    "modules": [
        {
            "type": "warning_banner",
            "id": "kia-hyundai-architecture-split",
            "level": "important",
            "content": "HYUNDAI/KIA ARCHITECTURE GROUPS: 1) SMARTRA Legacy (2002-2016, K-Line/Low-CAN), 2) Integrated IBU (2017-2022, ID47), 3) CAN FD / SGW (2023+, 8A). Approaches vary wildly between these groups."
        },
        {
            "type": "info_callout",
            "id": "kia-2012-2013-continuity",
            "level": "tip",
            "content": "2012 vs 2013 Continuity: Most Hyundai/Kia models (Sonata, Elantra, Optima, Sorento) are IDENTICAL for 2012 and 2013. They use the same SMARTRA-3 immobilizer logic and the widely compatible 4-track HY22 lock profile. If your tool lists '2011-2014' as a range, both 2012 and 2013 are fully covered."
        },
        {
            "type": "reference_table",
            "id": "kia-legacy-architecture",
            "title": "SMARTRA Legacy Architecture (2002-2016)",
            "headers": [
                "Era",
                "System",
                "Transponder",
                "Keyway",
                "PIN Source"
            ],
            "rows": [
                {
                    "cells": [
                        "2002-2009",
                        "SMARTRA-2",
                        "ID46 (HITAG2)",
                        "HY15 / HY18",
                        "K-Line Read or VIN search"
                    ]
                },
                {
                    "cells": [
                        "2010-2016",
                        "SMARTRA-3",
                        "ID46 (HITAG2)",
                        "HY22 (4-track)",
                        "OBD Read (Autel/Lonsdor)"
                    ]
                }
            ]
        },
        {
            "type": "warning_banner",
            "id": "kia-bifurcated-security",
            "level": "critical",
            "content": "BIFURCATED SECURITY LANDSCAPE (2021+): Reactive restructuring due to 'Kia Boys' epidemic. Legacy turn-key vehicles received Campaign 993 software patches, while modern Push-to-Start migrated to CAN FD + Security Gateway."
        },
        {
            "type": "info_callout",
            "id": "kia-boys-context",
            "level": "important",
            "content": "The 'Kia Boys' Epidemic: Base trim turn-key Hyundai/Kia vehicles (2011-2022) lacked hardware immobilizers standard in other vehicles. Thieves bypassed ignition using USB cables. This vulnerability was NOT present in Push-to-Start models."
        },
        {
            "type": "reference_table",
            "id": "kia-campaign-993",
            "title": "Campaign 993/CS920 Virtual Immobilizer Logic",
            "headers": [
                "Condition",
                "Pre-Update",
                "Post-Update"
            ],
            "rows": [
                {
                    "cells": [
                        "Ignition Switch Turned",
                        "Starter relay energizes if in Park/Neutral",
                        "BCM checks 'Armed' status first"
                    ]
                },
                {
                    "cells": [
                        "Vehicle Arming",
                        "N/A",
                        "Vehicle 'Arms' 30 sec after doors locked via remote"
                    ]
                },
                {
                    "cells": [
                        "Disarm Requirement",
                        "Physical key presence only",
                        "Valid 'Unlock' signal from factory remote ONLY"
                    ]
                },
                {
                    "cells": [
                        "Break-in Scenario",
                        "Thief can start car",
                        "BCM remains 'Armed' - starter and fuel pump disabled"
                    ]
                }
            ]
        },
        {
            "type": "warning_banner",
            "id": "kia-dead-fob-lockout",
            "level": "warning",
            "content": "Post-Update Dead Fob Lockout: If fob battery dies after locking with remote, using physical key to open door does NOT transmit unlock signal. BCM interprets as intrusion. Car will NOT start even with valid key in ignition. Workaround: Wait for alarm timeout or use limp-home sequences."
        },
        {
            "type": "warning_banner",
            "id": "kia-obd-pin-blocked",
            "level": "critical",
            "content": "OBD PIN Reading BLOCKED: Campaign 993/CS920 hardened the diagnostic stack. Updated BCMs reject standard PIN code reading requests with 'Access Denied'. Locksmiths must obtain PINs from Hyundai/Kia Tech Info portal (requires NASTF VSP credential) or use PIN broker services."
        },
        {
            "type": "reference_table",
            "id": "kia-fcc-id-split",
            "title": "Smart Key FCC ID Architecture Split",
            "headers": [
                "FCC ID",
                "Generation",
                "Architecture",
                "Models",
                "Notes"
            ],
            "rows": [
                {
                    "cells": [
                        "TQ8-FOB-4F24",
                        "Legacy Modern",
                        "Standard CAN",
                        "Telluride 2020-2022, Niro 2019-2020",
                        "PIN reading may work. Standard tools sufficient."
                    ]
                },
                {
                    "cells": [
                        "TQ8-FOB-4F27",
                        "Next-Gen",
                        "CAN FD + SGW",
                        "Palisade 2023+, Santa Fe 2021 Facelift+, Sportage 2023+",
                        "CAN FD Adapter REQUIRED. PIN reading fails."
                    ]
                }
            ]
        },
        {
            "type": "warning_banner",
            "id": "kia-chip-paradox",
            "level": "warning",
            "content": "Chipset Continuity Paradox: Both 4F24 and 4F27 keys use 'HITAG3 ID47' chips. DO NOT assume identical programming. The difference is in the Vehicle Interface - 4F27 keys pair with BCMs using CAN FD (up to 64 bytes/frame vs 8 bytes standard). Legacy tools cannot perform the handshake."
        },
        {
            "type": "reference_table",
            "id": "kia-sgw-implementation",
            "title": "Security Gateway Implementation",
            "headers": [
                "Function",
                "Legacy (Pre-2023)",
                "SGW Enabled (2023+)"
            ],
            "rows": [
                {
                    "cells": [
                        "OBD Emission Reads",
                        "Allowed",
                        "Allowed"
                    ]
                },
                {
                    "cells": [
                        "Bi-directional Controls",
                        "Allowed",
                        "BLOCKED (NRC 0x33)"
                    ]
                },
                {
                    "cells": [
                        "Key Programming",
                        "Allowed",
                        "BLOCKED unless authenticated"
                    ]
                },
                {
                    "cells": [
                        "DTC Clearing",
                        "Allowed",
                        "BLOCKED"
                    ]
                }
            ]
        },
        {
            "type": "info_callout",
            "id": "kia-autoauth-limitation",
            "level": "important",
            "content": "AutoAuth Limitation: While AutoAuth unlocks diagnostics (clearing codes, active tests), it does NOT universally grant authority for KEY PROGRAMMING on Hyundai/Kia. The 'Add Key' function often fails because PIN reading is blocked by separate BCM firmware."
        },
        {
            "type": "warning_banner",
            "id": "kia-can-fd-requirement",
            "level": "critical",
            "content": "CAN FD ADAPTER MANDATORY (Post-June 2023): Vehicles manufactured after June 2023 (labeled MY2024) use CAN FD for BCM. Standard tools broadcasting at 500 kbps will fail - vehicles listen for 2-5 Mbps. Without CAN FD adapter, even valid dealer PIN is useless."
        },
        {
            "type": "reference_table",
            "id": "kia-architecture-timeline",
            "title": "Security Architecture Timeline",
            "headers": [
                "Model Year",
                "Architecture",
                "Security",
                "Key Type",
                "Status"
            ],
            "rows": [
                {
                    "cells": [
                        "2021",
                        "Standard CAN",
                        "Pre-SGW/Passive",
                        "TQ8-FOB-4F24",
                        "Open to OBD PIN (if not updated)"
                    ]
                },
                {
                    "cells": [
                        "2022",
                        "Standard CAN",
                        "Transitional (some SGW)",
                        "TQ8-FOB-4F24",
                        "Campaign 993 blocks PIN reading"
                    ]
                },
                {
                    "cells": [
                        "2023 (Early)",
                        "SGW Standard",
                        "SGW + Standard CAN",
                        "TQ8-FOB-4F27",
                        "AutoAuth or Physical Bypass required"
                    ]
                },
                {
                    "cells": [
                        "2023 (Post-June)/2024",
                        "CAN FD + SGW",
                        "Full Fortress Mode",
                        "TQ8-FOB-4F27",
                        "CAN FD Adapter + Bypass + Dealer PIN required"
                    ]
                }
            ]
        },
        {
            "type": "step_group",
            "id": "kia-2024-programming",
            "title": "Procedure: 2024 Santa Fe/Telluride All Keys Lost",
            "estimated_time": "45-60 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "Confirm vehicle is post-June 2023 production (check door sticker)",
                    "warning": "If CAN FD, standard tools will NOT connect"
                },
                {
                    "number": 2,
                    "text": "Connect CAN FD Adapter to OBD port, then connect programmer to adapter"
                },
                {
                    "number": 3,
                    "text": "Physical SGW Bypass: May need to locate and bypass SGW (knee bolster or behind instrument cluster)"
                },
                {
                    "number": 4,
                    "text": "Navigate to Control Unit → Body → Teaching"
                },
                {
                    "number": 5,
                    "text": "Read PIN function WILL FAIL. Manually input 6-digit PIN from dealer/broker"
                },
                {
                    "number": 6,
                    "text": "Once PIN accepted, 'Key Learn' window is EXTREMELY SHORT (5 seconds)",
                    "warning": "Must immediately hold smart key to Start/Stop button"
                },
                {
                    "number": 7,
                    "text": "Hazard lights flash to confirm programming"
                },
                {
                    "number": 8,
                    "text": "Repeat immediately for second key"
                }
            ]
        },
        {
            "type": "step_group",
            "id": "kia-dead-fob-emergency",
            "title": "Procedure: Dead Fob Emergency Start (Post-Update Vehicles)",
            "estimated_time": "2-5 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "Pop cosmetic cap covering keyhole on driver door"
                },
                {
                    "number": 2,
                    "text": "Use mechanical key blade (hidden in fob) to open door"
                },
                {
                    "number": 3,
                    "text": "If alarm triggers from door open, wait for timeout (5-10 min soak period)"
                },
                {
                    "number": 4,
                    "text": "Press Start/Stop button directly WITH the Smart Key held at 90-degree angle to button"
                },
                {
                    "number": 5,
                    "text": "Button housing LF antenna ring energizes passive ID47 transponder for authentication"
                }
            ]
        },
        {
            "type": "reference_table",
            "id": "kia-model-case-studies",
            "title": "Model-Specific Case Studies",
            "headers": [
                "Model",
                "Years",
                "System",
                "Key",
                "Notes"
            ],
            "rows": [
                {
                    "cells": [
                        "Telluride",
                        "2020-2022",
                        "Standard CAN",
                        "TQ8-FOB-4F24",
                        "Standard tools work. PIN reading may succeed."
                    ]
                },
                {
                    "cells": [
                        "Sportage",
                        "2023",
                        "SGW, possibly CAN FD",
                        "TQ8-FOB-4F27",
                        "'Problem Child'. Early 2023 = Standard CAN. Late 2023 = CAN FD. Test communication first."
                    ]
                },
                {
                    "cells": [
                        "Santa Fe",
                        "2024",
                        "Native CAN FD + SGW",
                        "TQ8-FOB-4F27",
                        "Fully hardened. CAN FD adapter + dealer PIN required. No OBD PIN reading possible."
                    ]
                }
            ]
        },
        {
            "type": "comparison_table",
            "id": "kia-tool-compatibility",
            "title": "Tool Compatibility Matrix",
            "items": [
                "Autel IM508/IM608",
                "Xtool AutoProPad",
                "Smart Pro"
            ],
            "features": [
                {
                    "name": "CAN FD Adapter Support",
                    "values": [
                        "Yes (Required for 2024)",
                        "M811 Adapter Required",
                        "Yes"
                    ]
                },
                {
                    "name": "AutoAuth Integration",
                    "values": [
                        "Yes (Subscription)",
                        "Limited",
                        "Yes (Subscription)"
                    ]
                },
                {
                    "name": "OBD PIN Reading",
                    "values": [
                        "Fails on updated firmware",
                        "Struggles with SGW",
                        "Requires separate purchase"
                    ]
                },
                {
                    "name": "2024 Model Support",
                    "values": [
                        "Yes with CAN FD + Manual PIN",
                        "Limited",
                        "Yes with subscription"
                    ]
                }
            ]
        },
        {
            "type": "info_callout",
            "id": "kia-future-outlook",
            "level": "warning",
            "content": "Future Outlook: The era of 'plug-and-play' key programming for Kia/Hyundai is OVER. 2025+ models will adopt Ultra-Wideband (UWB) for Digital Key 2.0, pushing the Smart Key into a digital credential managed via smartphone. Hardware access will be gated by proprietary CAN FD, server authentication, and encrypted credentials."
        }
    ]
}