{
    "id": "jlr-complete-guide",
    "title": "Jaguar Land Rover KVM/RFA Architecture Guide",
    "make": "Land Rover",
    "year_start": 2002,
    "year_end": 2025,
    "difficulty": "Expert",
    "estimated_time": "Varies by era (30 min to 2+ hours)",
    "last_updated": "2025-12-23",
    "modules": [
        {
            "type": "warning_banner",
            "id": "jlr-identity-crisis",
            "level": "critical",
            "content": "JLR IDENTITY CRISIS (2002-2012): Land Rover vehicles have 'split-personality' security reflecting CHANGING OWNERSHIP. 2002-2005 L322 = BMW EWS3 (use BMW procedures!). 2005-2009 Discovery 3/RR Sport = Ford-era PCM. 2010+ = Modern JLR KVM/RFA. Wrong diagnosis = wrong approach = failed programming."
        },
        {
            "type": "reference_table",
            "id": "jlr-architecture-timeline",
            "title": "JLR Security Architecture Timeline",
            "headers": [
                "Era",
                "Years",
                "Parent Platform",
                "Security System",
                "Diagnostic Approach"
            ],
            "rows": [
                {
                    "cells": [
                        "BMW Era",
                        "2002-2005",
                        "BMW X5 (E53)",
                        "EWS3 Immobilizer",
                        "USE BMW MENU in diagnostic tool"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Ford Era",
                        "2005-2009",
                        "Ford/Volvo",
                        "PCM-based (Ford derivation)",
                        "Ford protocols, AD Smart Pro strong"
                    ]
                },
                {
                    "cells": [
                        "Transition",
                        "2010-2012",
                        "Early JLR native",
                        "KVM Introduction",
                        "OBD + APB112 emulator"
                    ]
                },
                {
                    "cells": [
                        "Modern JLR",
                        "2013-2018",
                        "JLR Native (Tata)",
                        "KVM/RFA/BECM",
                        "Lonsdor JLR Cable (market leader)"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Secure JLR",
                        "2018-2025",
                        "JLR Native + SGW",
                        "KVM + Security Gateway",
                        "JLR Pathfinder / TOPIX Online"
                    ],
                    "highlight": true
                }
            ]
        },
        {
            "type": "warning_banner",
            "id": "jlr-l322-bmw-trap",
            "level": "critical",
            "content": "L322 RANGE ROVER (2002-2005) 'HIDDEN MENU' TRAP: This vehicle is essentially a BMW X5 (E53) with Land Rover body panels. The immobilizer is a BMW EWS3 box with a Land Rover part number. You will NOT find coverage under 'Land Rover' in most tools. SELECT BMW → E38/E39/X5 E53 EWS systems. Same procedure as BMW 7-Series."
        },
        {
            "type": "reference_table",
            "id": "jlr-model-platform",
            "title": "Model-Platform-Security Mapping",
            "headers": [
                "Model",
                "Type",
                "Years",
                "Platform Base",
                "Security System",
                "Tool Approach"
            ],
            "rows": [
                {
                    "cells": [
                        "Range Rover L322",
                        "SUV",
                        "2002-2005",
                        "BMW X5 (E53)",
                        "EWS3",
                        "BMW Menu (Bench required for AKL)"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Range Rover L322",
                        "SUV",
                        "2006-2012",
                        "Ford/JLR Transition",
                        "KVM Introduction",
                        "JLR Menu + OBD"
                    ]
                },
                {
                    "cells": [
                        "Range Rover L405",
                        "SUV",
                        "2013-2021",
                        "JLR D7",
                        "KVM/RFA",
                        "Lonsdor JLR Cable or SDD"
                    ]
                },
                {
                    "cells": [
                        "Range Rover L460",
                        "SUV",
                        "2022-2025",
                        "MLA",
                        "Online Authentication",
                        "JLR Pathfinder Online"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Discovery 3 (LR3)",
                        "SUV",
                        "2005-2009",
                        "Ford/Volvo",
                        "Ford PCM-based",
                        "Smart Pro ADS2174 or OBD"
                    ]
                },
                {
                    "cells": [
                        "Discovery 4 (LR4)",
                        "SUV",
                        "2010-2016",
                        "JLR Native",
                        "KVM + RFA",
                        "Lonsdor/Autel via OBD"
                    ]
                },
                {
                    "cells": [
                        "Discovery 5",
                        "SUV",
                        "2017-2025",
                        "JLR D7",
                        "KVM + SGW",
                        "JLR Pathfinder preferred"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Range Rover Sport L320",
                        "SUV",
                        "2005-2009",
                        "Discovery 3 Platform",
                        "Ford PCM-based",
                        "Same as LR3 - Ford protocols"
                    ]
                },
                {
                    "cells": [
                        "Range Rover Sport L494",
                        "SUV",
                        "2013-2022",
                        "JLR D7",
                        "KVM/RFA",
                        "Lonsdor JLR Cable"
                    ]
                },
                {
                    "cells": [
                        "Range Rover Evoque L538",
                        "SUV",
                        "2012-2019",
                        "JLR PLA",
                        "KVM/RFA",
                        "OBD via Autel/Lonsdor"
                    ]
                },
                {
                    "cells": [
                        "Range Rover Evoque L551",
                        "SUV",
                        "2020-2025",
                        "JLR PTA",
                        "KVM + Online Auth",
                        "JLR Pathfinder (may need TOPIX)"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Defender (New)",
                        "SUV",
                        "2020-2025",
                        "JLR D7",
                        "KVM + Online Auth",
                        "JLR Pathfinder Online"
                    ],
                    "highlight": true
                }
            ]
        },
        {
            "type": "info_callout",
            "id": "jlr-kvm-explanation",
            "level": "important",
            "content": "KVM (Keyless Vehicle Module): The central 'brain' for JLR keyless entry and immobilizer (2010+). Stores key data, manages RF communication, and authorizes start. Location varies: typically rear cargo area (LR4, RR Sport) or integrated body domain. Can be 'Locked' or 'Unlocked' states similar to Mercedes EIS."
        },
        {
            "type": "info_callout",
            "id": "jlr-rfa-explanation",
            "level": "important",
            "content": "RFA (Remote Frequency Antenna) Module: Manages key synchronization and RF signal reception. Common failure mode: key fob 'dies' after battery change even with good battery. This is RFA desync - NOT a dead fob. Resync possible via OBD without dealer SDD on many models."
        },
        {
            "type": "warning_banner",
            "id": "jlr-kvm-locked-state",
            "level": "warning",
            "content": "KVM 'LOCKED' vs 'UNLOCKED' STATE: Like Mercedes EIS and BMW FEM, the JLR KVM can enter a locked state from failed programming attempts or module replacement. Locked KVM = dealer only. Tools like Xhorse VVDI JLR and Yanhua ACDP support KVM virginization for some masks, but modern OTP-programmed modules may be unrecoverable without JLR online."
        },
        {
            "type": "reference_table",
            "id": "jlr-akl-feasibility",
            "title": "All Keys Lost (AKL) Aftermarket Feasibility",
            "headers": [
                "Model/Era",
                "OBD Possible?",
                "Bench Required?",
                "Recommended Approach"
            ],
            "rows": [
                {
                    "cells": [
                        "L322 (2002-2005 BMW Era)",
                        "NO (EWS3)",
                        "YES (XP400 Pro)",
                        "Treat as BMW E53: Bench EWS module"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Discovery 3 / RR Sport L320 (Ford Era)",
                        "YES (AD Smart Pro)",
                        "NO",
                        "Smart Pro ADS2174/ADS2230 modules"
                    ]
                },
                {
                    "cells": [
                        "L322 (2006-2012)",
                        "YES",
                        "Sometimes",
                        "Autel IM608 + APB112 emulator"
                    ]
                },
                {
                    "cells": [
                        "2013-2018 (KVM models)",
                        "YES",
                        "NO (OBD preferred)",
                        "Lonsdor K518 + JLR Cable = market leader"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "2018+ (SGW models)",
                        "LIMITED",
                        "Sometimes",
                        "JLR Pathfinder Online or TOPIX"
                    ],
                    "highlight": true
                }
            ]
        },
        {
            "type": "info_callout",
            "id": "jlr-lonsdor-market-leader",
            "level": "tip",
            "content": "LONSDOR K518 = JLR MARKET LEADER (2013-2018): Lonsdor has a dedicated JLR engineering team. The JLR Cable accessory enables 'Make Dealer Key' function that simplifies rolling code alignment for these notoriously finicky remotes. For Discovery 4, RR Sport L494, and Evoque L538, Lonsdor is often faster and more reliable than competitors."
        },
        {
            "type": "step_group",
            "id": "jlr-ews3-l322",
            "title": "Procedure: L322 Range Rover (2002-2005) AKL - BMW EWS3 Method",
            "estimated_time": "90-120 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "IDENTIFY: Confirm 2002-2005 production year. This vehicle uses BMW EWS3 immobilizer."
                },
                {
                    "number": 2,
                    "text": "TOOL SELECTION: Navigate to BMW Menu (NOT Land Rover). Select E38/E39/X5 E53 → EWS3."
                },
                {
                    "number": 3,
                    "text": "EXTRACTION: Remove EWS3 module (white/black box under driver dash). Connect to XP400 Pro via APA104 cable."
                },
                {
                    "number": 4,
                    "text": "READ MCU: Tool reads Motorola MC68HC11 or 9S12 microcontroller dump."
                },
                {
                    "number": 5,
                    "text": "KEY GENERATION: Tool generates dealer key file. Write to blank PCF7935 transponder."
                },
                {
                    "number": 6,
                    "text": "REINSTALL: Reinstall EWS module. Learn new key via OBD."
                },
                {
                    "number": 7,
                    "text": "CAUTION: Desoldering/clamping on coated MCUs risks data corruption = 'bricked' module."
                }
            ]
        },
        {
            "type": "step_group",
            "id": "jlr-discovery-3-ford",
            "title": "Procedure: Discovery 3 / RR Sport L320 (2005-2009) AKL",
            "estimated_time": "30-45 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "IDENTIFY: These Ford-era vehicles use Ford PCM-based security, NOT KVM."
                },
                {
                    "number": 2,
                    "text": "TOOL SELECTION: Smart Pro with ADS2174 (Discovery 3) or ADS2230 (RR Sport) modules."
                },
                {
                    "number": 3,
                    "text": "CONNECT: Standard OBD connection. Follow guided workflow."
                },
                {
                    "number": 4,
                    "text": "REMOTE SYNC: These models are notoriously finicky for remote synchronization. Follow exact button sequence."
                },
                {
                    "number": 5,
                    "text": "ALTERNATIVE: Autel IM608 also supports via OBD but may require more manual steps."
                }
            ]
        },
        {
            "type": "step_group",
            "id": "jlr-kvm-2013-2018",
            "title": "Procedure: 2013-2018 KVM Models AKL (Lonsdor Method)",
            "estimated_time": "20-30 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "CONNECT: Lonsdor K518 with JLR Cable to OBD port."
                },
                {
                    "number": 2,
                    "text": "SELECT: Land Rover → Model → Year → 'All Keys Lost'."
                },
                {
                    "number": 3,
                    "text": "DEALER KEY: Select 'Make Dealer Key' function. This handles rolling code alignment automatically."
                },
                {
                    "number": 4,
                    "text": "EMULATION: If required, place blank key in Lonsdor antenna slot for pre-coding."
                },
                {
                    "number": 5,
                    "text": "LEARN: Follow on-screen prompts to learn new key to KVM."
                },
                {
                    "number": 6,
                    "text": "TEST: Test start, remote lock/unlock, and passive entry before returning vehicle."
                }
            ]
        },
        {
            "type": "warning_banner",
            "id": "jlr-2018-online-reality",
            "level": "critical",
            "content": "2018+ ONLINE AUTHENTICATION: New Evoque L551, Defender L663, Discovery 5, and Range Rover L460 increasingly require JLR Pathfinder/SDD with online TOPIX connection for key programming. Aftermarket tools have LIMITED coverage. Budget for dealer referral on these models."
        },
        {
            "type": "reference_table",
            "id": "jlr-fcc-mapping",
            "title": "JLR FCC ID / Frequency Reference",
            "headers": [
                "Model/Era",
                "FCC ID Pattern",
                "Frequency",
                "Notes"
            ],
            "rows": [
                {
                    "cells": [
                        "L322 (BMW Era)",
                        "LX8...",
                        "315 MHz (NA) / 433 MHz (ROW)",
                        "BMW-style remote head key"
                    ]
                },
                {
                    "cells": [
                        "Discovery 3 / RR Sport L320",
                        "YWX000...",
                        "315 MHz / 433 MHz",
                        "Ford-era 3-button fob"
                    ]
                },
                {
                    "cells": [
                        "KVM Era (2010-2018)",
                        "KOBJTF10A",
                        "315 MHz / 433 MHz",
                        "5-button smart key"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "2018+ (Modern)",
                        "KOBJXF18A / PEPS",
                        "315 MHz / 433 MHz",
                        "Activity Key option (waterproof)"
                    ]
                }
            ]
        },
        {
            "type": "tool_checklist",
            "id": "jlr-tool-selection",
            "title": "Tool Selection by JLR Era",
            "items": [
                {
                    "name": "Autel IM608 Pro + XP400 Pro",
                    "required": true,
                    "notes": "Best for L322 BMW-era (bench EWS) and 2010-2012 KVM transition"
                },
                {
                    "name": "Lonsdor K518 + JLR Cable",
                    "required": true,
                    "notes": "Market leader for 2013-2018 KVM models. Fastest, most stable."
                },
                {
                    "name": "AD Smart Pro + ADS2174/2230",
                    "required": false,
                    "notes": "Best for Ford-era Discovery 3/RR Sport (2005-2009)"
                },
                {
                    "name": "Xhorse VVDI JLR",
                    "required": false,
                    "notes": "KVM virginization for some masks"
                },
                {
                    "name": "Yanhua ACDP JLR Module",
                    "required": false,
                    "notes": "KVM repair, key renewal"
                }
            ]
        },
        {
            "type": "info_callout",
            "id": "jlr-jaguar-note",
            "level": "important",
            "content": "JAGUAR COVERAGE: Jaguar uses the same KVM/RFA architecture as Land Rover (same parent company). XE, XF, F-Pace, E-Pace, F-Type all follow similar procedures. Select 'Jaguar' in tool menu, but troubleshooting approach is identical to Land Rover counterparts."
        }
    ]
}