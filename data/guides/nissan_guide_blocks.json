{
    "id": "nissan-complete-guide",
    "title": "Nissan NATS Professional Locksmith Guide",
    "make": "Nissan",
    "year_start": 2000,
    "year_end": 2025,
    "difficulty": "Intermediate",
    "estimated_time": "Varies by system",
    "last_updated": "2025-12-23",
    "source_pdf": "/guides/Nissan_Immobilizer_Systems_A_Professional_Guide.pdf",
    "modules": [
        {
            "type": "info_callout",
            "id": "nissan-bcm-centric",
            "level": "important",
            "content": "Nissan architecture is BCM-centric. Unlike Ford (PCM-based) or Mercedes (EIS-based), the Body Control Module stores key IDs and performs cryptographic validation. The BCM authorizes the ECM via CAN-bus."
        },
        {
            "type": "reference_table",
            "id": "nissan-nats-evolution",
            "title": "NATS System Evolution",
            "headers": [
                "Phase",
                "Years",
                "System",
                "Chip",
                "Frequency",
                "PIN Type"
            ],
            "rows": [
                {
                    "cells": [
                        "Phase 1",
                        "2000-2006",
                        "NATS 5/5.6",
                        "TI 4D-60",
                        "N/A",
                        "4-digit (from BCM label)"
                    ]
                },
                {
                    "cells": [
                        "Phase 2",
                        "2007-2012",
                        "Intelligent Key (Twist)",
                        "ID46 (PCF7936)",
                        "315 MHz",
                        "4/5-digit"
                    ]
                },
                {
                    "cells": [
                        "Phase 2b",
                        "2007-2014",
                        "Intelligent Key (Push)",
                        "ID46 (PCF7952)",
                        "315 MHz",
                        "4/5-digit"
                    ]
                },
                {
                    "cells": [
                        "Phase 3",
                        "2013-2018",
                        "NATS 6 Prox",
                        "ID47 (HITAG 3)",
                        "433 MHz",
                        "20-digit rolling"
                    ]
                },
                {
                    "cells": [
                        "Phase 4",
                        "2019-2025",
                        "Modern Prox",
                        "ID4A (HITAG-AES)",
                        "433 MHz",
                        "22-digit rolling"
                    ]
                }
            ]
        },
        {
            "type": "warning_banner",
            "id": "nissan-rolling-code-warning",
            "level": "warning",
            "content": "2013+ Rolling Codes: The BCM generates a random 20-digit challenge every time ignition cycles. Calculation must be performed and entered immediately. If tool disconnects or ignition cycles, BCM generates NEW challenge and old PIN is invalid."
        },
        {
            "type": "warning_banner",
            "id": "nissan-bcm-lockout",
            "level": "critical",
            "content": "Incorrect PIN 3-5 times = BCM Lock Mode. Recovery: Disconnect battery for 15-20 minutes. On older NATS 5: leave ignition ON for 60 minutes with charger connected to reset timer."
        },
        {
            "type": "info_callout",
            "id": "nissan-bcm-label-trap",
            "level": "warning",
            "content": "BCM Label Trap: If BCM was replaced with used unit, physical sticker may show donor car ID but electronic ID differs. ALWAYS prioritize Electronic Read (via OBD) over physical label."
        },
        {
            "type": "warning_banner",
            "id": "nissan-40pin-mandatory",
            "level": "critical",
            "content": "40-PIN BCM CABLE MANDATORY (2020+): For AKL on Sentra B18, Rogue T33, or Pathfinder R53, the 16+32 bypass is NOT ENOUGH. These 'Read-Protected' BCMs use 22-digit rolling codes and do NOT broadcast PIN data over standard CAN. The 40-pin cable connects DIRECTLY to the BCM's MCU, bypassing the SGW AND the network to extract EEPROM data for calculation."
        },
        {
            "type": "reference_table",
            "id": "nissan-bypass-requirement-matrix",
            "title": "Bypass Cable Requirement by Model (AKL)",
            "headers": [
                "Model",
                "Years",
                "Platform",
                "16+32 Cable",
                "40-Pin Cable",
                "AKL Method"
            ],
            "rows": [
                {
                    "cells": [
                        "Sentra",
                        "2020-2025",
                        "B18",
                        "Add Key ONLY",
                        "REQUIRED",
                        "40-pin BCM dump → 28-digit PIN"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Rogue",
                        "2021-2025",
                        "T33",
                        "Add Key ONLY",
                        "REQUIRED",
                        "40-pin BCM dump → 22-digit PIN"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Pathfinder",
                        "2022-2025",
                        "R53",
                        "Add Key ONLY",
                        "REQUIRED",
                        "40-pin BCM dump → 22-digit PIN"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Frontier",
                        "2022-2025",
                        "D41",
                        "Sufficient",
                        "Optional",
                        "16+32 OBD calculation"
                    ]
                },
                {
                    "cells": [
                        "Altima",
                        "2019-2025",
                        "L34",
                        "Add Key ONLY",
                        "REQUIRED",
                        "40-pin BCM dump → 22-digit PIN"
                    ],
                    "highlight": true
                }
            ]
        },
        {
            "type": "reference_table",
            "id": "nissan-bcm-part-number-identify",
            "title": "Read-Protected BCM Identification (Part Number)",
            "headers": [
                "Part Number Pattern",
                "Model",
                "PIN Type",
                "Bypass Req"
            ],
            "rows": [
                {
                    "cells": [
                        "284B1-6LJ0A / 6LJ1B",
                        "Sentra B18",
                        "28-digit",
                        "40-Pin Mandatory"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "284B2-6RA3A",
                        "Rogue T33",
                        "22-digit",
                        "40-Pin Mandatory"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "284B1-5RL0A/1A",
                        "Kicks P15 / Versa N18",
                        "22-digit",
                        "40-Pin Recommended"
                    ]
                },
                {
                    "cells": [
                        "284B1-9Gxxx",
                        "Legacy (Armada/Titan)",
                        "20-digit",
                        "16+32 Sufficient"
                    ]
                }
            ]
        },
        {
            "type": "info_callout",
            "id": "nissan-40pin-vs-16-32-logic",
            "level": "important",
            "content": "16+32 = Network Solution (restores OBD communication by bypassing SGW). 40-Pin = Hardware Solution (directly reads BCM MCU, bypasses vehicle network entirely). Both are needed: 16+32 for diagnostics/add-key, 40-pin for AKL memory dump on protected BCMs."
        },
        {
            "type": "warning_banner",
            "id": "nissan-sgw-warning",
            "level": "critical",
            "content": "2020+ Security Gateway: Sentra (B18) and Rogue (T33) have FIREWALLED OBD ports. Unlike Hyundai (AutoAuth software), Nissan requires PHYSICAL 16+32 CABLE bypass. No software-only solution exists."
        },
        {
            "type": "reference_table",
            "id": "nissan-sgw-locations",
            "title": "Security Gateway Locations (16+32 Models)",
            "headers": [
                "Model",
                "Years",
                "Chassis",
                "SGW/BCM Location",
                "Access Notes"
            ],
            "rows": [
                {
                    "cells": [
                        "Sentra",
                        "2020-2025",
                        "B18",
                        "Under Driver Dash (Near BCM)",
                        "Above brake pedal, left side"
                    ],
                    "highlight": false
                },
                {
                    "cells": [
                        "Rogue",
                        "2021-2025",
                        "T33",
                        "Behind Instrument Cluster / Upper Dash",
                        "Cluster bezel removal required (labor-intensive)"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Pathfinder",
                        "2022-2025",
                        "R53",
                        "Driver Kick Panel / BCM Area",
                        "Similar to Sentra access"
                    ],
                    "highlight": false
                }
            ]
        },
        {
            "type": "step_group",
            "id": "nissan-16-32-bypass-procedure",
            "title": "Procedure: 16+32 Gateway Bypass",
            "estimated_time": "20-30 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "LOCATE: Access BCM area (see location table above). Look for 40-pin connector block split into 16-pin and 32-pin sections."
                },
                {
                    "number": 2,
                    "text": "UNPLUG: Disconnect both connectors from BCM/Gateway module."
                },
                {
                    "number": 3,
                    "text": "INSERT CABLE: Connect 16+32 bypass cable to vehicle-side harnesses. Plug male ends back into BCM (pass-through/tee design)."
                },
                {
                    "number": 4,
                    "text": "CONNECT TOOL: Plug OBD-II female port of bypass cable to scan tool."
                },
                {
                    "number": 5,
                    "text": "PROCEED: Direct CAN access achieved. Perform PIN read and key programming normally."
                },
                {
                    "number": 6,
                    "text": "RESTORE: After programming, remove bypass cable and reconnect OEM connectors."
                }
            ]
        },
        {
            "type": "info_callout",
            "id": "nissan-autoauth-note",
            "level": "note",
            "content": "AutoAuth for Diagnostics: Nissan supports AutoAuth for basic diagnostics (clearing codes, live data). However, for KEY PROGRAMMING, the gateway blocks immobilizer write commands even with AutoAuth. The 16+32 cable is effectively MANDATORY for AKL."
        },
        {
            "type": "warning_banner",
            "id": "nissan-escl-failure",
            "level": "warning",
            "content": "ESCL FAILURE: Nissan has a unique Electronic Steering Column Lock (ESCL) failure issue. Symptoms: Key won't turn (Twist Knob) or No Crank (Push Start). DTCs B2609/B2610. Fix: Replace ESCL or install ESCL EMULATOR to bypass the mechanical lock permanently."
        },
        {
            "type": "step_group",
            "id": "nissan-escl-diagnosis",
            "title": "Procedure: ESCL Diagnosis and Emulator Install",
            "estimated_time": "15-30 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "SYMPTOMS: Twist Knob won't turn OR Push Start = no crank. Yellow 'Key' light may appear."
                },
                {
                    "number": 2,
                    "text": "AUDIO TEST: Press Start button - healthy car produces 'zzzt-clunk' of lock disengaging. Silence = ESCL failure."
                },
                {
                    "number": 3,
                    "text": "TAP TEST: While pressing Start, strike steering column housing with rubber mallet. Vibration may free stuck motor."
                },
                {
                    "number": 4,
                    "text": "SCAN: Check BCM for DTCs B2609 (Steering Lock Status) or B2610 (Ignition Relay)."
                },
                {
                    "number": 5,
                    "text": "EMULATOR: For permanent fix, unplug ESCL connector and plug in aftermarket ESCL Emulator. Device mimics 'Unlocked' signal."
                },
                {
                    "number": 6,
                    "text": "TEST: Vehicle should now start normally without mechanical lock engagement."
                }
            ]
        },
        {
            "type": "reference_table",
            "id": "nissan-transponder-reference",
            "title": "Transponder Reference Table",
            "headers": [
                "Era",
                "System",
                "Chip",
                "Frequency",
                "Keyway",
                "Models"
            ],
            "rows": [
                {
                    "cells": [
                        "2000-2006",
                        "NATS 5 Legacy",
                        "TI 4D-60 (40-bit)",
                        "N/A",
                        "DA34/NSN14",
                        "Maxima, Altima, Frontier"
                    ]
                },
                {
                    "cells": [
                        "2007-2012",
                        "Intelligent Key (Twist)",
                        "ID46 (PCF7936)",
                        "315 MHz",
                        "NSN14",
                        "Rogue, Versa, Sentra"
                    ]
                },
                {
                    "cells": [
                        "2007-2014",
                        "Intelligent Key (Push)",
                        "ID46 (PCF7952)",
                        "315 MHz",
                        "NSN14 Blade",
                        "Altima, Maxima, G37, 370Z"
                    ]
                },
                {
                    "cells": [
                        "2013-2018",
                        "NATS 6 Prox",
                        "ID47 (HITAG 3)",
                        "433 MHz",
                        "NSN14",
                        "Altima, Rogue, Pathfinder"
                    ]
                },
                {
                    "cells": [
                        "2019-2025",
                        "Modern Prox",
                        "ID4A (HITAG-AES)",
                        "433 MHz",
                        "NSN14",
                        "Sentra, Versa, Rogue, Kicks"
                    ]
                },
                {
                    "cells": [
                        "2016+",
                        "Commercial/Truck",
                        "ID46 Extended",
                        "315 MHz",
                        "NSN14",
                        "Titan, Frontier (Steel Key)"
                    ]
                }
            ]
        },
        {
            "type": "warning_banner",
            "id": "nissan-virgin-key-only",
            "level": "warning",
            "content": "ID47/ID4A keys are One-Time Programmable. Used Nissan keys are locked and cannot be reprogrammed to another vehicle without specialized 'Unlocking' hardware. Stock VIRGIN keys only."
        },
        {
            "type": "step_group",
            "id": "nissan-rogue-2011-akl",
            "title": "Procedure: 2011 Nissan Rogue (Twist Knob) All Keys Lost",
            "estimated_time": "30-40 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "Use Lishi NSN14 to pick driver door lock and decode heights"
                },
                {
                    "number": 2,
                    "text": "Cut new emergency blade from decoded cuts"
                },
                {
                    "number": 3,
                    "text": "Insert blade into ignition knob, turn to ON",
                    "warning": "If ignition won't turn, suspect ESCL failure"
                },
                {
                    "number": 4,
                    "text": "Connect Autel IM608 to OBD-II"
                },
                {
                    "number": 5,
                    "text": "Select IMMO → Nissan → Intelligent Key System → Remote Control Learning"
                },
                {
                    "number": 6,
                    "text": "Select 'Read BCM Code' - tool reads 5-digit ID and calculates 4-digit PIN (e.g., 5523)"
                },
                {
                    "number": 7,
                    "text": "Select 'Program Smart Key'"
                },
                {
                    "number": 8,
                    "text": "Tool prompts: 'Insert key and turn ON' - use mechanical blade"
                },
                {
                    "number": 9,
                    "text": "Security Light illuminates solid, then flashes 5 times"
                },
                {
                    "number": 10,
                    "text": "Turn OFF, remove key"
                },
                {
                    "number": 11,
                    "text": "For remote: Press UNLOCK button while holding key near ignition antenna"
                },
                {
                    "number": 12,
                    "text": "Turn ignition ON again with blade, wait for flashes, turn OFF"
                },
                {
                    "number": 13,
                    "text": "Open/close driver door to terminate programming. Test remote and Twist Knob start"
                }
            ]
        },
        {
            "type": "step_group",
            "id": "nissan-altima-2016-add-key",
            "title": "Procedure: 2016 Nissan Altima Add Smart Key",
            "estimated_time": "15-20 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "Verify new key: Correct frequency (433 MHz) and chip (ID47). USED KEYS WILL NOT WORK."
                },
                {
                    "number": 2,
                    "text": "Connect Autel/SmartPro to OBD-II"
                },
                {
                    "number": 3,
                    "text": "Select Nissan → Altima → 2013-2018 → Smart Key → Add Key"
                },
                {
                    "number": 4,
                    "text": "Tool reads 20-digit Challenge from BCM"
                },
                {
                    "number": 5,
                    "text": "Autel auto-sends to server (requires internet). SmartPro consumes token."
                },
                {
                    "number": 6,
                    "text": "Tool prompts: 'Touch Start Button with first programmed key'"
                },
                {
                    "number": 7,
                    "text": "Press Start Button (Ignition ON)"
                },
                {
                    "number": 8,
                    "text": "Touch NEW key to Start Button"
                },
                {
                    "number": 9,
                    "text": "Watch for Security Light to flash 5 times"
                },
                {
                    "number": 10,
                    "text": "Turn Ignition OFF"
                },
                {
                    "number": 11,
                    "text": "Test proximity Lock/Unlock/Trunk and Proximity Start (key in pocket)"
                }
            ]
        },
        {
            "type": "warning_banner",
            "id": "nissan-escl-failure",
            "level": "critical",
            "content": "ESCL (Electronic Steering Column Lock) Failure: If BCM can't get 'Unlocked' signal from ESCL, start is inhibited. Common on Rogue/Versa. Symptoms: Key can't turn knob (Twist), or 'No Crank/No Start' with Yellow Key light (Push). Fix: Install $20-40 ESCL Emulator."
        },
        {
            "type": "step_group",
            "id": "nissan-escl-diagnosis",
            "title": "Procedure: ESCL Troubleshooting",
            "estimated_time": "10-15 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "Twist Knob: Key can't turn plastic knob = physically locked"
                },
                {
                    "number": 2,
                    "text": "Push Start: Press Start button, listen for 'zzzt-clunk' of steering lock disengaging",
                    "tip": "Silence = ESCL failure"
                },
                {
                    "number": 3,
                    "text": "Scan for DTCs B2609 (Steering Column Lock Status) or B2610 (Ignition Relay) in BCM"
                },
                {
                    "number": 4,
                    "text": "Tap Test: While pressing Start/turning knob, strike steering column housing with rubber mallet",
                    "tip": "Vibration often frees stuck motor brushes temporarily"
                },
                {
                    "number": 5,
                    "text": "Permanent fix: Install ESCL Emulator - plugs into connector, digitally mimics 'Unlocked' signal"
                }
            ]
        },
        {
            "type": "info_callout",
            "id": "nissan-16-32-gateway",
            "level": "important",
            "content": "2020+ Sentra (B18) and 2021+ Rogue (T33): OBD-II port is firewalled. Requires physical 16+32 Y-cable bypass. Locate Security Gateway Module (near BCM or glovebox), connect cable in-line to access CAN lines directly."
        },
        {
            "type": "tool_checklist",
            "id": "nissan-key-inventory",
            "title": "Essential Key Inventory",
            "items": [
                {
                    "name": "TI 4D-60 (Generic)",
                    "required": true,
                    "notes": "For 2000-2006 vehicles"
                },
                {
                    "name": "PCF7936 (ID46)",
                    "required": true,
                    "notes": "For 2007-2012 Intelligent Key"
                },
                {
                    "name": "PCF7952 (ID46 Remote)",
                    "required": true,
                    "notes": "For Push-Button Start"
                },
                {
                    "name": "Nissan 3-Button Prox (315 MHz)",
                    "required": true
                },
                {
                    "name": "Nissan 4-Button Prox (433 MHz)",
                    "required": true,
                    "warning": "Check FCC ID - visually identical fobs may differ"
                },
                {
                    "name": "NSN14 Emergency Blades",
                    "required": true
                }
            ]
        },
        {
            "type": "info_callout",
            "id": "nissan-nsn14-door-ignition",
            "level": "tip",
            "content": "NSN14 Decoding: Door lock typically has cuts in positions 3-10 only. Ignition has ALL cuts 1-10. When generating key from door lock, use progression software (InstaCode) to calculate missing cuts 1 and 2."
        },
        {
            "type": "comparison_table",
            "id": "nissan-tool-comparison",
            "title": "Tool Comparison",
            "items": [
                "Autel IM508/IM608",
                "SmartPro",
                "Lonsdor K518"
            ],
            "features": [
                {
                    "name": "Rolling Code Calc (20-digit)",
                    "values": [
                        "Excellent (Free)",
                        "Excellent (Token)",
                        "Excellent (Free)"
                    ]
                },
                {
                    "name": "2023+ Protocol Support",
                    "values": [
                        "Good (needs 16+32)",
                        "Excellent",
                        "Excellent"
                    ]
                },
                {
                    "name": "ESCL Emulator Support",
                    "values": [
                        "Yes",
                        "Yes",
                        "Yes (+ Simulation)"
                    ]
                },
                {
                    "name": "Cost Model",
                    "values": [
                        "Annual Sub",
                        "Per-Token",
                        "Annual License"
                    ]
                }
            ]
        }
    ]
}