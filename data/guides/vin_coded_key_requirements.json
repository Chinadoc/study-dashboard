{
    "id": "vin-coded-key-requirements",
    "title": "VIN-Coded Key Requirements: The 2025 Pre-Coding vs Gateway Matrix",
    "make": "Universal",
    "year_start": 2016,
    "year_end": 2025,
    "difficulty": "Reference",
    "estimated_time": "N/A (Reference Document)",
    "last_updated": "2025-12-23",
    "modules": [
        {
            "type": "warning_banner",
            "id": "vin-coded-paradigm-shift",
            "level": "critical",
            "content": "THE PARADIGM SHIFT: The concept of 'programming' a key is now a MISNOMER for modern European vehicles. You are not programming the key to the car - you are ACTIVATING a key that was ALREADY PROGRAMMED to the car BEFORE it left the parts distribution center. The era of the 'universal key programmer' is ENDING."
        },
        {
            "type": "info_callout",
            "id": "vin-coded-two-models",
            "level": "important",
            "content": "TWO MODELS: (1) PRE-CODED: Key must be ordered from factory with immutable security data written to transponder (Mercedes, BMW, Porsche). (2) GATEWAY: Blank keys can theoretically be used, but programming is gated by subscriptions, SGW, and supply chains (Stellantis, Lexus)."
        },
        {
            "type": "reference_table",
            "id": "vin-coded-master-matrix",
            "title": "VIN-Coded Key Requirements Matrix (2025)",
            "headers": [
                "Manufacturer",
                "System",
                "VIN-Ordered (Pre-Coded)?",
                "Dealer Tool Only?",
                "Aftermarket Viable?",
                "Lead Time (2025)",
                "Primary Barrier"
            ],
            "rows": [
                {
                    "cells": [
                        "Mercedes-Benz",
                        "FBS4 (2016+)",
                        "YES (Strict TRP)",
                        "YES (Xentry/DAS)",
                        "NONE (Read-only)",
                        "1-4 Weeks",
                        "Server-side encryption + Hardware logistics"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "BMW",
                        "BDC2 / G-Series",
                        "YES (Factory Burn)",
                        "YES (ISTAP/AIR)",
                        "HIGH RISK (Bench)",
                        "1-2 Weeks",
                        "ISN/BDC Lockout + Data corruption risk"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Audi (VAG)",
                        "MQB-Evo",
                        "YES (Dealer Key)",
                        "YES (ODIS Online)",
                        "LIMITED (Unstable)",
                        "3-10 Days",
                        "FAZIT Database + Component Security"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Porsche",
                        "992 / Taycan",
                        "YES (PPN Required)",
                        "YES (PIWIS III/IV)",
                        "LOW (Complex bench)",
                        "2-5 Weeks",
                        "PPN Online Auth + High-bit encryption"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Land Rover",
                        "2024+ KVM",
                        "YES (Module Replace)",
                        "YES (Pathfinder)",
                        "LIMITED (JLR Doctor)",
                        "1-3 MONTHS",
                        "Module 'Write Once' Logic + Shortages"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "Stellantis",
                        "WiTech / RF Hub",
                        "NO (Blank w/ VIN Sub)",
                        "YES* (SGW Gated)",
                        "HIGH (w/ AutoAuth)",
                        "3-7 Days",
                        "RF Hub Lock / SGW / PIN Codes"
                    ]
                },
                {
                    "cells": [
                        "Lexus/Toyota",
                        "Smart Key",
                        "NO (Allocation)",
                        "NO (Techstream)",
                        "HIGH (Universal)",
                        "6-12 MONTHS (Backlog)",
                        "Hardware supply chain + Allocation rules"
                    ]
                }
            ]
        },
        {
            "type": "warning_banner",
            "id": "vin-coded-mercedes-fbs4",
            "level": "critical",
            "content": "MERCEDES FBS4 (2016+) = DEALER ONLY: An FBS4 key CANNOT be generated in the field. It must be ordered from factory. The key arrives with the specific hash for one of the vehicle's 8 available 'key tracks' already written. The vehicle does not 'learn' the key - the key ALREADY KNOWS the car."
        },
        {
            "type": "info_callout",
            "id": "vin-coded-trp-policy",
            "level": "important",
            "content": "THEFT-RELEVANT PARTS (TRP) POLICY: Mercedes treats keys as TRP. Ordering requires: (1) Government-issued photo ID, (2) Proof of ownership (registration/title) matching ID, (3) Dealer physical inspection. Keys cannot be shipped to unverified addresses - vehicle or owner must be present."
        },
        {
            "type": "warning_banner",
            "id": "vin-coded-bmw-g-series",
            "level": "critical",
            "content": "BMW G-SERIES (G05/G20/G80 etc.) = FACTORY ORDER: Aftermarket cannot easily read ISN from Bosch MG1/MD1 DME without invasive bench unlocking. Primary path is ordering VIN-coded key from BMW PDC. Key arrives pre-burned with vehicle's ISN and next Key ID."
        },
        {
            "type": "info_callout",
            "id": "vin-coded-bmw-activation",
            "level": "tip",
            "content": "BMW G-SERIES KEY ACTIVATION: User-friendly! Hold new remote against 'key coil' icon on steering column + hold Start/Stop button. Physical proximity triggers induction handshake that finalizes rolling code sync. No OBD coding required."
        },
        {
            "type": "warning_banner",
            "id": "vin-coded-bmw-bricking-risk",
            "level": "warning",
            "content": "BMW G-SERIES AFTERMARKET RISK: 'Bricking' a BDC module during attempted unlock = $1,000+ replacement + backorder wait + dealer coding. With risk of ruining module to save $100 on key, many professionals now refuse aftermarket programming on G-Series."
        },
        {
            "type": "warning_banner",
            "id": "vin-coded-audi-mqb-evo",
            "level": "critical",
            "content": "AUDI MQB-EVO (2020+) = FAZIT WALL: VAG moved Component Security (CS) calculation ONLINE. CS bytes no longer readable from cluster/BCM. Programming requires ODIS with live connection to FAZIT database. Dealer orders pre-cut, pre-coded key - FAZIT handles handshake."
        },
        {
            "type": "info_callout",
            "id": "vin-coded-vag-dealer-key",
            "level": "important",
            "content": "VAG 'DEALER KEY' CONCEPT: A blank Megamos AES transponder must be 'locked' with specific CS code (12+ bytes) from vehicle's BCM/Cluster BEFORE it can be taught to car. On MQB-Evo, this happens at factory - aftermarket cannot create dealer keys without ODIS/FAZIT."
        },
        {
            "type": "warning_banner",
            "id": "vin-coded-porsche-ppn",
            "level": "critical",
            "content": "PORSCHE 992/TAYCAN = PPN CONTROLLED: PIWIS must authenticate with Porsche Partner Network (PPN) to retrieve IPAS codes. When key ordered, it's generated as 'Dealer Key' based on VIN record in Stuttgart. Local teach-in is just verification - car queries PPN: 'Is this key ID authorized for my VIN?'"
        },
        {
            "type": "warning_banner",
            "id": "vin-coded-jlr-write-once",
            "level": "critical",
            "content": "LAND ROVER 2024+ = 'WRITE-ONCE' MODULES: In AKL or security-compromised situations, official procedure is REPLACE KVM and often BCM. New modules cannot be put back into 'learning mode' to accept new keys. Prevents theft but means $4,000-$6,000 hardware replacement for lost key."
        },
        {
            "type": "info_callout",
            "id": "vin-coded-jlr-uwb",
            "level": "important",
            "content": "JLR UWB TECHNOLOGY: New L460/L461 keys use Ultra-Wideband for relay attack prevention. Measures time-of-flight to know key is within centimeters of door handle. This specialized hardware is NOT available in generic aftermarket forms."
        },
        {
            "type": "info_callout",
            "id": "vin-coded-stellantis-gateway",
            "level": "important",
            "content": "STELLANTIS = GATEWAY MODEL: Key hardware uses standard Hitag-AES (blanks available), but access is gated by: (1) WiTech VRS subscription (~$35-40/VIN/year), (2) SGW bypass (physical 12+8 connector or AutoAuth digital handshake), (3) RF Hub lockdown on newer Ram/Jeep."
        },
        {
            "type": "warning_banner",
            "id": "vin-coded-stellantis-rf-hub",
            "level": "warning",
            "content": "STELLANTIS RF HUB LOCKDOWN: Once programmed, RF Hub is PERMANENTLY LOCKED to that VIN and cannot be reused. In AKL on 2019+ Ram DT body, RF Hub often enters lockdown preventing ANY new keys even with correct PIN. Fix = replace RF Hub with virgin unit."
        },
        {
            "type": "info_callout",
            "id": "vin-coded-lexus-supply-chain",
            "level": "warning",
            "content": "LEXUS/TOYOTA = SUPPLY CHAIN 'CODING': Not a digital lock - it's physical SCARCITY. 2023-2025 vehicles delivered with ONE smart key. Second key is VIN-allocated. Dealer inputs VIN into 'Second Key Delivery Program' - if VIN's batch isn't released, order is BLOCKED. 6-12 month waits."
        },
        {
            "type": "info_callout",
            "id": "vin-coded-lexus-open-ecosystem",
            "level": "tip",
            "content": "LEXUS SILVER LINING: Technically, Lexus keys are generic blanks. Programming via Techstream with seed codes. Universal keys (Autel IKEY) work on many models. One of the few remaining 'open' ecosystems - if you can GET the hardware."
        },
        {
            "type": "reference_table",
            "id": "vin-coded-aftermarket-quadrants",
            "title": "Aftermarket Service Quadrants",
            "headers": [
                "Quadrant",
                "Manufacturers",
                "Characteristic",
                "Aftermarket Strategy"
            ],
            "rows": [
                {
                    "cells": [
                        "HIGH SEVERITY",
                        "Mercedes, JLR",
                        "Dealer-only hardware + extensive lead times",
                        "Build dealer relationships. Budget 2-6 weeks minimum."
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "FACTORY LOCKED",
                        "BMW, Porsche",
                        "Factory pre-coding + OEM tool dependency",
                        "Order from PDC. G-Series aftermarket = high risk."
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "RESTRICTED GATEWAY",
                        "Audi, Stellantis",
                        "Software barriers + module corruption risk",
                        "AutoAuth for Stellantis. ODIS for VAG. Avoid MQB-Evo AKL."
                    ]
                },
                {
                    "cells": [
                        "LOGISTICAL LOCKOUT",
                        "Lexus/Toyota",
                        "Technical barriers low, hardware unavailable",
                        "Universal keys work. Problem is raw supply."
                    ]
                }
            ]
        },
        {
            "type": "info_callout",
            "id": "vin-coded-nastf-vsp",
            "level": "important",
            "content": "NASTF VSP CREDENTIAL: Vehicle Security Professional (VSP) credential now de facto requirement for independent shops. To order Mercedes TRP parts or Stellantis key codes, technician must be listed in NASTF registry. Every transaction links LSID to VIN - end of anonymous key duplication."
        },
        {
            "type": "warning_banner",
            "id": "vin-coded-conclusion",
            "level": "critical",
            "content": "THE 2025 REALITY: For Mercedes FBS4, BMW G-Series, and Porsche 992/Taycan, the key is no longer a spare part - it is a UNIQUE, FACTORY-ISSUED IDENTITY TOKEN that must be ordered by VIN. This creates near-total OEM dependency, significant lead times, and effectively locks out general aftermarket."
        }
    ]
}