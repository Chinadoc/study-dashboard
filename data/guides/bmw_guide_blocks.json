{
    "id": "bmw-complete-guide",
    "title": "BMW Professional Locksmith Programming Guide",
    "make": "BMW",
    "year_start": 1995,
    "year_end": 2025,
    "difficulty": "Expert",
    "estimated_time": "Varies by system",
    "last_updated": "2025-12-23",
    "modules": [
        {
            "type": "warning_banner",
            "id": "bmw-voltage-warning",
            "level": "critical",
            "content": "NEVER use a standard battery charger during programming. Use a dedicated Power Supply Unit (PSU) maintaining 13.6V-14.2V at 50-70 Amps. Voltage drops below 12.5V during flash writes can permanently brick CAS3+ and FEM modules."
        },
        {
            "type": "warning_banner",
            "id": "bmw-battery-disconnect-warning",
            "level": "critical",
            "content": "DO NOT disconnect battery while ignition is ON. Risk of FRM module corruption requiring bench repair."
        },
        {
            "type": "info_callout",
            "id": "bmw-triangle-of-security",
            "level": "important",
            "content": "BMW security operates on a 'Triangle of Security': Key (Transponder) → Immobilizer (EWS/CAS/FEM/BDC) → Engine (DME/DDE). A mismatch in ANY leg = crank/no-start. The ISN (Individual Serial Number) is the cryptographic glue linking these components."
        },
        {
            "type": "reference_table",
            "id": "bmw-system-evolution",
            "title": "BMW Security System Evolution",
            "headers": [
                "Era",
                "Years",
                "Module",
                "Vehicles",
                "Key Challenge"
            ],
            "rows": [
                {
                    "cells": [
                        "EWS",
                        "1995-2006",
                        "EWS Box",
                        "E46, E39, E53",
                        "Bench read MCU"
                    ],
                    "highlight": false
                },
                {
                    "cells": [
                        "CAS1-2",
                        "2002-2008",
                        "CAS Module",
                        "E65, E60, E90",
                        "OBD or Bench"
                    ],
                    "highlight": false
                },
                {
                    "cells": [
                        "CAS3/3+",
                        "2006-2012",
                        "CAS3 Encrypted",
                        "E-Series",
                        "Flash Downgrade Risk"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "CAS4/4+",
                        "2010-2017",
                        "CAS4 (5M48H)",
                        "F-Series",
                        "Bench Required"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "FEM/BDC",
                        "2012-2019",
                        "Body Controller",
                        "F30, F15, X3",
                        "Preprocessing Required"
                    ],
                    "highlight": true
                },
                {
                    "cells": [
                        "BDC2/3",
                        "2018-Present",
                        "G-Series BDC",
                        "G20, G05",
                        "Cloud Calculation"
                    ],
                    "highlight": true
                }
            ]
        },
        {
            "type": "reference_table",
            "id": "bmw-fcc-cross-reference",
            "title": "BMW FCC ID & Transponder Cross-Reference",
            "headers": [
                "Chassis",
                "System",
                "Key Style",
                "Frequency",
                "FCC ID",
                "Chip"
            ],
            "rows": [
                {
                    "cells": [
                        "E90/E60",
                        "CAS3",
                        "Smart (CA)",
                        "315 MHz",
                        "KR55WK49127",
                        "ID46"
                    ]
                },
                {
                    "cells": [
                        "E90/E60",
                        "CAS3",
                        "Slot (Non-CA)",
                        "315 MHz",
                        "KR55WK49123",
                        "ID46"
                    ]
                },
                {
                    "cells": [
                        "F10/F01",
                        "CAS4",
                        "Smart 4-Btn",
                        "315 MHz",
                        "YGOHUF5662",
                        "ID49"
                    ]
                },
                {
                    "cells": [
                        "F10/F01",
                        "CAS4",
                        "Smart 4-Btn",
                        "434 MHz",
                        "YGOHUF5767",
                        "ID49"
                    ]
                },
                {
                    "cells": [
                        "F15/F30",
                        "FEM",
                        "Smart 4-Btn",
                        "315 MHz",
                        "YGOHUF5662",
                        "ID49"
                    ]
                },
                {
                    "cells": [
                        "F15/F30",
                        "FEM",
                        "Smart 4-Btn",
                        "434 MHz",
                        "NBGIDGNG1",
                        "ID49"
                    ]
                },
                {
                    "cells": [
                        "G20/G05",
                        "BDC3",
                        "Blade Smart",
                        "434 MHz",
                        "N5F-ID21A",
                        "NCF2951"
                    ]
                }
            ]
        },
        {
            "type": "reference_table",
            "id": "bmw-transponder-evolution",
            "title": "Transponder Chip Evolution",
            "headers": [
                "Chip",
                "ID",
                "Era",
                "Encryption",
                "Notes"
            ],
            "rows": [
                {
                    "cells": [
                        "PCF7935",
                        "ID44",
                        "EWS",
                        "40-bit",
                        "Rewriteable, robust"
                    ]
                },
                {
                    "cells": [
                        "PCF7945",
                        "ID46",
                        "CAS1-3",
                        "Hi-Tag 2",
                        "Common, widely available"
                    ]
                },
                {
                    "cells": [
                        "PCF7953",
                        "ID49",
                        "CAS4/FEM",
                        "Hi-Tag Pro",
                        "128-bit AES"
                    ]
                },
                {
                    "cells": [
                        "NCF2951",
                        "ID49+",
                        "G-Series",
                        "AES-128",
                        "Advanced, dealer-level"
                    ]
                }
            ]
        },
        {
            "type": "tool_checklist",
            "id": "bmw-essential-tools",
            "title": "Essential BMW Programming Tools",
            "items": [
                {
                    "name": "Power Supply Unit (13.6V-14.2V, 50A+)",
                    "required": true,
                    "notes": "MANDATORY for all programming"
                },
                {
                    "name": "Autel MaxiIM IM608 Pro II",
                    "required": false,
                    "notes": "Best guided interface, G-BOX3 recommended"
                },
                {
                    "name": "Xhorse VVDI2 / Key Tool Plus",
                    "required": false,
                    "notes": "Legendary for CAS1-3 stability"
                },
                {
                    "name": "Yanhua Mini ACDP",
                    "required": false,
                    "notes": "Solder-free king for FEM/BDC and CAS4"
                },
                {
                    "name": "AK90+",
                    "required": false,
                    "notes": "$40 tool, best for EWS3 bench reading"
                },
                {
                    "name": "G-BOX3 (Autel)",
                    "required": false,
                    "notes": "Required for fast CAS4 password calculation"
                },
                {
                    "name": "Lishi HU92 (Twin Lifter)",
                    "required": true,
                    "notes": "For E-Series locks"
                },
                {
                    "name": "Lishi HU100R",
                    "required": true,
                    "notes": "For F/G-Series locks (REVERSE of GM HU100)"
                }
            ]
        },
        {
            "type": "decision_tree",
            "id": "bmw-tool-decision-matrix",
            "title": "Tool Selection Decision Matrix",
            "question": "What is your scenario?",
            "branches": [
                {
                    "condition": "EWS 3/4 All Keys Lost",
                    "action": "Use AK90+ (cheaper, faster than $3K tools)"
                },
                {
                    "condition": "CAS 3+ Add Key",
                    "action": "Use Autel IM608 (superior guided mode)"
                },
                {
                    "condition": "CAS 4/4+ All Keys Lost",
                    "action": "Use Yanhua ACDP (no soldering risk)"
                },
                {
                    "condition": "FEM/BDC All Keys Lost",
                    "action": "Use Yanhua ACDP (less disassembly required)"
                },
                {
                    "condition": "G-Series Add Key",
                    "action": "Use Autel (requires $120 subscription)"
                },
                {
                    "condition": "FRM Repair",
                    "action": "Use VVDI Prog (easy $150+ profit job)"
                }
            ]
        },
        {
            "type": "step_group",
            "id": "bmw-ews3-akl-procedure",
            "title": "Procedure: EWS3 All Keys Lost using AK90+",
            "estimated_time": "20-30 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "Extract the EWS3 module from under the dash"
                },
                {
                    "number": 2,
                    "text": "Open the case and identify the Motorola MCU (0D46J/2D47J)",
                    "tip": "Use fiberglass pen or acetone to clean varnish off pins. Failure causes read errors."
                },
                {
                    "number": 3,
                    "text": "Connect AK90 ribbon cable to MCU",
                    "warning": "Align red dot on connector with dimple (Pin 1) on MCU"
                },
                {
                    "number": 4,
                    "text": "Launch software, select MCU type, click 'Read EWS'",
                    "tip": "Tool beeps if connection is good. Save the .bin file."
                },
                {
                    "number": 5,
                    "text": "Place new PCF7935 chip in AK90 slot"
                },
                {
                    "number": 6,
                    "text": "Select an unused key slot (e.g., Key 5) and click 'Write Key'"
                },
                {
                    "number": 7,
                    "text": "Reinstall EWS module and test start",
                    "tip": "No diagnostic sync needed for EWS3 unless DME-EWS rolling code was corrupted"
                }
            ]
        },
        {
            "type": "step_group",
            "id": "bmw-cas3plus-add-key-procedure",
            "title": "Procedure: CAS3+ Add Key via OBD (Flash Downgrade)",
            "estimated_time": "15-25 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "Connect PSU set to 13.8V",
                    "warning": "CRITICAL - voltage must remain stable throughout"
                },
                {
                    "number": 2,
                    "text": "Connect Autel IM608 → IMMO → BMW → Smart Selection",
                    "tip": "Tool identifies CAS3+ (ISTAP)"
                },
                {
                    "number": 3,
                    "text": "Select 'Key Learning' - tool warns 'Flash Downgrade Required'",
                    "warning": "This process takes ~10 minutes. Do NOT open doors or touch switches."
                },
                {
                    "number": 4,
                    "text": "Wait for flash completion (CAS firmware erased and rewritten)"
                },
                {
                    "number": 5,
                    "text": "Insert working key when prompted (to read auth)"
                },
                {
                    "number": 6,
                    "text": "Insert new blank key when prompted"
                },
                {
                    "number": 7,
                    "text": "Verify start. CAS remains in 'downgraded' state (functional)",
                    "tip": "Original flash is NOT restored automatically"
                }
            ]
        },
        {
            "type": "step_group",
            "id": "bmw-cas4plus-akl-procedure",
            "title": "Procedure: CAS4+ All Keys Lost (Bench - ACDP)",
            "estimated_time": "30-45 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "Remove CAS4 module from vehicle"
                },
                {
                    "number": 2,
                    "text": "Install ACDP CAS4 interface board over the PCB",
                    "tip": "Tighten studs to ensure pogo pins make contact"
                },
                {
                    "number": 3,
                    "text": "Select 'CAS4+ (5M48H)' and read P-Flash and D-Flash",
                    "tip": "Tool automatically decrypts the data"
                },
                {
                    "number": 4,
                    "text": "Note ISN and VIN displayed. Tool creates key file."
                },
                {
                    "number": 5,
                    "text": "Place new key in ACDP coil, select 'Generate Dealer Key', load key file"
                },
                {
                    "number": 6,
                    "text": "Reinstall CAS4 in vehicle"
                },
                {
                    "number": 7,
                    "text": "Hold new key to steering column coil and press Start",
                    "tip": "Key will sync automatically"
                }
            ]
        },
        {
            "type": "step_group",
            "id": "bmw-fem-bdc-preprocessing-procedure",
            "title": "Procedure: FEM/BDC Key Learning with Preprocessing",
            "estimated_time": "45-60 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "Connect OBD and read 'Coding Data'",
                    "warning": "BACKUP THIS DATA - controls windows, headlights, etc."
                },
                {
                    "number": 2,
                    "text": "Remove FEM module from vehicle and open shell"
                },
                {
                    "number": 3,
                    "text": "Attach ACDP Module 2 clip to 95128/95256 EEPROM chip",
                    "tip": "Clean conformal coating (varnish) first - bad reads are common cause of failure"
                },
                {
                    "number": 4,
                    "text": "Read EEPROM → Tool saves 'Original_EEPROM.bin'"
                },
                {
                    "number": 5,
                    "text": "Tool generates 'Service_EEPROM.bin' → Write to chip"
                },
                {
                    "number": 6,
                    "text": "Reconnect FEM to platform/car and perform 'Program ECU' (flash)",
                    "warning": "The Service file allows tool to bypass security during flash"
                },
                {
                    "number": 7,
                    "text": "Attach clip again and write 'Original_EEPROM.bin' back to chip"
                },
                {
                    "number": 8,
                    "text": "Connect via OBD - FEM is now unlocked. Use 'Learn Key'."
                },
                {
                    "number": 9,
                    "text": "Restore 'Coding Data' saved in Step 1 to fix windows/lights"
                }
            ]
        },
        {
            "type": "warning_banner",
            "id": "bmw-g-series-warning",
            "level": "warning",
            "content": "G-Series (2019+) BDC3 All Keys Lost: No easy OBD solution exists for 2021+ vehicles. Bosch MD1/MG1 ECUs produced after June 2020 have 'Bench Lock' preventing ISN reading. DME may need to be sent to specialist tuners (FEMTO Finland) or dealer key ordered."
        },
        {
            "type": "step_group",
            "id": "bmw-hu92-lishi-procedure",
            "title": "Procedure: HU92 Lock Picking & Decoding",
            "estimated_time": "5-15 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "Insert HU92 Lishi (Twin Lifter recommended) into lock"
                },
                {
                    "number": 2,
                    "text": "Pick the lock using light tension",
                    "warning": "Twin Lifter allows more independent wafer control"
                },
                {
                    "number": 3,
                    "text": "Once picked, decode the wafers",
                    "warning": "CRITICAL: Twin Lifter = decode in SAME direction you picked. Single Lifter = decode in OPPOSITE direction. This is #1 cause of miscut HU92 keys."
                }
            ]
        },
        {
            "type": "step_group",
            "id": "bmw-frm-repair-procedure",
            "title": "Procedure: FRM3 Module Repair",
            "estimated_time": "30 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "Symptoms: Windows dead, indicators dead, headlights stuck on"
                },
                {
                    "number": 2,
                    "text": "Connect VVDI Prog / ACDP to MC9S12 chip"
                },
                {
                    "number": 3,
                    "text": "Read D-Flash (will look empty/corrupt)"
                },
                {
                    "number": 4,
                    "text": "Use tool's 'Partition Repair' or 'Write Partition' function",
                    "tip": "This reallocates memory sectors. EEPROM data usually reappears - just the partition table was lost."
                },
                {
                    "number": 5,
                    "text": "Reinstall - no coding required after fix",
                    "tip": "Easy $150-300 profit job, 30 mins work"
                }
            ]
        },
        {
            "type": "step_group",
            "id": "bmw-elv-emulation-procedure",
            "title": "Procedure: ELV (Steering Lock) Emulation",
            "estimated_time": "15 mins",
            "steps": [
                {
                    "number": 1,
                    "text": "Symptoms: E90/E60 shows Error A0AA, steering lock jammed, no crank"
                },
                {
                    "number": 2,
                    "text": "Buy $20 'ELV Emulator' plug"
                },
                {
                    "number": 3,
                    "text": "Disconnect ELV connector on steering column"
                },
                {
                    "number": 4,
                    "text": "Plug in emulator - CAS now thinks lock is open"
                },
                {
                    "number": 5,
                    "text": "Reset ELV counter in CAS using scanner"
                },
                {
                    "number": 6,
                    "text": "Car starts normally"
                }
            ]
        },
        {
            "type": "pricing_matrix",
            "id": "bmw-pricing-guidelines",
            "title": "US Market Pricing Guidelines",
            "rows": [
                {
                    "scenario": "Spare Key (E-Series/F-Series)",
                    "price_range": "$250 - $350"
                },
                {
                    "scenario": "All Keys Lost (CAS3)",
                    "price_range": "$450 - $600"
                },
                {
                    "scenario": "All Keys Lost (FEM/BDC)",
                    "price_range": "$600 - $900",
                    "notes": "Labor intensive - preprocessing required"
                },
                {
                    "scenario": "FRM Repair",
                    "price_range": "$200 - $300",
                    "notes": "30 mins work, high margin"
                },
                {
                    "scenario": "G-Series AKL",
                    "price_range": "$800+",
                    "notes": "Often requires DME unlocking or dealer key"
                }
            ]
        },
        {
            "type": "comparison_table",
            "id": "bmw-tool-comparison",
            "title": "Tool Comparison Matrix",
            "items": [
                "Autel IM608",
                "VVDI2/Key Tool Plus",
                "Yanhua ACDP",
                "AK90+"
            ],
            "features": [
                {
                    "name": "EWS 3/4 AKL",
                    "values": [
                        "Good",
                        "Good",
                        "N/A",
                        "Excellent ($40)"
                    ]
                },
                {
                    "name": "CAS 3+ Add Key",
                    "values": [
                        "Excellent",
                        "Excellent",
                        "Good",
                        "N/A"
                    ]
                },
                {
                    "name": "CAS 4/4+ AKL",
                    "values": [
                        "Good",
                        "Good",
                        "Excellent (no solder)",
                        "N/A"
                    ]
                },
                {
                    "name": "FEM/BDC AKL",
                    "values": [
                        "Good",
                        "Good",
                        "Excellent",
                        "N/A"
                    ]
                },
                {
                    "name": "G-Series",
                    "values": [
                        "Yes ($120 sub)",
                        "Limited",
                        "Limited",
                        "N/A"
                    ]
                },
                {
                    "name": "FRM Repair",
                    "values": [
                        "With XP400",
                        "Excellent",
                        "With Module 8",
                        "N/A"
                    ]
                }
            ]
        }
    ]
}