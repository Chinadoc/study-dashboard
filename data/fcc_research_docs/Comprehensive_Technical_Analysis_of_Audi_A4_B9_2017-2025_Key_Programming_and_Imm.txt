Comprehensive Technical Analysis of Audi A4 B9 (2017-2025) Key Programming and Immobilizer Architectures
The Audi A4 B9 platform, introduced as the successor to the long-standing B8, represents a watershed moment in the evolution of Audi’s vehicle security and electronic architecture. Built on the Modularer Längsbaukasten (MLB Evo) platform, the A4 B9—produced between 2017 and 2025—integrates a highly sophisticated immobilizer system that deviates significantly from previous generations. For the automotive locksmith, this platform demands a transition from traditional diagnostic programming to high-level bench-top data extraction and cloud-based cryptographic calculation. The complexity of the B9 platform is not merely in its encryption, but in its decentralized security architecture, where the Body Control Module 2 (BCM2/J393) serves as the primary gateway for immobilizer authentication, yet interacts seamlessly with the Engine Control Unit (ECU), Transmission Control Unit (TCU), and the electronic steering column lock (ELV) to form a unified Component Security (CS) chain.1
Immobilizer Generation and Transponder Matrix
The transition from the 2017 launch through the 2025 end-of-cycle involves two distinct phases of immobilizer technology. While early B9 models utilized a logic derived from the 5th Generation Immobilizer (IMMO 5) system, the facelift models (2020 and newer) transitioned into a more robust MLB Evo paradigm that requires different hardware for data acquisition.2 Identifying the correct transponder and part number is the first critical step in ensuring system compatibility and avoiding the "Key Not Valid" warning on the Virtual Cockpit.6
Technical Specification Matrix (2017–2025)
The following matrix delineates the evolution of key hardware across the B9 production span. It is vital to distinguish between "Add Key" capabilities and "All Keys Lost" (AKL) requirements for each hardware revision.3
Model Years
	Immobilizer Generation
	Transponder / Chip Type
	Standard FCC ID
	Common OEM Part Numbers
	2017 – 2019
	IMMO 5 (Pre-Facelift)
	Megamos AES (MQB48)
	CWTWB1G767
	8W0 959 754 G / A / K
	2020 – 2022
	MLB Evo (Facelift)
	NXP AES (MLB Platform)
	IYZMS1
	8W0 959 754 T / AL / BD
	2023 – 2025
	MLB Evo (Enhanced)
	NXP AES (Encrypted MLB)
	IYZMS1
	8W0 959 754 BK / CU / T
	The distinction between the 2017–2019 and 2020–2025 models is not merely physical. In the earlier models, the Megamos AES chip (MQB48) is the standard. Although the A4 is an MLB vehicle, the locksmith industry refers to this as MQB48 because it shares the same cryptographic logic as the MQB-platform Volkswagen Golf VII.1 Starting in 2020, Audi implemented a "locked" BCM2 architecture that restricts standard OBD-II read access, making it nearly impossible to retrieve immobilizer data without specialized adapters or cloud-based server calculations.10
Transponder Logic and Frequency Variations
The B9 platform utilizes a proximity (smart key) system as standard, where the transponder is integrated into a multi-function PCBA. The frequency of the remote and proximity functions varies by region: 315 MHz for North American markets, 433 MHz for European and Asian markets, and 868 MHz for specific high-security European regions.8 A critical insight for locksmiths is that while the physical blades (HU162T) are identical across these years, the internal hardware of an MQB48 key is physically incompatible with an MLB Evo vehicle. Using a 2018-style key on a 2021 vehicle will result in a failure during the "Dealer Key" generation phase of the programming software.1
All Keys Lost (AKL) Technical Procedures
The "All Keys Lost" scenario on an Audi A4 B9 is a high-level technical operation that requires the extraction of the vehicle's unique Component Security (CS) bytes and Power Class from the BCM2. Because the B9 lacks a traditional mechanical ignition switch, the locksmith cannot simply "turn on" the ignition to wake up the modules for OBD communication. The system must be manually awakened or bypassed through direct module interfacing.1
Numbered AKL Step-by-Step Workflow
For a 2017–2025 Audi A4, the AKL procedure generally follows this six-stage protocol 1:
1. Vehicle Entry and Decoding: The technician gains entry to the vehicle using a Lishi HU162T (9 or 10-cut) tool. This allows for decoding the mechanical lock code to cut a new emergency blade and enables access to the interior to reach the OBD-II port and the BCM2.1
2. BCM2 Identification and Extraction: The BCM2 module (J393) must be physically removed from its location in the rear left of the luggage compartment. For encrypted or "locked" modules, this is a non-negotiable step to read the internal memory directly from the circuit board.18
3. Bench Data Extraction: The module is connected to a programmer (e.g., Autel XP400Pro, Xhorse VVDI Prog, or Yanhua ACDP) using a dedicated solderless adapter. The software reads the D-Flash and P-Flash data. This data contains the encrypted immobilizer values.4
4. Immobilizer Data Calculation: The extracted binary file is uploaded to the tool manufacturer’s server (Xhorse or Autel cloud). The server decrypts the file to provide the 16-byte CS code, the 32-bit PIN, and the Power Class. For 2020+ MLB models, this step is mandatory as the local software cannot decrypt the newer BCM2 versions.3
5. Dealer Key Generation: A blank, uninitialized smart key is placed in the programmer’s induction coil. The software uses the calculated CS and PIN to "pre-code" the key, transforming it into a "Dealer Key" that the vehicle’s BCM2 will recognize as its own.1
6. OBD Key Learning: The BCM2 is reinstalled in the vehicle. The programmer is connected to the OBD-II port to initiate the "Key Learning" function. The new dealer key is held against the emergency start induction coil (located in the center console or near the steering column) to synchronize the rolling code and finalize the programming.7
Tool Compatibility and Effectiveness
Professional locksmithing tools vary in their effectiveness for the B9 platform. The selection of hardware often depends on whether the technician prefers a "solderless" approach or an "online-only" workflow.3
Tooling System
	2017–2019 (MQB48) Capability
	2020–2025 (MLB Evo) Capability
	Online/Geko Requirement
	Autel IM608 Pro II
	Excellent (G-Box3 required)
	High (Requires XP400Pro)
	Cloud calculation for CS
	Xhorse Key Tool Plus
	Excellent (BCM2 Adapter)
	Superior (MLB Tool required)
	Calculation tokens required
	Yanhua ACDP
	Superior (Module 29)
	Excellent (Module 34)
	ICP Bench method
	ODIS Service
	Full (Factory Standard)
	Full (Factory Standard)
	Mandatory Geko/VSC
	The Autel IM608 is widely favored for its user-friendly interface during the OBD learning stage, while the Xhorse ecosystem—specifically the new MLB Tool—is currently considered the market leader for 2020–2025 models due to its ability to handle MLB Evo keys with high stability.11
Time to Complete Benchmark
An experienced technician can complete an AKL procedure on a B9 model in approximately 60 to 90 minutes. This includes 20 minutes for trim removal and BCM2 extraction, 30 minutes for bench-top data reading and cloud calculation, and 15 minutes for final OBD-II synchronization.25 In contrast, an Audi dealership often requires 3 to 5 business days to order a pre-coded key from Germany and an additional hour for online synchronization via ODIS.1
Add Key Procedure and OBD-II Viability
Adding a spare key when a working key is present is inherently less risky but still requires a nuanced understanding of the security gateway. For the majority of Audi A4 B9 models, "Add Key" cannot be performed entirely via the OBD-II port if the tool does not have a "working key data collection" feature.1
OBD-II Constraints and Gateways
In models produced between 2017 and 2018, some advanced tools can extract the CS data through the OBD-II port if they can exploit a vulnerability in the gateway (J533) module. However, for 2019 and newer models, Audi implemented a "Diagnostic Firewall" or Security Gateway (SFD) that blocks unauthorized write commands.25
* Can it be done via OBD-II? For 2017-2019 models, it is occasionally possible, but bench work on the BCM2 is the most reliable method. For 2020-2025 MLB Evo models, a bench read or specialized "Key Data Collection" from the original key using a tool like the Xhorse MLB Tool is required.10
* Dealer Authorization: While independent tools use cloud-based "hacks" to calculate CS, the official factory method requires ODIS and a Geko login. For 2024 and 2025 models, the SFD2 system is increasingly difficult to bypass, and locksmiths may need to use authorized third-party SFD unlocking services or NASTF credentials.27
The "Add Key" procedure generally mirrors the AKL procedure, but the technician can often use the "Working Key" to facilitate the data collection process, avoiding the need to remove the BCM2 in some specific tool workflows.11
Hardware Access: BCM2/J393 Removal and Bench Interfacing
The BCM2 is the "brain" of the Audi A4 B9 immobilizer system. It is responsible for the proximity authorization, the steering lock release, and the initial handshake with the engine ECU. Understanding its physical location and the steps for removal is essential for any bench-top work.18
Location and Disassembly Steps
The BCM2 (also identified by part numbers such as 8W0 907 064) is consistently located in the rear left quadrant of the vehicle. Accessing it involves several steps of interior disassembly 18:
1. Trunk/Boot Preparation: Open the trunk and remove the floor mat and the left-side luggage compartment cover.
2. Trim Panel Removal: For the Sedan, the left-side wall carpet must be pulled back. For the Avant (wagon), the D-pillar trim and the upper luggage compartment side trim must be removed using plastic pry tools to avoid damage.19
3. Module Identification: The BCM2 is housed in a black plastic bracket. It will have three large connectors (usually Black, Blue, and Brown).15
4. Battery Isolation: It is critical to disconnect the vehicle’s negative battery terminal before unplugging the BCM2. Failure to do so can cause a "Component Protection" fault or corrupt the module's EEPROM.29
5. Module Extraction: Depress the plastic tabs on the bracket and slide the module out.
Bench Connection and Pinout Logic
Once the BCM2 is on the bench, the technician must interface with the internal MCU (Renesas V850 or NEC 35xx). Modern adapters from Xhorse and Autel have replaced the need for complex soldering by using "Pogo-pin" interface boards that clamp onto the module.15
* Pin Diagram Basics: The connection typically requires six points: VCC (  ), GND, RESET, FLMD0, and the two data lines (Tx/Rx).
* Adapter Alignment: If using the Yanhua ACDP Module 29, the interface board must be aligned with the physical registration points (anchors D1, D2, and D3) on the BCM2 PCB. Incorrect alignment will result in a "Data Verification Failed" error during the read process.15
* Wait Times: When reading an encrypted BCM2, the programmer may take 3 to 10 minutes to "decrypt" the chip access before the binary data can be extracted.15
Critical Warnings and Troubleshooting
Key programming for the Audi B9 is a high-stakes environment. A single error during the BCM2 read or the "Dealer Key" generation can lead to a "bricked" module or a vehicle that recognizes the key but refuses to start.7
The "Key Not Valid" Warning
The most common failure after a seemingly successful programming session is the "Key Not Valid" or "No Key Detected" message on the instrument cluster. This is often caused by 6:
   * Capacitor Failure: For Xhorse MLB keys, the technician must remove two    capacitors from the key's PCB to read the data. If these capacitors are not resoldered correctly, the key's induction coil will not function, and the vehicle will not "see" the key during the emergency start process.11
   * Mismatched Power Class: If the locksmith uses a generic MQB48 chip that hasn't been properly pre-coded with the vehicle’s specific Power Class, the ignition will turn on, but the ECU will block the starter motor.14
   * Frequency Bleed: Using a 433 MHz key in a 315 MHz vehicle. While some tools will allow the key to "learn" to the immobilizer, the remote and proximity functions will never work.1
Dealer-Only Scenarios
Despite the power of aftermarket tools, some situations strictly require a dealership or an authorized ODIS Online session 1:
      1. New BCM2 Replacement: If the original BCM2 is physically destroyed (e.g., by water damage), an aftermarket tool cannot easily perform "Component Protection" removal. Only an online Audi SVM (Software Version Management) session can authorize a brand-new module.14
      2. 2024+ SFD2 Security: Newer B9.5 models feature the SFD2 (Vehicle Diagnostic Protection 2) protocol, which requires a dynamic token generated by Audi's servers for every single write command. While some independent tools are gaining SFD access, it remains a major barrier for the average locksmith.27
      3. Keyless Go Failures: If the "Add Key" procedure is completed but the key only works when held to the emergency coil (and not in your pocket), there is likely a fault in the Keyless Go antenna system or a mismatch in the key's PCBA revision. This often requires dealer-level diagnostics to reset the comfort module adaptation channels.7
Advanced Technical Insight: The MLB Evo Shift (2020-2025)
The most significant evolution in B9 key programming occurred with the 2020 facelift. The shift to a "locked" BCM2 processor was intended to prevent the "OBD hacking" that had become common in the 2017-2018 models. For locksmiths, this meant that the traditional method of reading the BCM2 via the OBD port was permanently disabled by the factory.10
The Xhorse MLB Tool Advantage
The release of the Xhorse VVDI MLB Tool (and its competitors like the KYDZ MLB Tool) has changed the landscape for these newer models. This tool uses a proprietary method to collect immobilizer data directly from an existing working key without requiring access to the BCM2 or the vehicle.3
      * Wireless Data Collection: The tool's integrated 22k reader can "sniff" the communication between the working key and the tool to extract the security bytes.
      * No Chip Removal: Unlike older methods that required desoldering the BCM2 processor, this method only requires disassembling the key shell.
      * Rewriteable Key IDs: Specialized VVDI MLB keys allow for unlimited reuse, a massive advantage for locksmiths managing inventory for the 2020-2025 model years.3
However, for All Keys Lost (AKL) on these 2020+ models, the technician still faces the challenge of retrieving data from a vehicle where no working key is available. In these cases, the bench-top read of the BCM2 remains the only viable path for the independent locksmith, provided the tool's server supports the specific MCU mask set of the 2020+ BCM2.3
Component Security and Cryptographic Synchronization
The B9's security is predicated on a synchronized "Component Security" (CS) string that is shared across multiple modules. The CS is a 16-byte hex code that serves as a digital handshake. When a locksmith "makes a dealer key," they are essentially hard-coding this 16-byte string into the transponder’s secure memory block.2
The Role of the Power Class
A frequent point of confusion is the "Power Class" byte. This is a single byte (   through   ) that identifies the engine's performance tier (e.g., A4 2.0T vs. S4 3.0T). If the locksmith uses a key with the correct CS but the wrong Power Class, the BCM2 will accept the key, but the Engine ECU will reject the start command. This is a common issue when using "Universal" keys that have not been properly initialized for the specific A4 B9 sub-model.14
Verification of BCM2 Recovery Files
During the "Unlock BCM2" process required by tools like Abrites or Autel, the software actually modifies the module's firmware to allow the data extraction. This is a high-risk phase. Professionals always ensure that the software has generated a .bin backup file before clicking "Start".14 If the power is interrupted or the OBD cable is bumped during this process, the BCM2 can be "bricked" (rendered non-functional), and only the backup file—combined with a bench-top programmer—can restore it to its original state.14
Economic and Operational Conclusions
The Audi A4 B9 platform represents one of the most profitable yet technically demanding segments of modern automotive locksmithing. The shift from 2017's IMMO 5 to the 2025-era MLB Evo systems has elevated the required skill set from basic diagnostic operation to advanced electronics bench work.
For a professional operation, the following strategic investments are recommended to ensure    coverage of the A4 B9 range:
      1. Hardware: An Autel IM608 Pro II for OBD learning and an Xhorse Key Tool Plus with the dedicated MLB Tool adapter for 2020+ models.4
      2. Adapters: Solderless BCM2 interface boards are mandatory. They reduce the time of BCM2 work from one hour to 15 minutes and eliminate the risk of thermal damage to the PCB.4
      3. Credentials: Registration with NASTF/VSC is increasingly important for 2024 and 2025 models where SFD2 may block even the most advanced aftermarket tools.27
      4. Inventory: Maintain a stock of both MQB48 (2017-2019) and MLB-specific (2020-2025) smart keys. Using the wrong hardware revision is the leading cause of "Key Not Valid" callbacks.3
By understanding the decentralized nature of the B9 immobilizer and the critical role of the BCM2 located in the rear trunk, locksmiths can provide a service that significantly undercuts the dealership's turnaround time while maintaining the highest levels of vehicle security integrity.1
Works cited
      1. Key fob question : r/AudiA4B9 - Reddit, accessed January 27, 2026, https://www.reddit.com/r/AudiA4B9/comments/1lnfpu9/key_fob_question/
      2. Audi A4 – 5th Gen IMMO Key Programming | BCM2 Coding & Dealer Key Preparation, accessed January 27, 2026, https://www.youtube.com/watch?v=1WcHpl9upYg
      3. Xhorse - VVDI MLB Tool VW Audi Key Adapter - Works with VVDI2 ..., accessed January 27, 2026, https://www.uhs-hardware.com/products/xhorse-vvdi-mlb-tool-for-vw-audi-key-adapter-works-with-vvdi2-vvdi-key-tool-plus
      4. How to use AUDI BCM2 Adapter with VVDI 2 & VVDI PROG | Xhorse - YouTube, accessed January 27, 2026, https://www.youtube.com/watch?v=6o14L4cTedI
      5. Autel Adds 2024/2025 IMMO & Key Programming Functionality | Autel, accessed January 27, 2026, https://autel.us/autel-adds-24-25-immo-key/
      6. Everything You Need to Know About the VW Key Immobilizer Chip – Real-World Testing of the 5PCS ID48 Glass Chip for Golf, A4, Polo & More - AliExpress, accessed January 27, 2026, https://www.aliexpress.com/p/wiki/article.html?keywords=vw-key-immobilizer-chip_1005003645693067
      7. How to Resync B9 Keyfob : r/Audi - Reddit, accessed January 27, 2026, https://www.reddit.com/r/Audi/comments/1e0wdvl/how_to_resync_b9_keyfob/
      8. Xhorse VVDI MQB48 Transponder Chip Car Key Chip for VW Volkswagen Fiat Audi Car Key MQB Chip MQB 48 Chip - AliExpress, accessed January 27, 2026, https://www.aliexpress.com/item/1005006155552967.html
      9. for Audi A4 A5 A6 A7 Q5 RS4 S5 Remote Key Fob 315MHz FCC ID: 8T0 959 754C | eBay, accessed January 27, 2026, https://www.ebay.com/itm/274606649973
      10. Xhorse VVDI MQB48 Adapter No Need to Disassemble Dashboard for VW Audi Key Reading Work with MLB Tool/VVDI2/PAD Plus Programmer - AliExpress, accessed January 27, 2026, https://www.aliexpress.com/item/1005008589882672.html
      11. Xhorse VVDI MLB Tool To Add Key for VW Audi Porsche VAG Group XDMLB0EN - ABKEYS, accessed January 27, 2026, https://abkeys.com/products/xhorse-vvdi-mlb-tool-to-add-key-for-vw-audi-porsche-vag-group-xdmlb0en
      12. Xhorse VVDI MLB Tool VW Audi Key Adapter - Works With VVDI2 and VVDI Key Tool Plus - Key Innovations, accessed January 27, 2026, https://keyinnovations.com/xhorse-vvdi-mlb-tool-vw-audi-key-adapter-works-with-vvdi2-vvdi-key-tool-plus-pre-order/
      13. Audi A4 B9 2017 Matrix Retrofit - Reddit, accessed January 27, 2026, https://www.reddit.com/r/Audi/comments/aimmkk/audi_a4_b9_2017_matrix_retrofit/
      14. THE SECRETS OF LOCKED AND UNLOCKED BCM2 MODULES - Abrites USA, accessed January 27, 2026, https://www.abritesusa.com/the-secrets-of-locked-and-unlocked-bcm2-modules
      15. Yanhua ACDP read IMMO data for Audi A4/A5/Q5 (BCM2 encrypted ..., accessed January 27, 2026, https://medium.com/@obd2eshopcom/yanhua-acdp-read-immo-data-for-audi-a4-a5-q5-bcm2-encrypted-by-icp-1695a5d0f305
      16. Xhorse MLB TOOL - MQB Feature: MQB48 Add Key | KeyShop-Online - YouTube, accessed January 27, 2026, https://www.youtube.com/watch?v=HeeC2kfhmRE
      17. How to Use Xhorse MLB Tool with Key Tool Plus | Complete Step-by-Step Guide - YouTube, accessed January 27, 2026, https://www.youtube.com/watch?v=jL_fhrw96bk
      18. J949 module location A4 2020 : r/Audi - Reddit, accessed January 27, 2026, https://www.reddit.com/r/Audi/comments/1jy34ev/j949_module_location_a4_2020/
      19. Audi A4 Tailgate Panel And Spoiler Removal - YouTube, accessed January 27, 2026, https://www.youtube.com/watch?v=jLHLFQ6a2V4
      20. Tailgate Trim Panel Removal Audi Q5 B9 - YouTube, accessed January 27, 2026, https://www.youtube.com/watch?v=BPxQt_GnsPk
      21. How to use AUDI BCM2 Adapter with VVDI 2 & VVDI PROG | Xhorse - YouTube, accessed January 27, 2026, https://www.youtube.com/watch?v=rL4O87IlaT8
      22. Read BCM2 Module Using Multi-PROG No Soldering | Xhorse - YouTube, accessed January 27, 2026, https://www.youtube.com/watch?v=mdknAi0zl6Q
      23. HOW TO PROGRAM A KEY FOR 2009 - 2014 AUDI A4 AKL USING AUTEL IM508 & XP400, accessed January 27, 2026, https://www.youtube.com/watch?v=KsE6-GCKtZI
      24. Xhorse VVDI MLB TOOL MQB48 Adapter- Add MQB48 Key without Removing Dash, accessed January 27, 2026, https://www.youtube.com/watch?v=0LbpyArrOU0
      25. Audi Key Replacement and Programming: Your Complete Guide - DML Locksmith Services, accessed January 27, 2026, https://dmllocksmith.com/post/audi-key-replacement-and-programming-your-complete-guide/
      26. Kingbolen K10 Elite Review: The Ultimate Key Programming Tool for Modern Vehicle Diagnostics - AliExpress, accessed January 27, 2026, https://www.aliexpress.com/p/wiki/article.html?keywords=kingbolen-k10-elite_1005007141973337
      27. Volkswagen of America | Keycode Instructions - ERWIN.vw.com, accessed January 27, 2026, https://vw-us.erwin-store.com/erwin/showKeycodeInstructions.do
      28. VW GEKO - Not a Scam? : r/CarHacking - Reddit, accessed January 27, 2026, https://www.reddit.com/r/CarHacking/comments/1k6wnyx/vw_geko_not_a_scam/
      29. Where Is the Body Control Module Located in a Car? - In The Garage with CarParts.com, accessed January 27, 2026, https://www.carparts.com/blog/where-is-the-body-control-module-located-in-a-car/
      30. How to remove tailgate cover trim Audi A4/S4 Avant DIY - YouTube, accessed January 27, 2026, https://www.youtube.com/watch?v=hngWgksOarE
      31. how to remove the cabin computer BCM Audi 1 9 / как снять компьютер салона BCM Audi 1 9 - YouTube, accessed January 27, 2026, https://www.youtube.com/watch?v=0OfiIqKtpUc
      32. MLB TOOL - MQB Feature: MQB48 Add Key - YouTube, accessed January 27, 2026, https://www.youtube.com/watch?v=9hVLLe5D29g
      33. Xhorse - VVDI MLB Tool VW Audi Key Adapter - Works with VVDI2, VVDI Ke - Keyless City, accessed January 27, 2026, https://keyless-city.com/products/xhorse-vvdi-mlb-tool-vw-audi-key-adapter-works-with-vvdi2-vvdi-key-tool-plus-1
      34. How to Program Audi Keys with Autel IM608 - YouTube, accessed January 27, 2026, https://www.youtube.com/watch?v=jfrvzJuF14g